/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is not neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunksnakey3"] = self["webpackChunksnakey3"] || []).push([["src_base_game_gameparts_GamepartEvents_ts-src_client_game_BrowserGame_ts"],{

/***/ "./assets/style/game/_barrel.css":
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n// extracted by mini-css-extract-plugin\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9hc3NldHMvc3R5bGUvZ2FtZS9fYmFycmVsLmNzcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovL3NuYWtleTMvLi9hc3NldHMvc3R5bGUvZ2FtZS9fYmFycmVsLmNzcz8yODdmIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIGV4dHJhY3RlZCBieSBtaW5pLWNzcy1leHRyYWN0LXBsdWdpblxuZXhwb3J0IHt9OyJdLCJtYXBwaW5ncyI6IjtBQUFBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./assets/style/game/_barrel.css\n");

/***/ }),

/***/ "./src/base/floor/Grid.ts":
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"Grid\": () => /* binding */ Grid\n/* harmony export */ });\n/* harmony import */ var defs_JsUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./src/base/defs/JsUtils.ts\");\n/* harmony import */ var _TileGetter__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"./src/base/floor/TileGetter.ts\");\n\r\n\r\n/**\r\n * # ðŸ—º The Grid Class\r\n *\r\n * A Collection of Tiles.\r\n */\r\nclass Grid {\r\n    /**\r\n     * Protected. See `Grid.getImplementation` for how to access class\r\n     * literals for construction.\r\n     *\r\n     * @param desc -\r\n     */\r\n    constructor(desc) {\r\n        this.static = desc.gridClass;\r\n        this.dimensions = desc.dimensions;\r\n        this.tile = new _TileGetter__WEBPACK_IMPORTED_MODULE_1__.TileGetter(this);\r\n        defs_JsUtils__WEBPACK_IMPORTED_MODULE_0__.JsUtils.propNoWrite(this, [\"static\", \"dimensions\", \"tile\"]);\r\n    }\r\n    get area() {\r\n        return this.static.getArea(this.dimensions);\r\n    }\r\n    /**\r\n     * Calls {@link Tile#reset} for each {@link Tile} in this `Grid`.\r\n     */\r\n    reset() {\r\n        this.forEachTile((tile) => tile.reset());\r\n    }\r\n    /**\r\n     * This action is commonly performed by the GameManager when\r\n     * shuffling in new CSP's to its grid. Grid implementations are\r\n     * encouraged to override it if they have a more efficient way to\r\n     * produce the same result.\r\n     */\r\n    getDestsFromSourcesTo(originCoord) {\r\n        return Array.from(new Set(this.tile.sourcesTo(originCoord).get\r\n            .flatMap((sourceToTarget) => this.tile.destsFrom(sourceToTarget.coord).get)));\r\n    }\r\n    getRandomCoord() {\r\n        return this.static.getRandomCoord(this.dimensions);\r\n    }\r\n}\r\n(function (Grid) {\r\n    ;\r\n    /**\r\n     * @returns\r\n     * A Grid class for the specified coordinate system.\r\n     *\r\n     * @param coordSys -\r\n     */\r\n    Grid.getImplementation = (coordSys) => {\r\n        // Note: At the time of writing this, separating this into\r\n        // two lines is necessary (otherwise Typescript will feel\r\n        // overwhelmed)\r\n        const ctor = Grid._Constructors[coordSys];\r\n        return ctor;\r\n    };\r\n})(Grid || (Grid = {}));\r\n// Grid gets frozen in PostInit after _Constructors get initialized.\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvYmFzZS9mbG9vci9HcmlkLnRzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc25ha2V5My8uL3NyYy9iYXNlL2Zsb29yL0dyaWQudHM/YmY3MiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBKc1V0aWxzIH0gZnJvbSBcImRlZnMvSnNVdGlsc1wiO1xyXG5pbXBvcnQgeyBUaWxlR2V0dGVyIH0gZnJvbSBcIi4vVGlsZUdldHRlclwiO1xyXG4vKipcclxuICogIyDwn5e6IFRoZSBHcmlkIENsYXNzXHJcbiAqXHJcbiAqIEEgQ29sbGVjdGlvbiBvZiBUaWxlcy5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBHcmlkIHtcclxuICAgIC8qKlxyXG4gICAgICogUHJvdGVjdGVkLiBTZWUgYEdyaWQuZ2V0SW1wbGVtZW50YXRpb25gIGZvciBob3cgdG8gYWNjZXNzIGNsYXNzXHJcbiAgICAgKiBsaXRlcmFscyBmb3IgY29uc3RydWN0aW9uLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBkZXNjIC1cclxuICAgICAqL1xyXG4gICAgY29uc3RydWN0b3IoZGVzYykge1xyXG4gICAgICAgIHRoaXMuc3RhdGljID0gZGVzYy5ncmlkQ2xhc3M7XHJcbiAgICAgICAgdGhpcy5kaW1lbnNpb25zID0gZGVzYy5kaW1lbnNpb25zO1xyXG4gICAgICAgIHRoaXMudGlsZSA9IG5ldyBUaWxlR2V0dGVyKHRoaXMpO1xyXG4gICAgICAgIEpzVXRpbHMucHJvcE5vV3JpdGUodGhpcywgW1wic3RhdGljXCIsIFwiZGltZW5zaW9uc1wiLCBcInRpbGVcIl0pO1xyXG4gICAgfVxyXG4gICAgZ2V0IGFyZWEoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RhdGljLmdldEFyZWEodGhpcy5kaW1lbnNpb25zKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQ2FsbHMge0BsaW5rIFRpbGUjcmVzZXR9IGZvciBlYWNoIHtAbGluayBUaWxlfSBpbiB0aGlzIGBHcmlkYC5cclxuICAgICAqL1xyXG4gICAgcmVzZXQoKSB7XHJcbiAgICAgICAgdGhpcy5mb3JFYWNoVGlsZSgodGlsZSkgPT4gdGlsZS5yZXNldCgpKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogVGhpcyBhY3Rpb24gaXMgY29tbW9ubHkgcGVyZm9ybWVkIGJ5IHRoZSBHYW1lTWFuYWdlciB3aGVuXHJcbiAgICAgKiBzaHVmZmxpbmcgaW4gbmV3IENTUCdzIHRvIGl0cyBncmlkLiBHcmlkIGltcGxlbWVudGF0aW9ucyBhcmVcclxuICAgICAqIGVuY291cmFnZWQgdG8gb3ZlcnJpZGUgaXQgaWYgdGhleSBoYXZlIGEgbW9yZSBlZmZpY2llbnQgd2F5IHRvXHJcbiAgICAgKiBwcm9kdWNlIHRoZSBzYW1lIHJlc3VsdC5cclxuICAgICAqL1xyXG4gICAgZ2V0RGVzdHNGcm9tU291cmNlc1RvKG9yaWdpbkNvb3JkKSB7XHJcbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20obmV3IFNldCh0aGlzLnRpbGUuc291cmNlc1RvKG9yaWdpbkNvb3JkKS5nZXRcclxuICAgICAgICAgICAgLmZsYXRNYXAoKHNvdXJjZVRvVGFyZ2V0KSA9PiB0aGlzLnRpbGUuZGVzdHNGcm9tKHNvdXJjZVRvVGFyZ2V0LmNvb3JkKS5nZXQpKSk7XHJcbiAgICB9XHJcbiAgICBnZXRSYW5kb21Db29yZCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zdGF0aWMuZ2V0UmFuZG9tQ29vcmQodGhpcy5kaW1lbnNpb25zKTtcclxuICAgIH1cclxufVxyXG4oZnVuY3Rpb24gKEdyaWQpIHtcclxuICAgIDtcclxuICAgIC8qKlxyXG4gICAgICogQHJldHVybnNcclxuICAgICAqIEEgR3JpZCBjbGFzcyBmb3IgdGhlIHNwZWNpZmllZCBjb29yZGluYXRlIHN5c3RlbS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gY29vcmRTeXMgLVxyXG4gICAgICovXHJcbiAgICBHcmlkLmdldEltcGxlbWVudGF0aW9uID0gKGNvb3JkU3lzKSA9PiB7XHJcbiAgICAgICAgLy8gTm90ZTogQXQgdGhlIHRpbWUgb2Ygd3JpdGluZyB0aGlzLCBzZXBhcmF0aW5nIHRoaXMgaW50b1xyXG4gICAgICAgIC8vIHR3byBsaW5lcyBpcyBuZWNlc3NhcnkgKG90aGVyd2lzZSBUeXBlc2NyaXB0IHdpbGwgZmVlbFxyXG4gICAgICAgIC8vIG92ZXJ3aGVsbWVkKVxyXG4gICAgICAgIGNvbnN0IGN0b3IgPSBHcmlkLl9Db25zdHJ1Y3RvcnNbY29vcmRTeXNdO1xyXG4gICAgICAgIHJldHVybiBjdG9yO1xyXG4gICAgfTtcclxufSkoR3JpZCB8fCAoR3JpZCA9IHt9KSk7XHJcbi8vIEdyaWQgZ2V0cyBmcm96ZW4gaW4gUG9zdEluaXQgYWZ0ZXIgX0NvbnN0cnVjdG9ycyBnZXQgaW5pdGlhbGl6ZWQuXHJcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/base/floor/Grid.ts\n");

/***/ }),

/***/ "./src/base/floor/Tile.ts":
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"Coord\": () => /* reexport safe */ _Coord__WEBPACK_IMPORTED_MODULE_2__.Coord,\n/* harmony export */   \"Tile\": () => /* binding */ Tile\n/* harmony export */ });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(\"./node_modules/tslib/tslib.es6.js\");\n/* harmony import */ var defs_JsUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./src/base/defs/JsUtils.ts\");\n/* harmony import */ var defs_TypeDefs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"./src/base/defs/TypeDefs.ts\");\n/* harmony import */ var _Coord__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"./src/base/floor/Coord.ts\");\nvar _occupantId, _freeHealth, _langChar, _langSeq;\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * # The Tile Class\r\n *\r\n * As an implementation choice, tiles are dumb. That is, they have\r\n * no knowledge of their context. Their internals are all managed by\r\n * their host {@link Game} through method calls.\r\n *\r\n * From a caller's point of view, extending classes should have am\r\n * identical constructor signature as that of this base class. This\r\n * can be done by a type assertion statement: `<extension class> as\r\n * Tile.ConstructorType<Coord.System>`.\r\n *\r\n * @template S\r\n * The coordinate system enum for this tile's coordinate.\r\n */\r\nclass Tile {\r\n    /**\r\n     * @param coord -\r\n     */\r\n    constructor(coord) {\r\n        _occupantId.set(this, void 0);\r\n        _freeHealth.set(this, void 0);\r\n        _langChar.set(this, void 0);\r\n        _langSeq.set(this, void 0);\r\n        this.coord = coord;\r\n        defs_JsUtils__WEBPACK_IMPORTED_MODULE_0__.JsUtils.propNoWrite(this, [\"coord\"]);\r\n        (0,tslib__WEBPACK_IMPORTED_MODULE_3__.__classPrivateFieldSet)(this, _occupantId, defs_TypeDefs__WEBPACK_IMPORTED_MODULE_1__.Player.Id.NULL);\r\n    }\r\n    reset() {\r\n        this.evictOccupant();\r\n        this.lastKnownUpdateId = 0;\r\n        this.freeHealth = 0;\r\n        // This is also done when shuffling individual tiles throughout\r\n        // the game, but it is done here since initially, nothing needs\r\n        // to be avoided because no CSP's have been set yet.\r\n        this.setLangCharSeqPair(defs_TypeDefs__WEBPACK_IMPORTED_MODULE_1__.Lang.CharSeqPair.NULL);\r\n    }\r\n    /**\r\n     * Any overrides must make a supercall to this implementation.\r\n     *\r\n     * Must be followed by a call to `PlayerStatus._onAfterOccupy()`.\r\n     *\r\n     * @param playerId -\r\n     */\r\n    _setOccupant(playerId, immigrantInfo) {\r\n        (0,tslib__WEBPACK_IMPORTED_MODULE_3__.__classPrivateFieldSet)(this, _occupantId, playerId);\r\n    }\r\n    get isOccupied() {\r\n        return this.occupantId !== defs_TypeDefs__WEBPACK_IMPORTED_MODULE_1__.Player.Id.NULL;\r\n    }\r\n    evictOccupant() {\r\n        (0,tslib__WEBPACK_IMPORTED_MODULE_3__.__classPrivateFieldSet)(this, _occupantId, defs_TypeDefs__WEBPACK_IMPORTED_MODULE_1__.Player.Id.NULL);\r\n    }\r\n    get occupantId() {\r\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_3__.__classPrivateFieldGet)(this, _occupantId);\r\n    }\r\n    get freeHealth() {\r\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_3__.__classPrivateFieldGet)(this, _freeHealth);\r\n    }\r\n    set freeHealth(newFreeHealth) {\r\n        (0,tslib__WEBPACK_IMPORTED_MODULE_3__.__classPrivateFieldSet)(this, _freeHealth, newFreeHealth);\r\n    }\r\n    /**\r\n     * @override\r\n     */\r\n    setLangCharSeqPair(charSeqPair) {\r\n        (0,tslib__WEBPACK_IMPORTED_MODULE_3__.__classPrivateFieldSet)(this, _langChar, charSeqPair.char);\r\n        (0,tslib__WEBPACK_IMPORTED_MODULE_3__.__classPrivateFieldSet)(this, _langSeq, charSeqPair.seq);\r\n    }\r\n    get langChar() {\r\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_3__.__classPrivateFieldGet)(this, _langChar);\r\n    }\r\n    get langSeq() {\r\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_3__.__classPrivateFieldGet)(this, _langSeq);\r\n    }\r\n}\r\n_occupantId = new WeakMap(), _freeHealth = new WeakMap(), _langChar = new WeakMap(), _langSeq = new WeakMap();\r\n// If this errs when changing the constructor signature, then\r\n// the type definition being asserted should be updated to match.\r\nTile;\r\nObject.freeze(Tile);\r\nObject.freeze(Tile.prototype);\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvYmFzZS9mbG9vci9UaWxlLnRzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc25ha2V5My8uL3NyYy9iYXNlL2Zsb29yL1RpbGUudHM/Njg1YiJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX29jY3VwYW50SWQsIF9mcmVlSGVhbHRoLCBfbGFuZ0NoYXIsIF9sYW5nU2VxO1xyXG5pbXBvcnQgeyBfX2NsYXNzUHJpdmF0ZUZpZWxkR2V0LCBfX2NsYXNzUHJpdmF0ZUZpZWxkU2V0IH0gZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCB7IEpzVXRpbHMgfSBmcm9tIFwiZGVmcy9Kc1V0aWxzXCI7XHJcbmltcG9ydCB7IExhbmcsIFBsYXllciB9IGZyb20gXCJkZWZzL1R5cGVEZWZzXCI7XHJcbmltcG9ydCB7IENvb3JkIH0gZnJvbSBcIi4vQ29vcmRcIjtcclxuZXhwb3J0IHsgQ29vcmQgfTtcclxuLyoqXHJcbiAqICMgVGhlIFRpbGUgQ2xhc3NcclxuICpcclxuICogQXMgYW4gaW1wbGVtZW50YXRpb24gY2hvaWNlLCB0aWxlcyBhcmUgZHVtYi4gVGhhdCBpcywgdGhleSBoYXZlXHJcbiAqIG5vIGtub3dsZWRnZSBvZiB0aGVpciBjb250ZXh0LiBUaGVpciBpbnRlcm5hbHMgYXJlIGFsbCBtYW5hZ2VkIGJ5XHJcbiAqIHRoZWlyIGhvc3Qge0BsaW5rIEdhbWV9IHRocm91Z2ggbWV0aG9kIGNhbGxzLlxyXG4gKlxyXG4gKiBGcm9tIGEgY2FsbGVyJ3MgcG9pbnQgb2YgdmlldywgZXh0ZW5kaW5nIGNsYXNzZXMgc2hvdWxkIGhhdmUgYW1cclxuICogaWRlbnRpY2FsIGNvbnN0cnVjdG9yIHNpZ25hdHVyZSBhcyB0aGF0IG9mIHRoaXMgYmFzZSBjbGFzcy4gVGhpc1xyXG4gKiBjYW4gYmUgZG9uZSBieSBhIHR5cGUgYXNzZXJ0aW9uIHN0YXRlbWVudDogYDxleHRlbnNpb24gY2xhc3M+IGFzXHJcbiAqIFRpbGUuQ29uc3RydWN0b3JUeXBlPENvb3JkLlN5c3RlbT5gLlxyXG4gKlxyXG4gKiBAdGVtcGxhdGUgU1xyXG4gKiBUaGUgY29vcmRpbmF0ZSBzeXN0ZW0gZW51bSBmb3IgdGhpcyB0aWxlJ3MgY29vcmRpbmF0ZS5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBUaWxlIHtcclxuICAgIC8qKlxyXG4gICAgICogQHBhcmFtIGNvb3JkIC1cclxuICAgICAqL1xyXG4gICAgY29uc3RydWN0b3IoY29vcmQpIHtcclxuICAgICAgICBfb2NjdXBhbnRJZC5zZXQodGhpcywgdm9pZCAwKTtcclxuICAgICAgICBfZnJlZUhlYWx0aC5zZXQodGhpcywgdm9pZCAwKTtcclxuICAgICAgICBfbGFuZ0NoYXIuc2V0KHRoaXMsIHZvaWQgMCk7XHJcbiAgICAgICAgX2xhbmdTZXEuc2V0KHRoaXMsIHZvaWQgMCk7XHJcbiAgICAgICAgdGhpcy5jb29yZCA9IGNvb3JkO1xyXG4gICAgICAgIEpzVXRpbHMucHJvcE5vV3JpdGUodGhpcywgW1wiY29vcmRcIl0pO1xyXG4gICAgICAgIF9fY2xhc3NQcml2YXRlRmllbGRTZXQodGhpcywgX29jY3VwYW50SWQsIFBsYXllci5JZC5OVUxMKTtcclxuICAgIH1cclxuICAgIHJlc2V0KCkge1xyXG4gICAgICAgIHRoaXMuZXZpY3RPY2N1cGFudCgpO1xyXG4gICAgICAgIHRoaXMubGFzdEtub3duVXBkYXRlSWQgPSAwO1xyXG4gICAgICAgIHRoaXMuZnJlZUhlYWx0aCA9IDA7XHJcbiAgICAgICAgLy8gVGhpcyBpcyBhbHNvIGRvbmUgd2hlbiBzaHVmZmxpbmcgaW5kaXZpZHVhbCB0aWxlcyB0aHJvdWdob3V0XHJcbiAgICAgICAgLy8gdGhlIGdhbWUsIGJ1dCBpdCBpcyBkb25lIGhlcmUgc2luY2UgaW5pdGlhbGx5LCBub3RoaW5nIG5lZWRzXHJcbiAgICAgICAgLy8gdG8gYmUgYXZvaWRlZCBiZWNhdXNlIG5vIENTUCdzIGhhdmUgYmVlbiBzZXQgeWV0LlxyXG4gICAgICAgIHRoaXMuc2V0TGFuZ0NoYXJTZXFQYWlyKExhbmcuQ2hhclNlcVBhaXIuTlVMTCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEFueSBvdmVycmlkZXMgbXVzdCBtYWtlIGEgc3VwZXJjYWxsIHRvIHRoaXMgaW1wbGVtZW50YXRpb24uXHJcbiAgICAgKlxyXG4gICAgICogTXVzdCBiZSBmb2xsb3dlZCBieSBhIGNhbGwgdG8gYFBsYXllclN0YXR1cy5fb25BZnRlck9jY3VweSgpYC5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gcGxheWVySWQgLVxyXG4gICAgICovXHJcbiAgICBfc2V0T2NjdXBhbnQocGxheWVySWQsIGltbWlncmFudEluZm8pIHtcclxuICAgICAgICBfX2NsYXNzUHJpdmF0ZUZpZWxkU2V0KHRoaXMsIF9vY2N1cGFudElkLCBwbGF5ZXJJZCk7XHJcbiAgICB9XHJcbiAgICBnZXQgaXNPY2N1cGllZCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5vY2N1cGFudElkICE9PSBQbGF5ZXIuSWQuTlVMTDtcclxuICAgIH1cclxuICAgIGV2aWN0T2NjdXBhbnQoKSB7XHJcbiAgICAgICAgX19jbGFzc1ByaXZhdGVGaWVsZFNldCh0aGlzLCBfb2NjdXBhbnRJZCwgUGxheWVyLklkLk5VTEwpO1xyXG4gICAgfVxyXG4gICAgZ2V0IG9jY3VwYW50SWQoKSB7XHJcbiAgICAgICAgcmV0dXJuIF9fY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX29jY3VwYW50SWQpO1xyXG4gICAgfVxyXG4gICAgZ2V0IGZyZWVIZWFsdGgoKSB7XHJcbiAgICAgICAgcmV0dXJuIF9fY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX2ZyZWVIZWFsdGgpO1xyXG4gICAgfVxyXG4gICAgc2V0IGZyZWVIZWFsdGgobmV3RnJlZUhlYWx0aCkge1xyXG4gICAgICAgIF9fY2xhc3NQcml2YXRlRmllbGRTZXQodGhpcywgX2ZyZWVIZWFsdGgsIG5ld0ZyZWVIZWFsdGgpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBAb3ZlcnJpZGVcclxuICAgICAqL1xyXG4gICAgc2V0TGFuZ0NoYXJTZXFQYWlyKGNoYXJTZXFQYWlyKSB7XHJcbiAgICAgICAgX19jbGFzc1ByaXZhdGVGaWVsZFNldCh0aGlzLCBfbGFuZ0NoYXIsIGNoYXJTZXFQYWlyLmNoYXIpO1xyXG4gICAgICAgIF9fY2xhc3NQcml2YXRlRmllbGRTZXQodGhpcywgX2xhbmdTZXEsIGNoYXJTZXFQYWlyLnNlcSk7XHJcbiAgICB9XHJcbiAgICBnZXQgbGFuZ0NoYXIoKSB7XHJcbiAgICAgICAgcmV0dXJuIF9fY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX2xhbmdDaGFyKTtcclxuICAgIH1cclxuICAgIGdldCBsYW5nU2VxKCkge1xyXG4gICAgICAgIHJldHVybiBfX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHRoaXMsIF9sYW5nU2VxKTtcclxuICAgIH1cclxufVxyXG5fb2NjdXBhbnRJZCA9IG5ldyBXZWFrTWFwKCksIF9mcmVlSGVhbHRoID0gbmV3IFdlYWtNYXAoKSwgX2xhbmdDaGFyID0gbmV3IFdlYWtNYXAoKSwgX2xhbmdTZXEgPSBuZXcgV2Vha01hcCgpO1xyXG4vLyBJZiB0aGlzIGVycnMgd2hlbiBjaGFuZ2luZyB0aGUgY29uc3RydWN0b3Igc2lnbmF0dXJlLCB0aGVuXHJcbi8vIHRoZSB0eXBlIGRlZmluaXRpb24gYmVpbmcgYXNzZXJ0ZWQgc2hvdWxkIGJlIHVwZGF0ZWQgdG8gbWF0Y2guXHJcblRpbGU7XHJcbk9iamVjdC5mcmVlemUoVGlsZSk7XHJcbk9iamVjdC5mcmVlemUoVGlsZS5wcm90b3R5cGUpO1xyXG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/base/floor/Tile.ts\n");

/***/ }),

/***/ "./src/base/floor/TileGetter.ts":
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"TileGetter\": () => /* binding */ TileGetter\n/* harmony export */ });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./node_modules/tslib/tslib.es6.js\");\nvar _source_1;\r\n\r\n/**\r\n * A utility class to get destinations-to or sources-from a tile at\r\n * a specified coordinate. It is recommended to name the calling\r\n * variable \"tile\". A query starts with calling one of the methods\r\n * `at`, `destsFrom`, or `sourcesTo`. Optional filtering mutators\r\n * can be applied intermediately such as `unoccupied`. The query\r\n * ends with one of the getters `occupants` or `get`.\r\n *\r\n * @template S\r\n *\r\n * @template A\r\n * This allows `Source` implementations to accept a coordinate\r\n * specifier as an argument, such as is appropriate with a grid,\r\n * or to provide that information implicitly inside itself as\r\n * part of its spec, as is appropriate with a player.\r\n *\r\n */\r\nclass TileGetter {\r\n    constructor(source) {\r\n        _source_1.set(this, void 0);\r\n        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__classPrivateFieldSet)(this, _source_1, source);\r\n        Object.freeze(this);\r\n    }\r\n    get _source() {\r\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__classPrivateFieldGet)(this, _source_1);\r\n    }\r\n    at(...args) {\r\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__classPrivateFieldGet)(this, _source_1)._getTileAt(...args);\r\n    }\r\n    destsFrom(...args) {\r\n        return new Query((0,tslib__WEBPACK_IMPORTED_MODULE_0__.__classPrivateFieldGet)(this, _source_1)._getTileDestsFrom(...args));\r\n    }\r\n    sourcesTo(...args) {\r\n        return new Query((0,tslib__WEBPACK_IMPORTED_MODULE_0__.__classPrivateFieldGet)(this, _source_1)._getTileSourcesTo(...args));\r\n    }\r\n}\r\n_source_1 = new WeakMap();\r\nObject.freeze(TileGetter);\r\nObject.freeze(TileGetter.prototype);\r\n/**\r\n *\r\n */\r\nclass Query {\r\n    constructor(contents) {\r\n        this.contents = contents;\r\n        Object.seal(this);\r\n    }\r\n    get occupied() {\r\n        this.contents = this.contents.filter((tile) => tile.isOccupied);\r\n        return this;\r\n    }\r\n    get unoccupied() {\r\n        this.contents = this.contents.filter((tile) => !tile.isOccupied);\r\n        return this;\r\n    }\r\n    get get() {\r\n        const retval = this.contents;\r\n        return retval;\r\n    }\r\n}\r\nObject.freeze(Query);\r\nObject.freeze(Query.prototype);\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvYmFzZS9mbG9vci9UaWxlR2V0dGVyLnRzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc25ha2V5My8uL3NyYy9iYXNlL2Zsb29yL1RpbGVHZXR0ZXIudHM/MmJiMSJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX3NvdXJjZV8xO1xyXG5pbXBvcnQgeyBfX2NsYXNzUHJpdmF0ZUZpZWxkR2V0LCBfX2NsYXNzUHJpdmF0ZUZpZWxkU2V0IH0gZnJvbSBcInRzbGliXCI7XHJcbi8qKlxyXG4gKiBBIHV0aWxpdHkgY2xhc3MgdG8gZ2V0IGRlc3RpbmF0aW9ucy10byBvciBzb3VyY2VzLWZyb20gYSB0aWxlIGF0XHJcbiAqIGEgc3BlY2lmaWVkIGNvb3JkaW5hdGUuIEl0IGlzIHJlY29tbWVuZGVkIHRvIG5hbWUgdGhlIGNhbGxpbmdcclxuICogdmFyaWFibGUgXCJ0aWxlXCIuIEEgcXVlcnkgc3RhcnRzIHdpdGggY2FsbGluZyBvbmUgb2YgdGhlIG1ldGhvZHNcclxuICogYGF0YCwgYGRlc3RzRnJvbWAsIG9yIGBzb3VyY2VzVG9gLiBPcHRpb25hbCBmaWx0ZXJpbmcgbXV0YXRvcnNcclxuICogY2FuIGJlIGFwcGxpZWQgaW50ZXJtZWRpYXRlbHkgc3VjaCBhcyBgdW5vY2N1cGllZGAuIFRoZSBxdWVyeVxyXG4gKiBlbmRzIHdpdGggb25lIG9mIHRoZSBnZXR0ZXJzIGBvY2N1cGFudHNgIG9yIGBnZXRgLlxyXG4gKlxyXG4gKiBAdGVtcGxhdGUgU1xyXG4gKlxyXG4gKiBAdGVtcGxhdGUgQVxyXG4gKiBUaGlzIGFsbG93cyBgU291cmNlYCBpbXBsZW1lbnRhdGlvbnMgdG8gYWNjZXB0IGEgY29vcmRpbmF0ZVxyXG4gKiBzcGVjaWZpZXIgYXMgYW4gYXJndW1lbnQsIHN1Y2ggYXMgaXMgYXBwcm9wcmlhdGUgd2l0aCBhIGdyaWQsXHJcbiAqIG9yIHRvIHByb3ZpZGUgdGhhdCBpbmZvcm1hdGlvbiBpbXBsaWNpdGx5IGluc2lkZSBpdHNlbGYgYXNcclxuICogcGFydCBvZiBpdHMgc3BlYywgYXMgaXMgYXBwcm9wcmlhdGUgd2l0aCBhIHBsYXllci5cclxuICpcclxuICovXHJcbmV4cG9ydCBjbGFzcyBUaWxlR2V0dGVyIHtcclxuICAgIGNvbnN0cnVjdG9yKHNvdXJjZSkge1xyXG4gICAgICAgIF9zb3VyY2VfMS5zZXQodGhpcywgdm9pZCAwKTtcclxuICAgICAgICBfX2NsYXNzUHJpdmF0ZUZpZWxkU2V0KHRoaXMsIF9zb3VyY2VfMSwgc291cmNlKTtcclxuICAgICAgICBPYmplY3QuZnJlZXplKHRoaXMpO1xyXG4gICAgfVxyXG4gICAgZ2V0IF9zb3VyY2UoKSB7XHJcbiAgICAgICAgcmV0dXJuIF9fY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX3NvdXJjZV8xKTtcclxuICAgIH1cclxuICAgIGF0KC4uLmFyZ3MpIHtcclxuICAgICAgICByZXR1cm4gX19jbGFzc1ByaXZhdGVGaWVsZEdldCh0aGlzLCBfc291cmNlXzEpLl9nZXRUaWxlQXQoLi4uYXJncyk7XHJcbiAgICB9XHJcbiAgICBkZXN0c0Zyb20oLi4uYXJncykge1xyXG4gICAgICAgIHJldHVybiBuZXcgUXVlcnkoX19jbGFzc1ByaXZhdGVGaWVsZEdldCh0aGlzLCBfc291cmNlXzEpLl9nZXRUaWxlRGVzdHNGcm9tKC4uLmFyZ3MpKTtcclxuICAgIH1cclxuICAgIHNvdXJjZXNUbyguLi5hcmdzKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBRdWVyeShfX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHRoaXMsIF9zb3VyY2VfMSkuX2dldFRpbGVTb3VyY2VzVG8oLi4uYXJncykpO1xyXG4gICAgfVxyXG59XHJcbl9zb3VyY2VfMSA9IG5ldyBXZWFrTWFwKCk7XHJcbk9iamVjdC5mcmVlemUoVGlsZUdldHRlcik7XHJcbk9iamVjdC5mcmVlemUoVGlsZUdldHRlci5wcm90b3R5cGUpO1xyXG4vKipcclxuICpcclxuICovXHJcbmNsYXNzIFF1ZXJ5IHtcclxuICAgIGNvbnN0cnVjdG9yKGNvbnRlbnRzKSB7XHJcbiAgICAgICAgdGhpcy5jb250ZW50cyA9IGNvbnRlbnRzO1xyXG4gICAgICAgIE9iamVjdC5zZWFsKHRoaXMpO1xyXG4gICAgfVxyXG4gICAgZ2V0IG9jY3VwaWVkKCkge1xyXG4gICAgICAgIHRoaXMuY29udGVudHMgPSB0aGlzLmNvbnRlbnRzLmZpbHRlcigodGlsZSkgPT4gdGlsZS5pc09jY3VwaWVkKTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuICAgIGdldCB1bm9jY3VwaWVkKCkge1xyXG4gICAgICAgIHRoaXMuY29udGVudHMgPSB0aGlzLmNvbnRlbnRzLmZpbHRlcigodGlsZSkgPT4gIXRpbGUuaXNPY2N1cGllZCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcbiAgICBnZXQgZ2V0KCkge1xyXG4gICAgICAgIGNvbnN0IHJldHZhbCA9IHRoaXMuY29udGVudHM7XHJcbiAgICAgICAgcmV0dXJuIHJldHZhbDtcclxuICAgIH1cclxufVxyXG5PYmplY3QuZnJlZXplKFF1ZXJ5KTtcclxuT2JqZWN0LmZyZWV6ZShRdWVyeS5wcm90b3R5cGUpO1xyXG4iXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/base/floor/TileGetter.ts\n");

/***/ }),

/***/ "./src/base/floor/VisibleGrid.ts":
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"VisibleGrid\": () => /* binding */ VisibleGrid,\n/* harmony export */   \"VisibleGridMixin\": () => /* binding */ VisibleGridMixin\n/* harmony export */ });\n/* harmony import */ var defs_OmHooks__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./src/base/defs/OmHooks.ts\");\n/* harmony import */ var defs_JsUtils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"./src/base/defs/JsUtils.ts\");\n/* harmony import */ var floor_VisibleTile__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"./src/base/floor/VisibleTile.ts\");\n\r\n\r\n\r\nvar VisibleGrid;\r\n(function (VisibleGrid) {\r\n    ;\r\n    VisibleGrid.getImplementation = (coordSys) => {\r\n        const ctor = VisibleGrid._Constructors[coordSys];\r\n        return ctor;\r\n    };\r\n})(VisibleGrid || (VisibleGrid = {}));\r\n/**\r\n *\r\n */\r\nclass VisibleGridMixin {\r\n    /**\r\n     * Note: I would rather have this implementation go under the\r\n     * `VisibleGrid` class, but I don't want to get into mixins as of\r\n     * now to get around no-multiple-inheritance.\r\n     *\r\n     * @param desc -\r\n     * @param gridImpl -\r\n     */\r\n    _superVisibleGrid(desc, gridImpl) {\r\n        if (desc.tileClass !== floor_VisibleTile__WEBPACK_IMPORTED_MODULE_2__.VisibleTile) {\r\n            throw new TypeError(\"never\");\r\n        }\r\n        const OHG = defs_OmHooks__WEBPACK_IMPORTED_MODULE_0__.OmHooks.Grid;\r\n        gridImpl.setAttribute(\"role\", \"presentation\");\r\n        gridImpl.classList.add(OHG.Class.IMPL_BODY);\r\n        gridImpl.dataset[OHG.Dataset.IMPL_COORD_SYS] = desc.coordSys;\r\n        gridImpl.translate = false; // https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/translate\r\n        gridImpl.spellcheck = false; // typically assumed by the UA, but it doesn't hurt to say explicitly.\r\n        // @ts-expect-error : RO=\r\n        this.baseElem = gridImpl;\r\n        // Initialize spotlight elements:\r\n        const shortSpotlight = defs_JsUtils__WEBPACK_IMPORTED_MODULE_1__.JsUtils.mkEl(\"div\", [defs_OmHooks__WEBPACK_IMPORTED_MODULE_0__.OmHooks.Player.Class.SHORT_SPOTLIGHT]);\r\n        const longSpotlight = defs_JsUtils__WEBPACK_IMPORTED_MODULE_1__.JsUtils.mkEl(\"div\", [defs_OmHooks__WEBPACK_IMPORTED_MODULE_0__.OmHooks.Player.Class.LONG_SPOTLIGHT]);\r\n        // @ts-expect-error : RO=\r\n        this.spotlightElems = Object.freeze([shortSpotlight, longSpotlight]);\r\n    }\r\n}\r\n;\r\nObject.freeze(VisibleGridMixin);\r\nObject.freeze(VisibleGridMixin.prototype);\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvYmFzZS9mbG9vci9WaXNpYmxlR3JpZC50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovL3NuYWtleTMvLi9zcmMvYmFzZS9mbG9vci9WaXNpYmxlR3JpZC50cz85ODVkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE9tSG9va3MgfSBmcm9tIFwiZGVmcy9PbUhvb2tzXCI7XHJcbmltcG9ydCB7IEpzVXRpbHMgfSBmcm9tIFwiZGVmcy9Kc1V0aWxzXCI7XHJcbmltcG9ydCB7IFZpc2libGVUaWxlIH0gZnJvbSBcImZsb29yL1Zpc2libGVUaWxlXCI7XHJcbmV4cG9ydCB2YXIgVmlzaWJsZUdyaWQ7XHJcbihmdW5jdGlvbiAoVmlzaWJsZUdyaWQpIHtcclxuICAgIDtcclxuICAgIFZpc2libGVHcmlkLmdldEltcGxlbWVudGF0aW9uID0gKGNvb3JkU3lzKSA9PiB7XHJcbiAgICAgICAgY29uc3QgY3RvciA9IFZpc2libGVHcmlkLl9Db25zdHJ1Y3RvcnNbY29vcmRTeXNdO1xyXG4gICAgICAgIHJldHVybiBjdG9yO1xyXG4gICAgfTtcclxufSkoVmlzaWJsZUdyaWQgfHwgKFZpc2libGVHcmlkID0ge30pKTtcclxuLyoqXHJcbiAqXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgVmlzaWJsZUdyaWRNaXhpbiB7XHJcbiAgICAvKipcclxuICAgICAqIE5vdGU6IEkgd291bGQgcmF0aGVyIGhhdmUgdGhpcyBpbXBsZW1lbnRhdGlvbiBnbyB1bmRlciB0aGVcclxuICAgICAqIGBWaXNpYmxlR3JpZGAgY2xhc3MsIGJ1dCBJIGRvbid0IHdhbnQgdG8gZ2V0IGludG8gbWl4aW5zIGFzIG9mXHJcbiAgICAgKiBub3cgdG8gZ2V0IGFyb3VuZCBuby1tdWx0aXBsZS1pbmhlcml0YW5jZS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gZGVzYyAtXHJcbiAgICAgKiBAcGFyYW0gZ3JpZEltcGwgLVxyXG4gICAgICovXHJcbiAgICBfc3VwZXJWaXNpYmxlR3JpZChkZXNjLCBncmlkSW1wbCkge1xyXG4gICAgICAgIGlmIChkZXNjLnRpbGVDbGFzcyAhPT0gVmlzaWJsZVRpbGUpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIm5ldmVyXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBPSEcgPSBPbUhvb2tzLkdyaWQ7XHJcbiAgICAgICAgZ3JpZEltcGwuc2V0QXR0cmlidXRlKFwicm9sZVwiLCBcInByZXNlbnRhdGlvblwiKTtcclxuICAgICAgICBncmlkSW1wbC5jbGFzc0xpc3QuYWRkKE9IRy5DbGFzcy5JTVBMX0JPRFkpO1xyXG4gICAgICAgIGdyaWRJbXBsLmRhdGFzZXRbT0hHLkRhdGFzZXQuSU1QTF9DT09SRF9TWVNdID0gZGVzYy5jb29yZFN5cztcclxuICAgICAgICBncmlkSW1wbC50cmFuc2xhdGUgPSBmYWxzZTsgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSFRNTC9HbG9iYWxfYXR0cmlidXRlcy90cmFuc2xhdGVcclxuICAgICAgICBncmlkSW1wbC5zcGVsbGNoZWNrID0gZmFsc2U7IC8vIHR5cGljYWxseSBhc3N1bWVkIGJ5IHRoZSBVQSwgYnV0IGl0IGRvZXNuJ3QgaHVydCB0byBzYXkgZXhwbGljaXRseS5cclxuICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yIDogUk89XHJcbiAgICAgICAgdGhpcy5iYXNlRWxlbSA9IGdyaWRJbXBsO1xyXG4gICAgICAgIC8vIEluaXRpYWxpemUgc3BvdGxpZ2h0IGVsZW1lbnRzOlxyXG4gICAgICAgIGNvbnN0IHNob3J0U3BvdGxpZ2h0ID0gSnNVdGlscy5ta0VsKFwiZGl2XCIsIFtPbUhvb2tzLlBsYXllci5DbGFzcy5TSE9SVF9TUE9UTElHSFRdKTtcclxuICAgICAgICBjb25zdCBsb25nU3BvdGxpZ2h0ID0gSnNVdGlscy5ta0VsKFwiZGl2XCIsIFtPbUhvb2tzLlBsYXllci5DbGFzcy5MT05HX1NQT1RMSUdIVF0pO1xyXG4gICAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgOiBSTz1cclxuICAgICAgICB0aGlzLnNwb3RsaWdodEVsZW1zID0gT2JqZWN0LmZyZWV6ZShbc2hvcnRTcG90bGlnaHQsIGxvbmdTcG90bGlnaHRdKTtcclxuICAgIH1cclxufVxyXG47XHJcbk9iamVjdC5mcmVlemUoVmlzaWJsZUdyaWRNaXhpbik7XHJcbk9iamVjdC5mcmVlemUoVmlzaWJsZUdyaWRNaXhpbi5wcm90b3R5cGUpO1xyXG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/base/floor/VisibleGrid.ts\n");

/***/ }),

/***/ "./src/base/floor/VisibleTile.ts":
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"Coord\": () => /* reexport safe */ _Tile__WEBPACK_IMPORTED_MODULE_2__.Coord,\n/* harmony export */   \"VisibleTile\": () => /* binding */ VisibleTile\n/* harmony export */ });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(\"./node_modules/tslib/tslib.es6.js\");\n/* harmony import */ var defs_JsUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./src/base/defs/JsUtils.ts\");\n/* harmony import */ var defs_OmHooks__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"./src/base/defs/OmHooks.ts\");\n/* harmony import */ var _Tile__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"./src/base/floor/Tile.ts\");\nvar _baseElem;\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Implicitly handles visuals with help from CSS.\r\n */\r\nclass VisibleTile extends _Tile__WEBPACK_IMPORTED_MODULE_2__.Tile {\r\n    constructor(coordDesc) {\r\n        super(coordDesc);\r\n        _baseElem.set(this, void 0);\r\n        {\r\n            const base = (0,tslib__WEBPACK_IMPORTED_MODULE_3__.__classPrivateFieldSet)(this, _baseElem, defs_JsUtils__WEBPACK_IMPORTED_MODULE_0__.JsUtils.mkEl(\"div\", [\r\n                defs_OmHooks__WEBPACK_IMPORTED_MODULE_1__.OmHooks.General.Class.CENTER_CONTENTS,\r\n                defs_OmHooks__WEBPACK_IMPORTED_MODULE_1__.OmHooks.General.Class.STACK_CONTENTS,\r\n                defs_OmHooks__WEBPACK_IMPORTED_MODULE_1__.OmHooks.Tile.Class.BASE,\r\n            ]));\r\n            base.setAttribute(\"aria-label\", \"Tile\");\r\n        }\r\n        {\r\n            // Pointer hitbox element.\r\n            // Must be the first child. See note in CSS class hook.\r\n            const pthb = defs_JsUtils__WEBPACK_IMPORTED_MODULE_0__.JsUtils.mkEl(\"div\", [defs_OmHooks__WEBPACK_IMPORTED_MODULE_1__.OmHooks.Tile.Class.POINTER_HB]);\r\n            pthb.setAttribute(\"aria-hidden\", \"true\");\r\n            (0,tslib__WEBPACK_IMPORTED_MODULE_3__.__classPrivateFieldGet)(this, _baseElem).appendChild(pthb);\r\n        }\r\n        {\r\n            const charWrap = defs_JsUtils__WEBPACK_IMPORTED_MODULE_0__.JsUtils.mkEl(\"div\", [defs_OmHooks__WEBPACK_IMPORTED_MODULE_1__.OmHooks.Tile.Class.LANG_CHAR_WRAP]);\r\n            charWrap.setAttribute(\"role\", \"presentation\");\r\n            const charElem = this.langCharElem = defs_JsUtils__WEBPACK_IMPORTED_MODULE_0__.JsUtils.mkEl(\"div\", []);\r\n            charWrap.appendChild(charElem);\r\n            (0,tslib__WEBPACK_IMPORTED_MODULE_3__.__classPrivateFieldGet)(this, _baseElem).appendChild(charWrap);\r\n        }\r\n        {\r\n            const seqElem = this.langSeqElem = defs_JsUtils__WEBPACK_IMPORTED_MODULE_0__.JsUtils.mkEl(\"div\", [defs_OmHooks__WEBPACK_IMPORTED_MODULE_1__.OmHooks.Tile.Class.LANG_SEQ]);\r\n            seqElem.setAttribute(\"role\", \"tooltip\");\r\n            (0,tslib__WEBPACK_IMPORTED_MODULE_3__.__classPrivateFieldGet)(this, _baseElem).appendChild(seqElem);\r\n        }\r\n        defs_JsUtils__WEBPACK_IMPORTED_MODULE_0__.JsUtils.propNoWrite(this, [\"langCharElem\", \"langSeqElem\"]);\r\n    }\r\n    _addToDom(parent) {\r\n        parent.appendChild((0,tslib__WEBPACK_IMPORTED_MODULE_3__.__classPrivateFieldGet)(this, _baseElem));\r\n    }\r\n    /**\r\n     * @override\r\n     */\r\n    _setOccupant(playerId, immigrantInfo) {\r\n        super._setOccupant(playerId, immigrantInfo);\r\n        // It must go at least before the langChar element so that the\r\n        // CSS can create a fading trail effect. It must go after the\r\n        // hitbox so that it can be hidden to avoid covering the tooltip.\r\n        this.langCharElem.parentElement.insertAdjacentElement(\"beforebegin\", immigrantInfo.playerElem);\r\n        this.langSeqElem.textContent = immigrantInfo.username;\r\n    }\r\n    /**\r\n     * @override\r\n     */\r\n    evictOccupant() {\r\n        super.evictOccupant();\r\n        // Undo setting mouseover text to something player-related\r\n        // (See `__setOccupant` for what we did and now need to undo):\r\n        this.langSeqElem.textContent = this.langSeq;\r\n    }\r\n    /**\r\n     * @override\r\n     */\r\n    set freeHealth(newFreeHealth) {\r\n        super.freeHealth = newFreeHealth;\r\n        if (this.freeHealth > 0) {\r\n            (0,tslib__WEBPACK_IMPORTED_MODULE_3__.__classPrivateFieldGet)(this, _baseElem).dataset[defs_OmHooks__WEBPACK_IMPORTED_MODULE_1__.OmHooks.Tile.Dataset.HEALTH] = this.freeHealth.toString();\r\n        }\r\n        else {\r\n            delete (0,tslib__WEBPACK_IMPORTED_MODULE_3__.__classPrivateFieldGet)(this, _baseElem).dataset[defs_OmHooks__WEBPACK_IMPORTED_MODULE_1__.OmHooks.Tile.Dataset.HEALTH];\r\n        }\r\n    }\r\n    /**\r\n     * @override\r\n     */\r\n    // NOTE: For some reason, if we override the setter, the transpiled\r\n    // code does not link to the super implementation... Or maybe this\r\n    // is just a property of plain ECMA javascript??\r\n    get freeHealth() {\r\n        return super.freeHealth;\r\n    }\r\n    /**\r\n     * @override\r\n     */\r\n    setLangCharSeqPair(charSeqPair) {\r\n        super.setLangCharSeqPair(charSeqPair);\r\n        this.langCharElem.textContent = this.langChar;\r\n        this.langSeqElem.textContent = this.langSeq;\r\n    }\r\n}\r\n_baseElem = new WeakMap();\r\n// Assert that this extension's constructor has a compatible signature:\r\nVisibleTile;\r\ndefs_JsUtils__WEBPACK_IMPORTED_MODULE_0__.JsUtils.protoNoEnum(VisibleTile, [\"_addToDom\"]);\r\nObject.freeze(VisibleTile);\r\nObject.freeze(VisibleTile.prototype);\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvYmFzZS9mbG9vci9WaXNpYmxlVGlsZS50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovL3NuYWtleTMvLi9zcmMvYmFzZS9mbG9vci9WaXNpYmxlVGlsZS50cz8yNjg4Il0sInNvdXJjZXNDb250ZW50IjpbInZhciBfYmFzZUVsZW07XHJcbmltcG9ydCB7IF9fY2xhc3NQcml2YXRlRmllbGRHZXQsIF9fY2xhc3NQcml2YXRlRmllbGRTZXQgfSBmcm9tIFwidHNsaWJcIjtcclxuaW1wb3J0IHsgSnNVdGlscyB9IGZyb20gXCJkZWZzL0pzVXRpbHNcIjtcclxuaW1wb3J0IHsgT21Ib29rcyB9IGZyb20gXCJkZWZzL09tSG9va3NcIjtcclxuaW1wb3J0IHsgQ29vcmQsIFRpbGUgfSBmcm9tIFwiLi9UaWxlXCI7XHJcbmV4cG9ydCB7IENvb3JkIH07XHJcbi8qKlxyXG4gKiBJbXBsaWNpdGx5IGhhbmRsZXMgdmlzdWFscyB3aXRoIGhlbHAgZnJvbSBDU1MuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgVmlzaWJsZVRpbGUgZXh0ZW5kcyBUaWxlIHtcclxuICAgIGNvbnN0cnVjdG9yKGNvb3JkRGVzYykge1xyXG4gICAgICAgIHN1cGVyKGNvb3JkRGVzYyk7XHJcbiAgICAgICAgX2Jhc2VFbGVtLnNldCh0aGlzLCB2b2lkIDApO1xyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgY29uc3QgYmFzZSA9IF9fY2xhc3NQcml2YXRlRmllbGRTZXQodGhpcywgX2Jhc2VFbGVtLCBKc1V0aWxzLm1rRWwoXCJkaXZcIiwgW1xyXG4gICAgICAgICAgICAgICAgT21Ib29rcy5HZW5lcmFsLkNsYXNzLkNFTlRFUl9DT05URU5UUyxcclxuICAgICAgICAgICAgICAgIE9tSG9va3MuR2VuZXJhbC5DbGFzcy5TVEFDS19DT05URU5UUyxcclxuICAgICAgICAgICAgICAgIE9tSG9va3MuVGlsZS5DbGFzcy5CQVNFLFxyXG4gICAgICAgICAgICBdKSk7XHJcbiAgICAgICAgICAgIGJhc2Uuc2V0QXR0cmlidXRlKFwiYXJpYS1sYWJlbFwiLCBcIlRpbGVcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgLy8gUG9pbnRlciBoaXRib3ggZWxlbWVudC5cclxuICAgICAgICAgICAgLy8gTXVzdCBiZSB0aGUgZmlyc3QgY2hpbGQuIFNlZSBub3RlIGluIENTUyBjbGFzcyBob29rLlxyXG4gICAgICAgICAgICBjb25zdCBwdGhiID0gSnNVdGlscy5ta0VsKFwiZGl2XCIsIFtPbUhvb2tzLlRpbGUuQ2xhc3MuUE9JTlRFUl9IQl0pO1xyXG4gICAgICAgICAgICBwdGhiLnNldEF0dHJpYnV0ZShcImFyaWEtaGlkZGVuXCIsIFwidHJ1ZVwiKTtcclxuICAgICAgICAgICAgX19jbGFzc1ByaXZhdGVGaWVsZEdldCh0aGlzLCBfYmFzZUVsZW0pLmFwcGVuZENoaWxkKHB0aGIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNoYXJXcmFwID0gSnNVdGlscy5ta0VsKFwiZGl2XCIsIFtPbUhvb2tzLlRpbGUuQ2xhc3MuTEFOR19DSEFSX1dSQVBdKTtcclxuICAgICAgICAgICAgY2hhcldyYXAuc2V0QXR0cmlidXRlKFwicm9sZVwiLCBcInByZXNlbnRhdGlvblwiKTtcclxuICAgICAgICAgICAgY29uc3QgY2hhckVsZW0gPSB0aGlzLmxhbmdDaGFyRWxlbSA9IEpzVXRpbHMubWtFbChcImRpdlwiLCBbXSk7XHJcbiAgICAgICAgICAgIGNoYXJXcmFwLmFwcGVuZENoaWxkKGNoYXJFbGVtKTtcclxuICAgICAgICAgICAgX19jbGFzc1ByaXZhdGVGaWVsZEdldCh0aGlzLCBfYmFzZUVsZW0pLmFwcGVuZENoaWxkKGNoYXJXcmFwKTtcclxuICAgICAgICB9XHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBjb25zdCBzZXFFbGVtID0gdGhpcy5sYW5nU2VxRWxlbSA9IEpzVXRpbHMubWtFbChcImRpdlwiLCBbT21Ib29rcy5UaWxlLkNsYXNzLkxBTkdfU0VRXSk7XHJcbiAgICAgICAgICAgIHNlcUVsZW0uc2V0QXR0cmlidXRlKFwicm9sZVwiLCBcInRvb2x0aXBcIik7XHJcbiAgICAgICAgICAgIF9fY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX2Jhc2VFbGVtKS5hcHBlbmRDaGlsZChzZXFFbGVtKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgSnNVdGlscy5wcm9wTm9Xcml0ZSh0aGlzLCBbXCJsYW5nQ2hhckVsZW1cIiwgXCJsYW5nU2VxRWxlbVwiXSk7XHJcbiAgICB9XHJcbiAgICBfYWRkVG9Eb20ocGFyZW50KSB7XHJcbiAgICAgICAgcGFyZW50LmFwcGVuZENoaWxkKF9fY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX2Jhc2VFbGVtKSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEBvdmVycmlkZVxyXG4gICAgICovXHJcbiAgICBfc2V0T2NjdXBhbnQocGxheWVySWQsIGltbWlncmFudEluZm8pIHtcclxuICAgICAgICBzdXBlci5fc2V0T2NjdXBhbnQocGxheWVySWQsIGltbWlncmFudEluZm8pO1xyXG4gICAgICAgIC8vIEl0IG11c3QgZ28gYXQgbGVhc3QgYmVmb3JlIHRoZSBsYW5nQ2hhciBlbGVtZW50IHNvIHRoYXQgdGhlXHJcbiAgICAgICAgLy8gQ1NTIGNhbiBjcmVhdGUgYSBmYWRpbmcgdHJhaWwgZWZmZWN0LiBJdCBtdXN0IGdvIGFmdGVyIHRoZVxyXG4gICAgICAgIC8vIGhpdGJveCBzbyB0aGF0IGl0IGNhbiBiZSBoaWRkZW4gdG8gYXZvaWQgY292ZXJpbmcgdGhlIHRvb2x0aXAuXHJcbiAgICAgICAgdGhpcy5sYW5nQ2hhckVsZW0ucGFyZW50RWxlbWVudC5pbnNlcnRBZGphY2VudEVsZW1lbnQoXCJiZWZvcmViZWdpblwiLCBpbW1pZ3JhbnRJbmZvLnBsYXllckVsZW0pO1xyXG4gICAgICAgIHRoaXMubGFuZ1NlcUVsZW0udGV4dENvbnRlbnQgPSBpbW1pZ3JhbnRJbmZvLnVzZXJuYW1lO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBAb3ZlcnJpZGVcclxuICAgICAqL1xyXG4gICAgZXZpY3RPY2N1cGFudCgpIHtcclxuICAgICAgICBzdXBlci5ldmljdE9jY3VwYW50KCk7XHJcbiAgICAgICAgLy8gVW5kbyBzZXR0aW5nIG1vdXNlb3ZlciB0ZXh0IHRvIHNvbWV0aGluZyBwbGF5ZXItcmVsYXRlZFxyXG4gICAgICAgIC8vIChTZWUgYF9fc2V0T2NjdXBhbnRgIGZvciB3aGF0IHdlIGRpZCBhbmQgbm93IG5lZWQgdG8gdW5kbyk6XHJcbiAgICAgICAgdGhpcy5sYW5nU2VxRWxlbS50ZXh0Q29udGVudCA9IHRoaXMubGFuZ1NlcTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQG92ZXJyaWRlXHJcbiAgICAgKi9cclxuICAgIHNldCBmcmVlSGVhbHRoKG5ld0ZyZWVIZWFsdGgpIHtcclxuICAgICAgICBzdXBlci5mcmVlSGVhbHRoID0gbmV3RnJlZUhlYWx0aDtcclxuICAgICAgICBpZiAodGhpcy5mcmVlSGVhbHRoID4gMCkge1xyXG4gICAgICAgICAgICBfX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHRoaXMsIF9iYXNlRWxlbSkuZGF0YXNldFtPbUhvb2tzLlRpbGUuRGF0YXNldC5IRUFMVEhdID0gdGhpcy5mcmVlSGVhbHRoLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBkZWxldGUgX19jbGFzc1ByaXZhdGVGaWVsZEdldCh0aGlzLCBfYmFzZUVsZW0pLmRhdGFzZXRbT21Ib29rcy5UaWxlLkRhdGFzZXQuSEVBTFRIXTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEBvdmVycmlkZVxyXG4gICAgICovXHJcbiAgICAvLyBOT1RFOiBGb3Igc29tZSByZWFzb24sIGlmIHdlIG92ZXJyaWRlIHRoZSBzZXR0ZXIsIHRoZSB0cmFuc3BpbGVkXHJcbiAgICAvLyBjb2RlIGRvZXMgbm90IGxpbmsgdG8gdGhlIHN1cGVyIGltcGxlbWVudGF0aW9uLi4uIE9yIG1heWJlIHRoaXNcclxuICAgIC8vIGlzIGp1c3QgYSBwcm9wZXJ0eSBvZiBwbGFpbiBFQ01BIGphdmFzY3JpcHQ/P1xyXG4gICAgZ2V0IGZyZWVIZWFsdGgoKSB7XHJcbiAgICAgICAgcmV0dXJuIHN1cGVyLmZyZWVIZWFsdGg7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEBvdmVycmlkZVxyXG4gICAgICovXHJcbiAgICBzZXRMYW5nQ2hhclNlcVBhaXIoY2hhclNlcVBhaXIpIHtcclxuICAgICAgICBzdXBlci5zZXRMYW5nQ2hhclNlcVBhaXIoY2hhclNlcVBhaXIpO1xyXG4gICAgICAgIHRoaXMubGFuZ0NoYXJFbGVtLnRleHRDb250ZW50ID0gdGhpcy5sYW5nQ2hhcjtcclxuICAgICAgICB0aGlzLmxhbmdTZXFFbGVtLnRleHRDb250ZW50ID0gdGhpcy5sYW5nU2VxO1xyXG4gICAgfVxyXG59XHJcbl9iYXNlRWxlbSA9IG5ldyBXZWFrTWFwKCk7XHJcbi8vIEFzc2VydCB0aGF0IHRoaXMgZXh0ZW5zaW9uJ3MgY29uc3RydWN0b3IgaGFzIGEgY29tcGF0aWJsZSBzaWduYXR1cmU6XHJcblZpc2libGVUaWxlO1xyXG5Kc1V0aWxzLnByb3RvTm9FbnVtKFZpc2libGVUaWxlLCBbXCJfYWRkVG9Eb21cIl0pO1xyXG5PYmplY3QuZnJlZXplKFZpc2libGVUaWxlKTtcclxuT2JqZWN0LmZyZWV6ZShWaXNpYmxlVGlsZS5wcm90b3R5cGUpO1xyXG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/base/floor/VisibleTile.ts\n");

/***/ }),

/***/ "./src/base/floor/impl/Beehive.ts":
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"Beehive\": () => /* binding */ Beehive,\n/* harmony export */   \"BeehiveVisibleGrid\": () => /* binding */ BeehiveVisibleGrid\n/* harmony export */ });\n/* harmony import */ var defs_JsUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./src/base/defs/JsUtils.ts\");\n/* harmony import */ var _Grid__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"./src/base/floor/Grid.ts\");\n/* harmony import */ var _VisibleGrid__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"./src/base/floor/VisibleGrid.ts\");\n\r\n\r\n\r\n/**\r\n * # ðŸ BEES !\r\n *\r\n * # ðŸ BEES !\r\n *\r\n * # ðŸ BEES !\r\n *\r\n * ```text\r\n *   ___   ___\r\n *  //  \\_//  \\__\r\n *  \\\\__/  \\__/  \\\r\n *     \\\\__/ \\\\__/\r\n * ```\r\n *\r\n *\r\n * [(bees)](https://giphy.com/gifs/oprah-bees-VhFps32TlNgsg)\r\n */\r\nvar Beehive;\r\n(function (Beehive) {\r\n    /**\r\n     * # Beehive Coord\r\n     */\r\n    class Coord {\r\n        constructor(desc) {\r\n            this.dash = desc.dash;\r\n            this.bash = desc.bash;\r\n            Object.freeze(this);\r\n        }\r\n        _equals(other) {\r\n            return (this.dash === other.dash) && (this.bash === other.bash);\r\n        }\r\n        round() {\r\n            // I'm pretty proud of this despite the fact that I don't\r\n            // think there's anything very impressive about it.\r\n            const floorDash = Math.floor(this.dash);\r\n            const floorBash = Math.floor(this.bash);\r\n            const d = floorDash - this.dash;\r\n            const b = floorBash - this.bash;\r\n            if (d > 2 * b) {\r\n                return new Coord({ dash: floorDash + 1, bash: floorBash });\r\n            }\r\n            else if (d < 0.5 * b) {\r\n                return new Coord({ dash: floorDash, bash: floorBash + 1 });\r\n            }\r\n            else if (Math.min(d, b) > 0.5) {\r\n                return new Coord({ dash: floorDash + 1, bash: floorBash + 1 });\r\n            }\r\n            else {\r\n                return new Coord({ dash: floorDash, bash: floorBash });\r\n            }\r\n        }\r\n        add(other) {\r\n            return new Coord({\r\n                dash: this.dash + other.dash,\r\n                bash: this.bash + other.bash,\r\n            });\r\n        }\r\n        sub(other) {\r\n            return new Coord({\r\n                dash: this.dash - other.dash,\r\n                bash: this.bash - other.bash,\r\n            });\r\n        }\r\n        mul(scalar) {\r\n            return new Coord({\r\n                dash: scalar * this.dash,\r\n                bash: scalar * this.bash,\r\n            });\r\n        }\r\n    }\r\n    Beehive.Coord = Coord;\r\n    Object.freeze(Coord);\r\n    Object.freeze(Coord.prototype);\r\n    /**\r\n     * # Beehive Grid\r\n     */\r\n    class Grid extends _Grid__WEBPACK_IMPORTED_MODULE_1__.Grid {\r\n        constructor(desc) {\r\n            super(desc);\r\n            // Initialize `grid`:\r\n            const grid = undefined;\r\n            this.grid = Object.freeze(grid);\r\n        }\r\n        /**\r\n         * @override\r\n         */\r\n        static getAmbiguityThreshold() {\r\n            return 18;\r\n        }\r\n        /**\r\n         * @override\r\n         */\r\n        static getSizeLimits() { return this.SIZE_LIMITS; }\r\n        forEachTile(consumer) {\r\n            let i = 0;\r\n            for (const row of this.grid) {\r\n                for (const tile of row) {\r\n                    consumer(tile, i++);\r\n                }\r\n            }\r\n        }\r\n        shuffledForEachTile(consumer) {\r\n            this.grid.flat()\r\n                .sort((a, b) => Math.random() - 0.5)\r\n                .forEach((tile) => consumer(tile));\r\n        }\r\n        getUntToward(intendedDest, sourceCoord) {\r\n            return undefined;\r\n        }\r\n        getUntAwayFrom(avoidCoord, sourceCoord) {\r\n            return this.getUntToward(sourceCoord.add(sourceCoord.sub(avoidCoord)), sourceCoord);\r\n        }\r\n        getRandomCoordAround(origin, radius) {\r\n            // Note to self when I implement this:\r\n            // Be careful about getting proper uniform random distribution!\r\n            return undefined;\r\n        }\r\n        _getTileAt(coord) {\r\n            return undefined;\r\n        }\r\n        _getTileDestsFrom(coord, radius = 1) {\r\n            return undefined;\r\n        }\r\n        _getTileSourcesTo(coord, radius = 1) {\r\n            return undefined;\r\n        }\r\n        minMovesFromTo(source, dest) {\r\n            return undefined;\r\n        }\r\n        /**\r\n         * @override\r\n         */\r\n        getDestsFromSourcesTo(originCoord) {\r\n            return this._getTileDestsFrom(originCoord, 2);\r\n        }\r\n        static getSpawnCoords(playerCounts, dimensions) {\r\n            return undefined;\r\n        }\r\n        static getArea(dim) {\r\n            const shorterSide = Math.min(dim.fslash, dim.bslash);\r\n            const longerSide = Math.max(dim.fslash, dim.bslash);\r\n            const width = (-1) + dim.dash + shorterSide;\r\n            let area = 2 * shorterSide * (dim.dash + width);\r\n            area += (longerSide - shorterSide - 1) * width;\r\n            return area;\r\n        }\r\n        static getDiameterOfLatticePatchHavingArea(area) {\r\n            if (area < 0.25) {\r\n                throw new RangeError(\"determinant of a radical will be strictly negative.\");\r\n            }\r\n            // Given radius `r` and diameter = `1 + 2*r`, the area is\r\n            // `1 + 6*r*(1+r)/2`. Rearrange to solve for `d` given the\r\n            // area: `0 = 3r^2 + 3r + (1-a)`. Use quadratic formula.\r\n            const radius = ((-3) + Math.sqrt(9 - (12 * (1 - area)))) / 6;\r\n            return 1 + (2 * radius);\r\n        }\r\n        static getRandomCoord(dimensions) {\r\n            return new Coord(undefined);\r\n        }\r\n    }\r\n    Grid.SIZE_LIMITS = Object.freeze({\r\n        dash: Object.freeze({ min: 10, max: 50 }),\r\n        bslash: Object.freeze({ min: 10, max: 50 }),\r\n        fslash: Object.freeze({ min: 10, max: 50 }),\r\n    });\r\n    Beehive.Grid = Grid;\r\n    defs_JsUtils__WEBPACK_IMPORTED_MODULE_0__.JsUtils.protoNoEnum(Grid, [\"_getTileAt\", \"_getTileDestsFrom\", \"_getTileSourcesTo\"]);\r\n    Object.freeze(Grid);\r\n    Object.freeze(Grid.prototype);\r\n})(Beehive || (Beehive = {}));\r\nObject.freeze(Beehive);\r\n/**\r\n */\r\n// Separated for tree-shaking.\r\nclass BeehiveVisibleGrid extends Beehive.Grid {\r\n    constructor(desc) {\r\n        super(desc);\r\n        const domGrid = undefined;\r\n        // TODO.impl Beehive VisibleGrid ctor.\r\n        this._superVisibleGrid(desc, domGrid);\r\n    }\r\n}\r\n;\r\ndefs_JsUtils__WEBPACK_IMPORTED_MODULE_0__.JsUtils.applyMixins(BeehiveVisibleGrid, [_VisibleGrid__WEBPACK_IMPORTED_MODULE_2__.VisibleGridMixin]);\r\nObject.freeze(BeehiveVisibleGrid);\r\nObject.freeze(BeehiveVisibleGrid.prototype);\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvYmFzZS9mbG9vci9pbXBsL0JlZWhpdmUudHMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zbmFrZXkzLy4vc3JjL2Jhc2UvZmxvb3IvaW1wbC9CZWVoaXZlLnRzP2RmN2QiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSnNVdGlscyB9IGZyb20gXCJkZWZzL0pzVXRpbHNcIjtcclxuaW1wb3J0IHsgR3JpZCBhcyBBYnN0cmFjdEdyaWQgfSBmcm9tIFwiLi4vR3JpZFwiO1xyXG5pbXBvcnQgeyBWaXNpYmxlR3JpZE1peGluIH0gZnJvbSBcIi4uL1Zpc2libGVHcmlkXCI7XHJcbi8qKlxyXG4gKiAjIPCfkJ0gQkVFUyAhXHJcbiAqXHJcbiAqICMg8J+QnSBCRUVTICFcclxuICpcclxuICogIyDwn5CdIEJFRVMgIVxyXG4gKlxyXG4gKiBgYGB0ZXh0XHJcbiAqICAgX19fICAgX19fXHJcbiAqICAvLyAgXFxfLy8gIFxcX19cclxuICogIFxcXFxfXy8gIFxcX18vICBcXFxyXG4gKiAgICAgXFxcXF9fLyBcXFxcX18vXHJcbiAqIGBgYFxyXG4gKlxyXG4gKlxyXG4gKiBbKGJlZXMpXShodHRwczovL2dpcGh5LmNvbS9naWZzL29wcmFoLWJlZXMtVmhGcHMzMlRsTmdzZylcclxuICovXHJcbmV4cG9ydCB2YXIgQmVlaGl2ZTtcclxuKGZ1bmN0aW9uIChCZWVoaXZlKSB7XHJcbiAgICAvKipcclxuICAgICAqICMgQmVlaGl2ZSBDb29yZFxyXG4gICAgICovXHJcbiAgICBjbGFzcyBDb29yZCB7XHJcbiAgICAgICAgY29uc3RydWN0b3IoZGVzYykge1xyXG4gICAgICAgICAgICB0aGlzLmRhc2ggPSBkZXNjLmRhc2g7XHJcbiAgICAgICAgICAgIHRoaXMuYmFzaCA9IGRlc2MuYmFzaDtcclxuICAgICAgICAgICAgT2JqZWN0LmZyZWV6ZSh0aGlzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgX2VxdWFscyhvdGhlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gKHRoaXMuZGFzaCA9PT0gb3RoZXIuZGFzaCkgJiYgKHRoaXMuYmFzaCA9PT0gb3RoZXIuYmFzaCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJvdW5kKCkge1xyXG4gICAgICAgICAgICAvLyBJJ20gcHJldHR5IHByb3VkIG9mIHRoaXMgZGVzcGl0ZSB0aGUgZmFjdCB0aGF0IEkgZG9uJ3RcclxuICAgICAgICAgICAgLy8gdGhpbmsgdGhlcmUncyBhbnl0aGluZyB2ZXJ5IGltcHJlc3NpdmUgYWJvdXQgaXQuXHJcbiAgICAgICAgICAgIGNvbnN0IGZsb29yRGFzaCA9IE1hdGguZmxvb3IodGhpcy5kYXNoKTtcclxuICAgICAgICAgICAgY29uc3QgZmxvb3JCYXNoID0gTWF0aC5mbG9vcih0aGlzLmJhc2gpO1xyXG4gICAgICAgICAgICBjb25zdCBkID0gZmxvb3JEYXNoIC0gdGhpcy5kYXNoO1xyXG4gICAgICAgICAgICBjb25zdCBiID0gZmxvb3JCYXNoIC0gdGhpcy5iYXNoO1xyXG4gICAgICAgICAgICBpZiAoZCA+IDIgKiBiKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvb3JkKHsgZGFzaDogZmxvb3JEYXNoICsgMSwgYmFzaDogZmxvb3JCYXNoIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGQgPCAwLjUgKiBiKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvb3JkKHsgZGFzaDogZmxvb3JEYXNoLCBiYXNoOiBmbG9vckJhc2ggKyAxIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKE1hdGgubWluKGQsIGIpID4gMC41KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENvb3JkKHsgZGFzaDogZmxvb3JEYXNoICsgMSwgYmFzaDogZmxvb3JCYXNoICsgMSB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQ29vcmQoeyBkYXNoOiBmbG9vckRhc2gsIGJhc2g6IGZsb29yQmFzaCB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBhZGQob3RoZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBDb29yZCh7XHJcbiAgICAgICAgICAgICAgICBkYXNoOiB0aGlzLmRhc2ggKyBvdGhlci5kYXNoLFxyXG4gICAgICAgICAgICAgICAgYmFzaDogdGhpcy5iYXNoICsgb3RoZXIuYmFzaCxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHN1YihvdGhlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IENvb3JkKHtcclxuICAgICAgICAgICAgICAgIGRhc2g6IHRoaXMuZGFzaCAtIG90aGVyLmRhc2gsXHJcbiAgICAgICAgICAgICAgICBiYXNoOiB0aGlzLmJhc2ggLSBvdGhlci5iYXNoLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbXVsKHNjYWxhcikge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IENvb3JkKHtcclxuICAgICAgICAgICAgICAgIGRhc2g6IHNjYWxhciAqIHRoaXMuZGFzaCxcclxuICAgICAgICAgICAgICAgIGJhc2g6IHNjYWxhciAqIHRoaXMuYmFzaCxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgQmVlaGl2ZS5Db29yZCA9IENvb3JkO1xyXG4gICAgT2JqZWN0LmZyZWV6ZShDb29yZCk7XHJcbiAgICBPYmplY3QuZnJlZXplKENvb3JkLnByb3RvdHlwZSk7XHJcbiAgICAvKipcclxuICAgICAqICMgQmVlaGl2ZSBHcmlkXHJcbiAgICAgKi9cclxuICAgIGNsYXNzIEdyaWQgZXh0ZW5kcyBBYnN0cmFjdEdyaWQge1xyXG4gICAgICAgIGNvbnN0cnVjdG9yKGRlc2MpIHtcclxuICAgICAgICAgICAgc3VwZXIoZGVzYyk7XHJcbiAgICAgICAgICAgIC8vIEluaXRpYWxpemUgYGdyaWRgOlxyXG4gICAgICAgICAgICBjb25zdCBncmlkID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICB0aGlzLmdyaWQgPSBPYmplY3QuZnJlZXplKGdyaWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAb3ZlcnJpZGVcclxuICAgICAgICAgKi9cclxuICAgICAgICBzdGF0aWMgZ2V0QW1iaWd1aXR5VGhyZXNob2xkKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gMTg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBvdmVycmlkZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHN0YXRpYyBnZXRTaXplTGltaXRzKCkgeyByZXR1cm4gdGhpcy5TSVpFX0xJTUlUUzsgfVxyXG4gICAgICAgIGZvckVhY2hUaWxlKGNvbnN1bWVyKSB7XHJcbiAgICAgICAgICAgIGxldCBpID0gMDtcclxuICAgICAgICAgICAgZm9yIChjb25zdCByb3cgb2YgdGhpcy5ncmlkKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHRpbGUgb2Ygcm93KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3VtZXIodGlsZSwgaSsrKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBzaHVmZmxlZEZvckVhY2hUaWxlKGNvbnN1bWVyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZ3JpZC5mbGF0KClcclxuICAgICAgICAgICAgICAgIC5zb3J0KChhLCBiKSA9PiBNYXRoLnJhbmRvbSgpIC0gMC41KVxyXG4gICAgICAgICAgICAgICAgLmZvckVhY2goKHRpbGUpID0+IGNvbnN1bWVyKHRpbGUpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZ2V0VW50VG93YXJkKGludGVuZGVkRGVzdCwgc291cmNlQ29vcmQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZ2V0VW50QXdheUZyb20oYXZvaWRDb29yZCwgc291cmNlQ29vcmQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0VW50VG93YXJkKHNvdXJjZUNvb3JkLmFkZChzb3VyY2VDb29yZC5zdWIoYXZvaWRDb29yZCkpLCBzb3VyY2VDb29yZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGdldFJhbmRvbUNvb3JkQXJvdW5kKG9yaWdpbiwgcmFkaXVzKSB7XHJcbiAgICAgICAgICAgIC8vIE5vdGUgdG8gc2VsZiB3aGVuIEkgaW1wbGVtZW50IHRoaXM6XHJcbiAgICAgICAgICAgIC8vIEJlIGNhcmVmdWwgYWJvdXQgZ2V0dGluZyBwcm9wZXIgdW5pZm9ybSByYW5kb20gZGlzdHJpYnV0aW9uIVxyXG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICAgIH1cclxuICAgICAgICBfZ2V0VGlsZUF0KGNvb3JkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIF9nZXRUaWxlRGVzdHNGcm9tKGNvb3JkLCByYWRpdXMgPSAxKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIF9nZXRUaWxlU291cmNlc1RvKGNvb3JkLCByYWRpdXMgPSAxKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIG1pbk1vdmVzRnJvbVRvKHNvdXJjZSwgZGVzdCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAb3ZlcnJpZGVcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXREZXN0c0Zyb21Tb3VyY2VzVG8ob3JpZ2luQ29vcmQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2dldFRpbGVEZXN0c0Zyb20ob3JpZ2luQ29vcmQsIDIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBzdGF0aWMgZ2V0U3Bhd25Db29yZHMocGxheWVyQ291bnRzLCBkaW1lbnNpb25zKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHN0YXRpYyBnZXRBcmVhKGRpbSkge1xyXG4gICAgICAgICAgICBjb25zdCBzaG9ydGVyU2lkZSA9IE1hdGgubWluKGRpbS5mc2xhc2gsIGRpbS5ic2xhc2gpO1xyXG4gICAgICAgICAgICBjb25zdCBsb25nZXJTaWRlID0gTWF0aC5tYXgoZGltLmZzbGFzaCwgZGltLmJzbGFzaCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHdpZHRoID0gKC0xKSArIGRpbS5kYXNoICsgc2hvcnRlclNpZGU7XHJcbiAgICAgICAgICAgIGxldCBhcmVhID0gMiAqIHNob3J0ZXJTaWRlICogKGRpbS5kYXNoICsgd2lkdGgpO1xyXG4gICAgICAgICAgICBhcmVhICs9IChsb25nZXJTaWRlIC0gc2hvcnRlclNpZGUgLSAxKSAqIHdpZHRoO1xyXG4gICAgICAgICAgICByZXR1cm4gYXJlYTtcclxuICAgICAgICB9XHJcbiAgICAgICAgc3RhdGljIGdldERpYW1ldGVyT2ZMYXR0aWNlUGF0Y2hIYXZpbmdBcmVhKGFyZWEpIHtcclxuICAgICAgICAgICAgaWYgKGFyZWEgPCAwLjI1KSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcihcImRldGVybWluYW50IG9mIGEgcmFkaWNhbCB3aWxsIGJlIHN0cmljdGx5IG5lZ2F0aXZlLlwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBHaXZlbiByYWRpdXMgYHJgIGFuZCBkaWFtZXRlciA9IGAxICsgMipyYCwgdGhlIGFyZWEgaXNcclxuICAgICAgICAgICAgLy8gYDEgKyA2KnIqKDErcikvMmAuIFJlYXJyYW5nZSB0byBzb2x2ZSBmb3IgYGRgIGdpdmVuIHRoZVxyXG4gICAgICAgICAgICAvLyBhcmVhOiBgMCA9IDNyXjIgKyAzciArICgxLWEpYC4gVXNlIHF1YWRyYXRpYyBmb3JtdWxhLlxyXG4gICAgICAgICAgICBjb25zdCByYWRpdXMgPSAoKC0zKSArIE1hdGguc3FydCg5IC0gKDEyICogKDEgLSBhcmVhKSkpKSAvIDY7XHJcbiAgICAgICAgICAgIHJldHVybiAxICsgKDIgKiByYWRpdXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBzdGF0aWMgZ2V0UmFuZG9tQ29vcmQoZGltZW5zaW9ucykge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IENvb3JkKHVuZGVmaW5lZCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgR3JpZC5TSVpFX0xJTUlUUyA9IE9iamVjdC5mcmVlemUoe1xyXG4gICAgICAgIGRhc2g6IE9iamVjdC5mcmVlemUoeyBtaW46IDEwLCBtYXg6IDUwIH0pLFxyXG4gICAgICAgIGJzbGFzaDogT2JqZWN0LmZyZWV6ZSh7IG1pbjogMTAsIG1heDogNTAgfSksXHJcbiAgICAgICAgZnNsYXNoOiBPYmplY3QuZnJlZXplKHsgbWluOiAxMCwgbWF4OiA1MCB9KSxcclxuICAgIH0pO1xyXG4gICAgQmVlaGl2ZS5HcmlkID0gR3JpZDtcclxuICAgIEpzVXRpbHMucHJvdG9Ob0VudW0oR3JpZCwgW1wiX2dldFRpbGVBdFwiLCBcIl9nZXRUaWxlRGVzdHNGcm9tXCIsIFwiX2dldFRpbGVTb3VyY2VzVG9cIl0pO1xyXG4gICAgT2JqZWN0LmZyZWV6ZShHcmlkKTtcclxuICAgIE9iamVjdC5mcmVlemUoR3JpZC5wcm90b3R5cGUpO1xyXG59KShCZWVoaXZlIHx8IChCZWVoaXZlID0ge30pKTtcclxuT2JqZWN0LmZyZWV6ZShCZWVoaXZlKTtcclxuLyoqXHJcbiAqL1xyXG4vLyBTZXBhcmF0ZWQgZm9yIHRyZWUtc2hha2luZy5cclxuZXhwb3J0IGNsYXNzIEJlZWhpdmVWaXNpYmxlR3JpZCBleHRlbmRzIEJlZWhpdmUuR3JpZCB7XHJcbiAgICBjb25zdHJ1Y3RvcihkZXNjKSB7XHJcbiAgICAgICAgc3VwZXIoZGVzYyk7XHJcbiAgICAgICAgY29uc3QgZG9tR3JpZCA9IHVuZGVmaW5lZDtcclxuICAgICAgICAvLyBUT0RPLmltcGwgQmVlaGl2ZSBWaXNpYmxlR3JpZCBjdG9yLlxyXG4gICAgICAgIHRoaXMuX3N1cGVyVmlzaWJsZUdyaWQoZGVzYywgZG9tR3JpZCk7XHJcbiAgICB9XHJcbn1cclxuO1xyXG5Kc1V0aWxzLmFwcGx5TWl4aW5zKEJlZWhpdmVWaXNpYmxlR3JpZCwgW1Zpc2libGVHcmlkTWl4aW5dKTtcclxuT2JqZWN0LmZyZWV6ZShCZWVoaXZlVmlzaWJsZUdyaWQpO1xyXG5PYmplY3QuZnJlZXplKEJlZWhpdmVWaXNpYmxlR3JpZC5wcm90b3R5cGUpO1xyXG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/base/floor/impl/Beehive.ts\n");

/***/ }),

/***/ "./src/base/floor/impl/Euclid2.ts":
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"Euclid2\": () => /* binding */ Euclid2,\n/* harmony export */   \"Euclid2VisibleGrid\": () => /* binding */ Euclid2VisibleGrid\n/* harmony export */ });\n/* harmony import */ var defs_JsUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./src/base/defs/JsUtils.ts\");\n/* harmony import */ var _Grid__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"./src/base/floor/Grid.ts\");\n/* harmony import */ var _VisibleGrid__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"./src/base/floor/VisibleGrid.ts\");\n\r\n\r\n\r\n/**\r\n *\r\n */\r\nvar Euclid2;\r\n(function (Euclid2) {\r\n    /**\r\n     * # Euclid2 Coord\r\n     */\r\n    class Coord {\r\n        constructor(desc) {\r\n            this.x = desc.x;\r\n            this.y = desc.y;\r\n            Object.freeze(this);\r\n        }\r\n        _equals(other) {\r\n            return (this.x === other.x) && (this.y === other.y);\r\n        }\r\n        round() {\r\n            return new Coord({\r\n                x: Math.round(this.x),\r\n                y: Math.round(this.y),\r\n            });\r\n        }\r\n        /**\r\n         * Also known as the \"manhattan norm\".\r\n         *\r\n         * _Do not override this._\r\n         *\r\n         * @param other - The norm is taken relative to `other`.\r\n         * @returns The sum of the absolute values of each coordinate.\r\n         */\r\n        oneNorm(other) {\r\n            return this.sub(other).originOneNorm();\r\n        }\r\n        originOneNorm() {\r\n            return Math.abs(this.x) + Math.abs(this.y);\r\n        }\r\n        /**\r\n         *\r\n         * _Do not override this._\r\n         *\r\n         * @param other - The norm is taken relative to `other`.\r\n         * @returns The length of the longest dimension.\r\n         */\r\n        infNorm(other) {\r\n            return this.sub(other).originInfNorm();\r\n        }\r\n        originInfNorm() {\r\n            return Math.max(Math.abs(this.x), Math.abs(this.y));\r\n        }\r\n        /**\r\n         * @returns\r\n         * A number in the range (0, 1). `One` means the x and y coordinates\r\n         * align to the x or y axis, and `Zero` means they are plus or minus\r\n         * 45 degrees from the x or y axis.\r\n         *\r\n         * You can try this yourself in [Desmos](https://www.desmos.com/calculator)\r\n         * by pasting in the below code segment and adding a slider for `a`\r\n         * for continuous values between zero and one.\r\n         *\r\n         * ```latex\r\n         * \\frac{\\left|\\left|x\\right|-\\left|y\\right|\\right|}{\\left|x\\right|+\\left|y\\right|}=a\r\n         * ```\r\n         *\r\n         * @param other - The alignment is taken relative to `other`.\r\n         */\r\n        axialAlignment(other) {\r\n            return this.sub(other).originAxialAlignment();\r\n        }\r\n        originAxialAlignment() {\r\n            return Math.abs(Math.abs(this.x) - Math.abs(this.y))\r\n                / (Math.abs(this.x) + Math.abs(this.y));\r\n        }\r\n        add(other) {\r\n            return new Coord({\r\n                x: this.x + other.x,\r\n                y: this.y + other.y,\r\n            });\r\n        }\r\n        sub(other) {\r\n            return new Coord({\r\n                x: this.x - other.x,\r\n                y: this.y - other.y,\r\n            });\r\n        }\r\n        /**\r\n         * @override\r\n         */\r\n        mul(scalar) {\r\n            return new Coord({\r\n                x: scalar * this.x,\r\n                y: scalar * this.y,\r\n            });\r\n        }\r\n    }\r\n    Euclid2.Coord = Coord;\r\n    Object.freeze(Coord);\r\n    Object.freeze(Coord.prototype);\r\n    /**\r\n     * # Euclid2 Grid\r\n     */\r\n    class Grid extends _Grid__WEBPACK_IMPORTED_MODULE_1__.Grid {\r\n        constructor(desc) {\r\n            super(desc);\r\n            const grid = [];\r\n            for (let row = 0; row < this.dimensions.height; row++) {\r\n                const newRow = [];\r\n                for (let col = 0; col < this.dimensions.width; col++) {\r\n                    const newTile = new desc.tileClass(new Coord({ x: col, y: row }));\r\n                    newRow.push(newTile);\r\n                }\r\n                grid.push(Object.freeze(newRow));\r\n            }\r\n            this.grid = Object.freeze(grid);\r\n        }\r\n        static getAmbiguityThreshold() {\r\n            return 24;\r\n        }\r\n        static getSizeLimits() { return this.SIZE_LIMITS; }\r\n        forEachTile(consumer) {\r\n            let i = 0;\r\n            for (const row of this.grid) {\r\n                for (const tile of row) {\r\n                    consumer(tile, i++);\r\n                }\r\n            }\r\n        }\r\n        shuffledForEachTile(consumer) {\r\n            this.grid.flat()\r\n                .sort((a, b) => Math.random() - 0.5)\r\n                .forEach((tile) => consumer(tile));\r\n        }\r\n        getUntToward(intendedDest, sourceCoord) {\r\n            const options = this.tile.destsFrom(sourceCoord).unoccupied.get;\r\n            if (options.length === 0) {\r\n                return this.tile.at(sourceCoord);\r\n            }\r\n            if (options.length === 1) {\r\n                // Minor optimization:\r\n                return options[0];\r\n            }\r\n            options.sort((tileA, TileB) => {\r\n                // Break (some) ties by one-norm:\r\n                return tileA.coord.oneNorm(intendedDest) - TileB.coord.oneNorm(intendedDest);\r\n            }).sort((tileA, TileB) => {\r\n                // Break (some) ties by one-norm:\r\n                return tileA.coord.infNorm(intendedDest) - TileB.coord.infNorm(intendedDest);\r\n            });\r\n            // Filter out options that are not equally favourable as the\r\n            // most favourable option. I think this is the best method:\r\n            // Note: it is safe to start at index `1` because of the\r\n            // above short-circuit if `options.length === 1`.\r\n            for (let i = 1; i < options.length; i++) {\r\n                if (options[i].coord.infNorm(intendedDest) > options[0].coord.infNorm(intendedDest)) {\r\n                    options.splice(i);\r\n                    break;\r\n                }\r\n            }\r\n            if (options.length === 1) {\r\n                // Minor optimization:\r\n                return options[0];\r\n            }\r\n            // Choose one of the most favourable using some randomness\r\n            // weighted to follow a straight-looking path of movement.\r\n            if (options[0].coord.x - sourceCoord.x === 0 || options[0].coord.y - sourceCoord.y === 0) {\r\n                // (the axial option (if it exists) should be the first\r\n                // due to the previous sort's tie-breaker.\r\n                if (sourceCoord.axialAlignment(sourceCoord.sub(intendedDest)) - 0.5 > 0.0) {\r\n                    // The path to the intended destination is aligned more\r\n                    // with the x or y axis than they are with those axes\r\n                    // rotated 45 degrees.\r\n                    return options[0];\r\n                }\r\n                else {\r\n                    // Ignore the axial option in further computations:\r\n                    options.shift();\r\n                }\r\n            }\r\n            // Choose a random non-axial option:\r\n            return options[Math.floor(options.length * Math.random())];\r\n        }\r\n        getUntAwayFrom(avoidCoord, sourceCoord) {\r\n            return this.getUntToward(sourceCoord.add(sourceCoord.sub(avoidCoord)), sourceCoord);\r\n        }\r\n        /**\r\n         * @override\r\n         */\r\n        getDestsFromSourcesTo(originCoord) {\r\n            return this._getTileDestsFrom(originCoord, 2);\r\n        }\r\n        getRandomCoordAround(origin, radius) {\r\n            return new Coord({\r\n                x: origin.x + Math.trunc(2 * radius * (Math.random() - 0.5)),\r\n                y: origin.y + Math.trunc(2 * radius * (Math.random() - 0.5)),\r\n            });\r\n        }\r\n        _getTileAt(coord) {\r\n            // if (coord.x < 0 || coord.x >= this.dimensions.width ||\r\n            //     coord.y < 0 || coord.y >= this.dimensions.height\r\n            // ) {\r\n            //     throw new RangeError(\"Out of bounds. No such tile exists.\");\r\n            // }\r\n            return this.grid[coord.y][coord.x];\r\n        }\r\n        _getTileDestsFrom(coord, radius = 1) {\r\n            let t = coord.y - radius;\r\n            let b = coord.y + radius + 1;\r\n            let l = coord.x - radius;\r\n            let r = coord.x + radius + 1;\r\n            if (t >= this.dimensions.height || b < 0\r\n                || l >= this.dimensions.width || r < 0)\r\n                return [];\r\n            return this.grid.slice(\r\n            // filter for included rows:\r\n            Math.max(0, t), Math.min(this.dimensions.height, b)).flatMap((gridRow) => gridRow.slice(\r\n            // filter for included slices of rows (columns):\r\n            Math.max(0, l), Math.min(this.dimensions.width, r)));\r\n        }\r\n        _getTileSourcesTo(coord, radius = 1) {\r\n            // Same behaviour as getting destinations from `coord`.\r\n            return this._getTileDestsFrom(coord, radius);\r\n        }\r\n        minMovesFromTo(source, dest) {\r\n            return Math.min(Math.abs(dest.x - source.x), Math.abs(dest.y - source.y));\r\n        }\r\n        static getSpawnCoords(playerCounts, dimensions) {\r\n            const avoidSet = [];\r\n            return playerCounts.map((numMembers) => {\r\n                const teamSpawnCoords = [];\r\n                while (numMembers > 0) {\r\n                    let coord;\r\n                    do {\r\n                        coord = Grid.getRandomCoord(dimensions);\r\n                    } while (avoidSet.find((other) => coord._equals(other)));\r\n                    teamSpawnCoords.push(coord);\r\n                    avoidSet.push(coord);\r\n                    numMembers--;\r\n                }\r\n                return teamSpawnCoords;\r\n            });\r\n        }\r\n        static getArea(dim) {\r\n            return dim.height * dim.width;\r\n        }\r\n        static getDiameterOfLatticePatchHavingArea(area) {\r\n            return Math.sqrt(area);\r\n        }\r\n        static getRandomCoord(dimensions) {\r\n            const x = Math.floor(dimensions.width * Math.random());\r\n            const y = Math.floor(dimensions.height * Math.random());\r\n            return new Coord({ x, y });\r\n        }\r\n    }\r\n    Grid.SIZE_LIMITS = Object.freeze({\r\n        height: Object.freeze({ min: 11, max: 51 }),\r\n        width: Object.freeze({ min: 11, max: 51 }),\r\n    });\r\n    Euclid2.Grid = Grid;\r\n    defs_JsUtils__WEBPACK_IMPORTED_MODULE_0__.JsUtils.protoNoEnum(Grid, [\"_getTileAt\", \"_getTileDestsFrom\", \"_getTileSourcesTo\"]);\r\n    Object.freeze(Grid);\r\n    Object.freeze(Grid.prototype);\r\n})(Euclid2 || (Euclid2 = {}));\r\nObject.freeze(Euclid2);\r\n/**\r\n */\r\n// Separated for tree-shaking.\r\nclass Euclid2VisibleGrid extends Euclid2.Grid {\r\n    constructor(desc) {\r\n        super(desc);\r\n        const gridElem = defs_JsUtils__WEBPACK_IMPORTED_MODULE_0__.JsUtils.mkEl(\"div\", []);\r\n        gridElem.style.setProperty(\"--euclid2-grid-width\", this.dimensions.width.toString());\r\n        // At below use of for loop without breaks: For shallower stack when debugging.\r\n        for (const row of this.grid) {\r\n            for (const tile of row) {\r\n                tile._addToDom(gridElem);\r\n            }\r\n        }\r\n        this._superVisibleGrid(desc, gridElem);\r\n    }\r\n}\r\n;\r\ndefs_JsUtils__WEBPACK_IMPORTED_MODULE_0__.JsUtils.applyMixins(Euclid2VisibleGrid, [_VisibleGrid__WEBPACK_IMPORTED_MODULE_2__.VisibleGridMixin]);\r\nObject.freeze(Euclid2VisibleGrid);\r\nObject.freeze(Euclid2VisibleGrid.prototype);\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvYmFzZS9mbG9vci9pbXBsL0V1Y2xpZDIudHMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zbmFrZXkzLy4vc3JjL2Jhc2UvZmxvb3IvaW1wbC9FdWNsaWQyLnRzPzExN2UiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSnNVdGlscyB9IGZyb20gXCJkZWZzL0pzVXRpbHNcIjtcclxuaW1wb3J0IHsgR3JpZCBhcyBBYnN0cmFjdEdyaWQgfSBmcm9tIFwiLi4vR3JpZFwiO1xyXG5pbXBvcnQgeyBWaXNpYmxlR3JpZE1peGluIH0gZnJvbSBcIi4uL1Zpc2libGVHcmlkXCI7XHJcbi8qKlxyXG4gKlxyXG4gKi9cclxuZXhwb3J0IHZhciBFdWNsaWQyO1xyXG4oZnVuY3Rpb24gKEV1Y2xpZDIpIHtcclxuICAgIC8qKlxyXG4gICAgICogIyBFdWNsaWQyIENvb3JkXHJcbiAgICAgKi9cclxuICAgIGNsYXNzIENvb3JkIHtcclxuICAgICAgICBjb25zdHJ1Y3RvcihkZXNjKSB7XHJcbiAgICAgICAgICAgIHRoaXMueCA9IGRlc2MueDtcclxuICAgICAgICAgICAgdGhpcy55ID0gZGVzYy55O1xyXG4gICAgICAgICAgICBPYmplY3QuZnJlZXplKHRoaXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBfZXF1YWxzKG90aGVyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAodGhpcy54ID09PSBvdGhlci54KSAmJiAodGhpcy55ID09PSBvdGhlci55KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcm91bmQoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgQ29vcmQoe1xyXG4gICAgICAgICAgICAgICAgeDogTWF0aC5yb3VuZCh0aGlzLngpLFxyXG4gICAgICAgICAgICAgICAgeTogTWF0aC5yb3VuZCh0aGlzLnkpLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQWxzbyBrbm93biBhcyB0aGUgXCJtYW5oYXR0YW4gbm9ybVwiLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogX0RvIG5vdCBvdmVycmlkZSB0aGlzLl9cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSBvdGhlciAtIFRoZSBub3JtIGlzIHRha2VuIHJlbGF0aXZlIHRvIGBvdGhlcmAuXHJcbiAgICAgICAgICogQHJldHVybnMgVGhlIHN1bSBvZiB0aGUgYWJzb2x1dGUgdmFsdWVzIG9mIGVhY2ggY29vcmRpbmF0ZS5cclxuICAgICAgICAgKi9cclxuICAgICAgICBvbmVOb3JtKG90aGVyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN1YihvdGhlcikub3JpZ2luT25lTm9ybSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBvcmlnaW5PbmVOb3JtKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gTWF0aC5hYnModGhpcy54KSArIE1hdGguYWJzKHRoaXMueSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogX0RvIG5vdCBvdmVycmlkZSB0aGlzLl9cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSBvdGhlciAtIFRoZSBub3JtIGlzIHRha2VuIHJlbGF0aXZlIHRvIGBvdGhlcmAuXHJcbiAgICAgICAgICogQHJldHVybnMgVGhlIGxlbmd0aCBvZiB0aGUgbG9uZ2VzdCBkaW1lbnNpb24uXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaW5mTm9ybShvdGhlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdWIob3RoZXIpLm9yaWdpbkluZk5vcm0oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgb3JpZ2luSW5mTm9ybSgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIE1hdGgubWF4KE1hdGguYWJzKHRoaXMueCksIE1hdGguYWJzKHRoaXMueSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAcmV0dXJuc1xyXG4gICAgICAgICAqIEEgbnVtYmVyIGluIHRoZSByYW5nZSAoMCwgMSkuIGBPbmVgIG1lYW5zIHRoZSB4IGFuZCB5IGNvb3JkaW5hdGVzXHJcbiAgICAgICAgICogYWxpZ24gdG8gdGhlIHggb3IgeSBheGlzLCBhbmQgYFplcm9gIG1lYW5zIHRoZXkgYXJlIHBsdXMgb3IgbWludXNcclxuICAgICAgICAgKiA0NSBkZWdyZWVzIGZyb20gdGhlIHggb3IgeSBheGlzLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogWW91IGNhbiB0cnkgdGhpcyB5b3Vyc2VsZiBpbiBbRGVzbW9zXShodHRwczovL3d3dy5kZXNtb3MuY29tL2NhbGN1bGF0b3IpXHJcbiAgICAgICAgICogYnkgcGFzdGluZyBpbiB0aGUgYmVsb3cgY29kZSBzZWdtZW50IGFuZCBhZGRpbmcgYSBzbGlkZXIgZm9yIGBhYFxyXG4gICAgICAgICAqIGZvciBjb250aW51b3VzIHZhbHVlcyBiZXR3ZWVuIHplcm8gYW5kIG9uZS5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIGBgYGxhdGV4XHJcbiAgICAgICAgICogXFxmcmFje1xcbGVmdHxcXGxlZnR8eFxccmlnaHR8LVxcbGVmdHx5XFxyaWdodHxcXHJpZ2h0fH17XFxsZWZ0fHhcXHJpZ2h0fCtcXGxlZnR8eVxccmlnaHR8fT1hXHJcbiAgICAgICAgICogYGBgXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0gb3RoZXIgLSBUaGUgYWxpZ25tZW50IGlzIHRha2VuIHJlbGF0aXZlIHRvIGBvdGhlcmAuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgYXhpYWxBbGlnbm1lbnQob3RoZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3ViKG90aGVyKS5vcmlnaW5BeGlhbEFsaWdubWVudCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBvcmlnaW5BeGlhbEFsaWdubWVudCgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIE1hdGguYWJzKE1hdGguYWJzKHRoaXMueCkgLSBNYXRoLmFicyh0aGlzLnkpKVxyXG4gICAgICAgICAgICAgICAgLyAoTWF0aC5hYnModGhpcy54KSArIE1hdGguYWJzKHRoaXMueSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBhZGQob3RoZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBDb29yZCh7XHJcbiAgICAgICAgICAgICAgICB4OiB0aGlzLnggKyBvdGhlci54LFxyXG4gICAgICAgICAgICAgICAgeTogdGhpcy55ICsgb3RoZXIueSxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHN1YihvdGhlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IENvb3JkKHtcclxuICAgICAgICAgICAgICAgIHg6IHRoaXMueCAtIG90aGVyLngsXHJcbiAgICAgICAgICAgICAgICB5OiB0aGlzLnkgLSBvdGhlci55LFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQG92ZXJyaWRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgbXVsKHNjYWxhcikge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IENvb3JkKHtcclxuICAgICAgICAgICAgICAgIHg6IHNjYWxhciAqIHRoaXMueCxcclxuICAgICAgICAgICAgICAgIHk6IHNjYWxhciAqIHRoaXMueSxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgRXVjbGlkMi5Db29yZCA9IENvb3JkO1xyXG4gICAgT2JqZWN0LmZyZWV6ZShDb29yZCk7XHJcbiAgICBPYmplY3QuZnJlZXplKENvb3JkLnByb3RvdHlwZSk7XHJcbiAgICAvKipcclxuICAgICAqICMgRXVjbGlkMiBHcmlkXHJcbiAgICAgKi9cclxuICAgIGNsYXNzIEdyaWQgZXh0ZW5kcyBBYnN0cmFjdEdyaWQge1xyXG4gICAgICAgIGNvbnN0cnVjdG9yKGRlc2MpIHtcclxuICAgICAgICAgICAgc3VwZXIoZGVzYyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGdyaWQgPSBbXTtcclxuICAgICAgICAgICAgZm9yIChsZXQgcm93ID0gMDsgcm93IDwgdGhpcy5kaW1lbnNpb25zLmhlaWdodDsgcm93KyspIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5ld1JvdyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgY29sID0gMDsgY29sIDwgdGhpcy5kaW1lbnNpb25zLndpZHRoOyBjb2wrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld1RpbGUgPSBuZXcgZGVzYy50aWxlQ2xhc3MobmV3IENvb3JkKHsgeDogY29sLCB5OiByb3cgfSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIG5ld1Jvdy5wdXNoKG5ld1RpbGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZ3JpZC5wdXNoKE9iamVjdC5mcmVlemUobmV3Um93KSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5ncmlkID0gT2JqZWN0LmZyZWV6ZShncmlkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgc3RhdGljIGdldEFtYmlndWl0eVRocmVzaG9sZCgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIDI0O1xyXG4gICAgICAgIH1cclxuICAgICAgICBzdGF0aWMgZ2V0U2l6ZUxpbWl0cygpIHsgcmV0dXJuIHRoaXMuU0laRV9MSU1JVFM7IH1cclxuICAgICAgICBmb3JFYWNoVGlsZShjb25zdW1lcikge1xyXG4gICAgICAgICAgICBsZXQgaSA9IDA7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3Qgcm93IG9mIHRoaXMuZ3JpZCkge1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0aWxlIG9mIHJvdykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN1bWVyKHRpbGUsIGkrKyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgc2h1ZmZsZWRGb3JFYWNoVGlsZShjb25zdW1lcikge1xyXG4gICAgICAgICAgICB0aGlzLmdyaWQuZmxhdCgpXHJcbiAgICAgICAgICAgICAgICAuc29ydCgoYSwgYikgPT4gTWF0aC5yYW5kb20oKSAtIDAuNSlcclxuICAgICAgICAgICAgICAgIC5mb3JFYWNoKCh0aWxlKSA9PiBjb25zdW1lcih0aWxlKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGdldFVudFRvd2FyZChpbnRlbmRlZERlc3QsIHNvdXJjZUNvb3JkKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG9wdGlvbnMgPSB0aGlzLnRpbGUuZGVzdHNGcm9tKHNvdXJjZUNvb3JkKS51bm9jY3VwaWVkLmdldDtcclxuICAgICAgICAgICAgaWYgKG9wdGlvbnMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy50aWxlLmF0KHNvdXJjZUNvb3JkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAob3B0aW9ucy5sZW5ndGggPT09IDEpIHtcclxuICAgICAgICAgICAgICAgIC8vIE1pbm9yIG9wdGltaXphdGlvbjpcclxuICAgICAgICAgICAgICAgIHJldHVybiBvcHRpb25zWzBdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG9wdGlvbnMuc29ydCgodGlsZUEsIFRpbGVCKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAvLyBCcmVhayAoc29tZSkgdGllcyBieSBvbmUtbm9ybTpcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aWxlQS5jb29yZC5vbmVOb3JtKGludGVuZGVkRGVzdCkgLSBUaWxlQi5jb29yZC5vbmVOb3JtKGludGVuZGVkRGVzdCk7XHJcbiAgICAgICAgICAgIH0pLnNvcnQoKHRpbGVBLCBUaWxlQikgPT4ge1xyXG4gICAgICAgICAgICAgICAgLy8gQnJlYWsgKHNvbWUpIHRpZXMgYnkgb25lLW5vcm06XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGlsZUEuY29vcmQuaW5mTm9ybShpbnRlbmRlZERlc3QpIC0gVGlsZUIuY29vcmQuaW5mTm9ybShpbnRlbmRlZERlc3QpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgLy8gRmlsdGVyIG91dCBvcHRpb25zIHRoYXQgYXJlIG5vdCBlcXVhbGx5IGZhdm91cmFibGUgYXMgdGhlXHJcbiAgICAgICAgICAgIC8vIG1vc3QgZmF2b3VyYWJsZSBvcHRpb24uIEkgdGhpbmsgdGhpcyBpcyB0aGUgYmVzdCBtZXRob2Q6XHJcbiAgICAgICAgICAgIC8vIE5vdGU6IGl0IGlzIHNhZmUgdG8gc3RhcnQgYXQgaW5kZXggYDFgIGJlY2F1c2Ugb2YgdGhlXHJcbiAgICAgICAgICAgIC8vIGFib3ZlIHNob3J0LWNpcmN1aXQgaWYgYG9wdGlvbnMubGVuZ3RoID09PSAxYC5cclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCBvcHRpb25zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9uc1tpXS5jb29yZC5pbmZOb3JtKGludGVuZGVkRGVzdCkgPiBvcHRpb25zWzBdLmNvb3JkLmluZk5vcm0oaW50ZW5kZWREZXN0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuc3BsaWNlKGkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChvcHRpb25zLmxlbmd0aCA9PT0gMSkge1xyXG4gICAgICAgICAgICAgICAgLy8gTWlub3Igb3B0aW1pemF0aW9uOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG9wdGlvbnNbMF07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gQ2hvb3NlIG9uZSBvZiB0aGUgbW9zdCBmYXZvdXJhYmxlIHVzaW5nIHNvbWUgcmFuZG9tbmVzc1xyXG4gICAgICAgICAgICAvLyB3ZWlnaHRlZCB0byBmb2xsb3cgYSBzdHJhaWdodC1sb29raW5nIHBhdGggb2YgbW92ZW1lbnQuXHJcbiAgICAgICAgICAgIGlmIChvcHRpb25zWzBdLmNvb3JkLnggLSBzb3VyY2VDb29yZC54ID09PSAwIHx8IG9wdGlvbnNbMF0uY29vcmQueSAtIHNvdXJjZUNvb3JkLnkgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIC8vICh0aGUgYXhpYWwgb3B0aW9uIChpZiBpdCBleGlzdHMpIHNob3VsZCBiZSB0aGUgZmlyc3RcclxuICAgICAgICAgICAgICAgIC8vIGR1ZSB0byB0aGUgcHJldmlvdXMgc29ydCdzIHRpZS1icmVha2VyLlxyXG4gICAgICAgICAgICAgICAgaWYgKHNvdXJjZUNvb3JkLmF4aWFsQWxpZ25tZW50KHNvdXJjZUNvb3JkLnN1YihpbnRlbmRlZERlc3QpKSAtIDAuNSA+IDAuMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFRoZSBwYXRoIHRvIHRoZSBpbnRlbmRlZCBkZXN0aW5hdGlvbiBpcyBhbGlnbmVkIG1vcmVcclxuICAgICAgICAgICAgICAgICAgICAvLyB3aXRoIHRoZSB4IG9yIHkgYXhpcyB0aGFuIHRoZXkgYXJlIHdpdGggdGhvc2UgYXhlc1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHJvdGF0ZWQgNDUgZGVncmVlcy5cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gb3B0aW9uc1swXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIElnbm9yZSB0aGUgYXhpYWwgb3B0aW9uIGluIGZ1cnRoZXIgY29tcHV0YXRpb25zOlxyXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuc2hpZnQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBDaG9vc2UgYSByYW5kb20gbm9uLWF4aWFsIG9wdGlvbjpcclxuICAgICAgICAgICAgcmV0dXJuIG9wdGlvbnNbTWF0aC5mbG9vcihvcHRpb25zLmxlbmd0aCAqIE1hdGgucmFuZG9tKCkpXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZ2V0VW50QXdheUZyb20oYXZvaWRDb29yZCwgc291cmNlQ29vcmQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0VW50VG93YXJkKHNvdXJjZUNvb3JkLmFkZChzb3VyY2VDb29yZC5zdWIoYXZvaWRDb29yZCkpLCBzb3VyY2VDb29yZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBvdmVycmlkZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldERlc3RzRnJvbVNvdXJjZXNUbyhvcmlnaW5Db29yZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZ2V0VGlsZURlc3RzRnJvbShvcmlnaW5Db29yZCwgMik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGdldFJhbmRvbUNvb3JkQXJvdW5kKG9yaWdpbiwgcmFkaXVzKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgQ29vcmQoe1xyXG4gICAgICAgICAgICAgICAgeDogb3JpZ2luLnggKyBNYXRoLnRydW5jKDIgKiByYWRpdXMgKiAoTWF0aC5yYW5kb20oKSAtIDAuNSkpLFxyXG4gICAgICAgICAgICAgICAgeTogb3JpZ2luLnkgKyBNYXRoLnRydW5jKDIgKiByYWRpdXMgKiAoTWF0aC5yYW5kb20oKSAtIDAuNSkpLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgX2dldFRpbGVBdChjb29yZCkge1xyXG4gICAgICAgICAgICAvLyBpZiAoY29vcmQueCA8IDAgfHwgY29vcmQueCA+PSB0aGlzLmRpbWVuc2lvbnMud2lkdGggfHxcclxuICAgICAgICAgICAgLy8gICAgIGNvb3JkLnkgPCAwIHx8IGNvb3JkLnkgPj0gdGhpcy5kaW1lbnNpb25zLmhlaWdodFxyXG4gICAgICAgICAgICAvLyApIHtcclxuICAgICAgICAgICAgLy8gICAgIHRocm93IG5ldyBSYW5nZUVycm9yKFwiT3V0IG9mIGJvdW5kcy4gTm8gc3VjaCB0aWxlIGV4aXN0cy5cIik7XHJcbiAgICAgICAgICAgIC8vIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ3JpZFtjb29yZC55XVtjb29yZC54XTtcclxuICAgICAgICB9XHJcbiAgICAgICAgX2dldFRpbGVEZXN0c0Zyb20oY29vcmQsIHJhZGl1cyA9IDEpIHtcclxuICAgICAgICAgICAgbGV0IHQgPSBjb29yZC55IC0gcmFkaXVzO1xyXG4gICAgICAgICAgICBsZXQgYiA9IGNvb3JkLnkgKyByYWRpdXMgKyAxO1xyXG4gICAgICAgICAgICBsZXQgbCA9IGNvb3JkLnggLSByYWRpdXM7XHJcbiAgICAgICAgICAgIGxldCByID0gY29vcmQueCArIHJhZGl1cyArIDE7XHJcbiAgICAgICAgICAgIGlmICh0ID49IHRoaXMuZGltZW5zaW9ucy5oZWlnaHQgfHwgYiA8IDBcclxuICAgICAgICAgICAgICAgIHx8IGwgPj0gdGhpcy5kaW1lbnNpb25zLndpZHRoIHx8IHIgPCAwKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5ncmlkLnNsaWNlKFxyXG4gICAgICAgICAgICAvLyBmaWx0ZXIgZm9yIGluY2x1ZGVkIHJvd3M6XHJcbiAgICAgICAgICAgIE1hdGgubWF4KDAsIHQpLCBNYXRoLm1pbih0aGlzLmRpbWVuc2lvbnMuaGVpZ2h0LCBiKSkuZmxhdE1hcCgoZ3JpZFJvdykgPT4gZ3JpZFJvdy5zbGljZShcclxuICAgICAgICAgICAgLy8gZmlsdGVyIGZvciBpbmNsdWRlZCBzbGljZXMgb2Ygcm93cyAoY29sdW1ucyk6XHJcbiAgICAgICAgICAgIE1hdGgubWF4KDAsIGwpLCBNYXRoLm1pbih0aGlzLmRpbWVuc2lvbnMud2lkdGgsIHIpKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIF9nZXRUaWxlU291cmNlc1RvKGNvb3JkLCByYWRpdXMgPSAxKSB7XHJcbiAgICAgICAgICAgIC8vIFNhbWUgYmVoYXZpb3VyIGFzIGdldHRpbmcgZGVzdGluYXRpb25zIGZyb20gYGNvb3JkYC5cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2dldFRpbGVEZXN0c0Zyb20oY29vcmQsIHJhZGl1cyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIG1pbk1vdmVzRnJvbVRvKHNvdXJjZSwgZGVzdCkge1xyXG4gICAgICAgICAgICByZXR1cm4gTWF0aC5taW4oTWF0aC5hYnMoZGVzdC54IC0gc291cmNlLngpLCBNYXRoLmFicyhkZXN0LnkgLSBzb3VyY2UueSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBzdGF0aWMgZ2V0U3Bhd25Db29yZHMocGxheWVyQ291bnRzLCBkaW1lbnNpb25zKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGF2b2lkU2V0ID0gW107XHJcbiAgICAgICAgICAgIHJldHVybiBwbGF5ZXJDb3VudHMubWFwKChudW1NZW1iZXJzKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ZWFtU3Bhd25Db29yZHMgPSBbXTtcclxuICAgICAgICAgICAgICAgIHdoaWxlIChudW1NZW1iZXJzID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBjb29yZDtcclxuICAgICAgICAgICAgICAgICAgICBkbyB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvb3JkID0gR3JpZC5nZXRSYW5kb21Db29yZChkaW1lbnNpb25zKTtcclxuICAgICAgICAgICAgICAgICAgICB9IHdoaWxlIChhdm9pZFNldC5maW5kKChvdGhlcikgPT4gY29vcmQuX2VxdWFscyhvdGhlcikpKTtcclxuICAgICAgICAgICAgICAgICAgICB0ZWFtU3Bhd25Db29yZHMucHVzaChjb29yZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYXZvaWRTZXQucHVzaChjb29yZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbnVtTWVtYmVycy0tO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRlYW1TcGF3bkNvb3JkcztcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHN0YXRpYyBnZXRBcmVhKGRpbSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZGltLmhlaWdodCAqIGRpbS53aWR0aDtcclxuICAgICAgICB9XHJcbiAgICAgICAgc3RhdGljIGdldERpYW1ldGVyT2ZMYXR0aWNlUGF0Y2hIYXZpbmdBcmVhKGFyZWEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIE1hdGguc3FydChhcmVhKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgc3RhdGljIGdldFJhbmRvbUNvb3JkKGRpbWVuc2lvbnMpIHtcclxuICAgICAgICAgICAgY29uc3QgeCA9IE1hdGguZmxvb3IoZGltZW5zaW9ucy53aWR0aCAqIE1hdGgucmFuZG9tKCkpO1xyXG4gICAgICAgICAgICBjb25zdCB5ID0gTWF0aC5mbG9vcihkaW1lbnNpb25zLmhlaWdodCAqIE1hdGgucmFuZG9tKCkpO1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IENvb3JkKHsgeCwgeSB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBHcmlkLlNJWkVfTElNSVRTID0gT2JqZWN0LmZyZWV6ZSh7XHJcbiAgICAgICAgaGVpZ2h0OiBPYmplY3QuZnJlZXplKHsgbWluOiAxMSwgbWF4OiA1MSB9KSxcclxuICAgICAgICB3aWR0aDogT2JqZWN0LmZyZWV6ZSh7IG1pbjogMTEsIG1heDogNTEgfSksXHJcbiAgICB9KTtcclxuICAgIEV1Y2xpZDIuR3JpZCA9IEdyaWQ7XHJcbiAgICBKc1V0aWxzLnByb3RvTm9FbnVtKEdyaWQsIFtcIl9nZXRUaWxlQXRcIiwgXCJfZ2V0VGlsZURlc3RzRnJvbVwiLCBcIl9nZXRUaWxlU291cmNlc1RvXCJdKTtcclxuICAgIE9iamVjdC5mcmVlemUoR3JpZCk7XHJcbiAgICBPYmplY3QuZnJlZXplKEdyaWQucHJvdG90eXBlKTtcclxufSkoRXVjbGlkMiB8fCAoRXVjbGlkMiA9IHt9KSk7XHJcbk9iamVjdC5mcmVlemUoRXVjbGlkMik7XHJcbi8qKlxyXG4gKi9cclxuLy8gU2VwYXJhdGVkIGZvciB0cmVlLXNoYWtpbmcuXHJcbmV4cG9ydCBjbGFzcyBFdWNsaWQyVmlzaWJsZUdyaWQgZXh0ZW5kcyBFdWNsaWQyLkdyaWQge1xyXG4gICAgY29uc3RydWN0b3IoZGVzYykge1xyXG4gICAgICAgIHN1cGVyKGRlc2MpO1xyXG4gICAgICAgIGNvbnN0IGdyaWRFbGVtID0gSnNVdGlscy5ta0VsKFwiZGl2XCIsIFtdKTtcclxuICAgICAgICBncmlkRWxlbS5zdHlsZS5zZXRQcm9wZXJ0eShcIi0tZXVjbGlkMi1ncmlkLXdpZHRoXCIsIHRoaXMuZGltZW5zaW9ucy53aWR0aC50b1N0cmluZygpKTtcclxuICAgICAgICAvLyBBdCBiZWxvdyB1c2Ugb2YgZm9yIGxvb3Agd2l0aG91dCBicmVha3M6IEZvciBzaGFsbG93ZXIgc3RhY2sgd2hlbiBkZWJ1Z2dpbmcuXHJcbiAgICAgICAgZm9yIChjb25zdCByb3cgb2YgdGhpcy5ncmlkKSB7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgdGlsZSBvZiByb3cpIHtcclxuICAgICAgICAgICAgICAgIHRpbGUuX2FkZFRvRG9tKGdyaWRFbGVtKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9zdXBlclZpc2libGVHcmlkKGRlc2MsIGdyaWRFbGVtKTtcclxuICAgIH1cclxufVxyXG47XHJcbkpzVXRpbHMuYXBwbHlNaXhpbnMoRXVjbGlkMlZpc2libGVHcmlkLCBbVmlzaWJsZUdyaWRNaXhpbl0pO1xyXG5PYmplY3QuZnJlZXplKEV1Y2xpZDJWaXNpYmxlR3JpZCk7XHJcbk9iamVjdC5mcmVlemUoRXVjbGlkMlZpc2libGVHcmlkLnByb3RvdHlwZSk7XHJcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/base/floor/impl/Euclid2.ts\n");

/***/ }),

/***/ "./src/base/game/ctormaps/CmapBrowser.ts":
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var floor_VisibleGrid__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./src/base/floor/VisibleGrid.ts\");\n/* harmony import */ var floor_impl_Euclid2__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"./src/base/floor/impl/Euclid2.ts\");\n/* harmony import */ var floor_impl_Beehive__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"./src/base/floor/impl/Beehive.ts\");\n\r\n\r\n\r\n{\r\n    // Visible Grid Implementation Registry:\r\n    const VGr = floor_VisibleGrid__WEBPACK_IMPORTED_MODULE_0__.VisibleGrid;\r\n    VGr._Constructors\r\n        = Object.freeze({\r\n            [\"EUCLID2\"]: floor_impl_Euclid2__WEBPACK_IMPORTED_MODULE_1__.Euclid2VisibleGrid,\r\n            [\"BEEHIVE\"]: floor_impl_Beehive__WEBPACK_IMPORTED_MODULE_2__.BeehiveVisibleGrid,\r\n        });\r\n    Object.freeze(VGr);\r\n    // This is just an interface. There is no instance prototype to freeze.\r\n}\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvYmFzZS9nYW1lL2N0b3JtYXBzL0NtYXBCcm93c2VyLnRzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc25ha2V5My8uL3NyYy9iYXNlL2dhbWUvY3Rvcm1hcHMvQ21hcEJyb3dzZXIudHM/Y2I0ZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBWaXNpYmxlR3JpZCB9IGZyb20gXCJmbG9vci9WaXNpYmxlR3JpZFwiO1xyXG5pbXBvcnQgeyBFdWNsaWQyVmlzaWJsZUdyaWQgfSBmcm9tIFwiZmxvb3IvaW1wbC9FdWNsaWQyXCI7XHJcbmltcG9ydCB7IEJlZWhpdmVWaXNpYmxlR3JpZCB9IGZyb20gXCJmbG9vci9pbXBsL0JlZWhpdmVcIjtcclxue1xyXG4gICAgLy8gVmlzaWJsZSBHcmlkIEltcGxlbWVudGF0aW9uIFJlZ2lzdHJ5OlxyXG4gICAgY29uc3QgVkdyID0gVmlzaWJsZUdyaWQ7XHJcbiAgICBWR3IuX0NvbnN0cnVjdG9yc1xyXG4gICAgICAgID0gT2JqZWN0LmZyZWV6ZSh7XHJcbiAgICAgICAgICAgIFtcIkVVQ0xJRDJcIl06IEV1Y2xpZDJWaXNpYmxlR3JpZCxcclxuICAgICAgICAgICAgW1wiQkVFSElWRVwiXTogQmVlaGl2ZVZpc2libGVHcmlkLFxyXG4gICAgICAgIH0pO1xyXG4gICAgT2JqZWN0LmZyZWV6ZShWR3IpO1xyXG4gICAgLy8gVGhpcyBpcyBqdXN0IGFuIGludGVyZmFjZS4gVGhlcmUgaXMgbm8gaW5zdGFuY2UgcHJvdG90eXBlIHRvIGZyZWV6ZS5cclxufVxyXG4iXSwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/base/game/ctormaps/CmapBrowser.ts\n");

/***/ }),

/***/ "./src/base/game/events/EventRecordEntry.ts":
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"EventRecordEntry\": () => /* binding */ EventRecordEntry\n/* harmony export */ });\nvar EventRecordEntry;\r\n(function (EventRecordEntry) {\r\n    /**\r\n     * The Game Manager should assign this value to the `eventId` field\r\n     * of a request-type event to signal if a request has been rejected.\r\n     * It is convenient to use as a default value.\r\n     */\r\n    EventRecordEntry.EVENT_ID_REJECT = -1;\r\n})(EventRecordEntry || (EventRecordEntry = {}));\r\nObject.freeze(EventRecordEntry);\r\n;\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvYmFzZS9nYW1lL2V2ZW50cy9FdmVudFJlY29yZEVudHJ5LnRzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc25ha2V5My8uL3NyYy9iYXNlL2dhbWUvZXZlbnRzL0V2ZW50UmVjb3JkRW50cnkudHM/ZDAxMiJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgdmFyIEV2ZW50UmVjb3JkRW50cnk7XHJcbihmdW5jdGlvbiAoRXZlbnRSZWNvcmRFbnRyeSkge1xyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgR2FtZSBNYW5hZ2VyIHNob3VsZCBhc3NpZ24gdGhpcyB2YWx1ZSB0byB0aGUgYGV2ZW50SWRgIGZpZWxkXHJcbiAgICAgKiBvZiBhIHJlcXVlc3QtdHlwZSBldmVudCB0byBzaWduYWwgaWYgYSByZXF1ZXN0IGhhcyBiZWVuIHJlamVjdGVkLlxyXG4gICAgICogSXQgaXMgY29udmVuaWVudCB0byB1c2UgYXMgYSBkZWZhdWx0IHZhbHVlLlxyXG4gICAgICovXHJcbiAgICBFdmVudFJlY29yZEVudHJ5LkVWRU5UX0lEX1JFSkVDVCA9IC0xO1xyXG59KShFdmVudFJlY29yZEVudHJ5IHx8IChFdmVudFJlY29yZEVudHJ5ID0ge30pKTtcclxuT2JqZWN0LmZyZWV6ZShFdmVudFJlY29yZEVudHJ5KTtcclxuO1xyXG4iXSwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/base/game/events/EventRecordEntry.ts\n");

/***/ }),

/***/ "./src/base/game/events/PlayerActionEvent.ts":
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"PlayerActionEvent\": () => /* binding */ PlayerActionEvent\n/* harmony export */ });\n/* harmony import */ var _EventRecordEntry__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./src/base/game/events/EventRecordEntry.ts\");\n\r\nvar PlayerActionEvent;\r\n(function (PlayerActionEvent) {\r\n    /**\r\n     * This is the agreed upon value that both the server and client\r\n     * copies of a game should set as the initial value for request id\r\n     * counters. Remember that a request ID is a property of a player,\r\n     * whereas an event ID is a property tied to a game.\r\n     */\r\n    PlayerActionEvent.INITIAL_REQUEST_ID = -1;\r\n    PlayerActionEvent.EVENT_NAME = Object.freeze({\r\n        BUBBLE: \"player-bubble\",\r\n        MOVEMENT: \"player-movement\",\r\n    });\r\n    /**\r\n     *\r\n     */\r\n    class Bubble {\r\n        constructor(playerId, lastAcceptedRequestId) {\r\n            this.eventId = _EventRecordEntry__WEBPACK_IMPORTED_MODULE_0__.EventRecordEntry.EVENT_ID_REJECT;\r\n            this.affectedNeighbours = undefined;\r\n            this.playerId = playerId;\r\n            this.playerLastAcceptedRequestId = lastAcceptedRequestId;\r\n        }\r\n    }\r\n    PlayerActionEvent.Bubble = Bubble;\r\n    /**\r\n     * ## Player Movement Event\r\n     *\r\n     * This single method-less class carries the bare-minimum information\r\n     * needed to describe a client's request for movement to the server,\r\n     * and to broadcast an acceptance of the request describing all changes\r\n     * to the game state that must be made (or to otherwise direct-reply\r\n     * the requester in case of request-rejection).\r\n     *\r\n     * It must do so in a way that allows the server and clients to infer\r\n     * whether any message reordering occurred.\r\n     *\r\n     * ### The Problem in Summary\r\n     *\r\n     * - Client copies of the game should lag behind the master copy of\r\n     *   the game state as little as possible with as small of a choking\r\n     *   effect on a client's ability to send requests as possible. This\r\n     *   rules out doing periodic game-state-dump broadcasts (because of\r\n     *   the transmission delay), and \"big-locks\" requiring a client to\r\n     *   have a completely up-to-date copy of the game state to have its\r\n     *   requests processed.\r\n     * - Nothing should ever happen in the client copies of the game that\r\n     *   doesn't happen in the master copy at the server. Ie. Since game-\r\n     *   state-dumps are out of the question, any corruption / de-sync of\r\n     *   the client's copy of the game is considered fatal and completely\r\n     *   unrecoverable.\r\n     * - As a bonus, it would be nice to bake in a mechanism to prevent\r\n     *   malicious or unintended spam from a trigger-happy client without\r\n     *   excessively / unnecessarily throttling the request-making ability\r\n     *   or throughput of any clients.\r\n     */\r\n    class Movement extends Bubble {\r\n        constructor(playerId, lastAcceptedRequestId, destTile, moveType) {\r\n            super(playerId, lastAcceptedRequestId);\r\n            /**\r\n             * Any value assigned by the requester to this field should be\r\n             * ignored by the server. The server should respond with the new\r\n             * values taken on by the player for these fields.\r\n             */\r\n            this.newPlayerHealth = undefined;\r\n            /**\r\n             * Undefined is equivalent to an empty array.\r\n             */\r\n            this.tileHealthModDescs = undefined;\r\n            this.destModDesc = {\r\n                coord: destTile.coord,\r\n                lastKnownUpdateId: destTile.lastKnownUpdateId,\r\n                newCharSeqPair: undefined,\r\n                newFreeHealth: undefined,\r\n            };\r\n            this.moveType = moveType;\r\n        }\r\n    }\r\n    PlayerActionEvent.Movement = Movement;\r\n})(PlayerActionEvent || (PlayerActionEvent = {}));\r\nObject.freeze(PlayerActionEvent);\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvYmFzZS9nYW1lL2V2ZW50cy9QbGF5ZXJBY3Rpb25FdmVudC50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovL3NuYWtleTMvLi9zcmMvYmFzZS9nYW1lL2V2ZW50cy9QbGF5ZXJBY3Rpb25FdmVudC50cz9kODJmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEV2ZW50UmVjb3JkRW50cnkgfSBmcm9tIFwiLi9FdmVudFJlY29yZEVudHJ5XCI7XHJcbmV4cG9ydCB2YXIgUGxheWVyQWN0aW9uRXZlbnQ7XHJcbihmdW5jdGlvbiAoUGxheWVyQWN0aW9uRXZlbnQpIHtcclxuICAgIC8qKlxyXG4gICAgICogVGhpcyBpcyB0aGUgYWdyZWVkIHVwb24gdmFsdWUgdGhhdCBib3RoIHRoZSBzZXJ2ZXIgYW5kIGNsaWVudFxyXG4gICAgICogY29waWVzIG9mIGEgZ2FtZSBzaG91bGQgc2V0IGFzIHRoZSBpbml0aWFsIHZhbHVlIGZvciByZXF1ZXN0IGlkXHJcbiAgICAgKiBjb3VudGVycy4gUmVtZW1iZXIgdGhhdCBhIHJlcXVlc3QgSUQgaXMgYSBwcm9wZXJ0eSBvZiBhIHBsYXllcixcclxuICAgICAqIHdoZXJlYXMgYW4gZXZlbnQgSUQgaXMgYSBwcm9wZXJ0eSB0aWVkIHRvIGEgZ2FtZS5cclxuICAgICAqL1xyXG4gICAgUGxheWVyQWN0aW9uRXZlbnQuSU5JVElBTF9SRVFVRVNUX0lEID0gLTE7XHJcbiAgICBQbGF5ZXJBY3Rpb25FdmVudC5FVkVOVF9OQU1FID0gT2JqZWN0LmZyZWV6ZSh7XHJcbiAgICAgICAgQlVCQkxFOiBcInBsYXllci1idWJibGVcIixcclxuICAgICAgICBNT1ZFTUVOVDogXCJwbGF5ZXItbW92ZW1lbnRcIixcclxuICAgIH0pO1xyXG4gICAgLyoqXHJcbiAgICAgKlxyXG4gICAgICovXHJcbiAgICBjbGFzcyBCdWJibGUge1xyXG4gICAgICAgIGNvbnN0cnVjdG9yKHBsYXllcklkLCBsYXN0QWNjZXB0ZWRSZXF1ZXN0SWQpIHtcclxuICAgICAgICAgICAgdGhpcy5ldmVudElkID0gRXZlbnRSZWNvcmRFbnRyeS5FVkVOVF9JRF9SRUpFQ1Q7XHJcbiAgICAgICAgICAgIHRoaXMuYWZmZWN0ZWROZWlnaGJvdXJzID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICB0aGlzLnBsYXllcklkID0gcGxheWVySWQ7XHJcbiAgICAgICAgICAgIHRoaXMucGxheWVyTGFzdEFjY2VwdGVkUmVxdWVzdElkID0gbGFzdEFjY2VwdGVkUmVxdWVzdElkO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFBsYXllckFjdGlvbkV2ZW50LkJ1YmJsZSA9IEJ1YmJsZTtcclxuICAgIC8qKlxyXG4gICAgICogIyMgUGxheWVyIE1vdmVtZW50IEV2ZW50XHJcbiAgICAgKlxyXG4gICAgICogVGhpcyBzaW5nbGUgbWV0aG9kLWxlc3MgY2xhc3MgY2FycmllcyB0aGUgYmFyZS1taW5pbXVtIGluZm9ybWF0aW9uXHJcbiAgICAgKiBuZWVkZWQgdG8gZGVzY3JpYmUgYSBjbGllbnQncyByZXF1ZXN0IGZvciBtb3ZlbWVudCB0byB0aGUgc2VydmVyLFxyXG4gICAgICogYW5kIHRvIGJyb2FkY2FzdCBhbiBhY2NlcHRhbmNlIG9mIHRoZSByZXF1ZXN0IGRlc2NyaWJpbmcgYWxsIGNoYW5nZXNcclxuICAgICAqIHRvIHRoZSBnYW1lIHN0YXRlIHRoYXQgbXVzdCBiZSBtYWRlIChvciB0byBvdGhlcndpc2UgZGlyZWN0LXJlcGx5XHJcbiAgICAgKiB0aGUgcmVxdWVzdGVyIGluIGNhc2Ugb2YgcmVxdWVzdC1yZWplY3Rpb24pLlxyXG4gICAgICpcclxuICAgICAqIEl0IG11c3QgZG8gc28gaW4gYSB3YXkgdGhhdCBhbGxvd3MgdGhlIHNlcnZlciBhbmQgY2xpZW50cyB0byBpbmZlclxyXG4gICAgICogd2hldGhlciBhbnkgbWVzc2FnZSByZW9yZGVyaW5nIG9jY3VycmVkLlxyXG4gICAgICpcclxuICAgICAqICMjIyBUaGUgUHJvYmxlbSBpbiBTdW1tYXJ5XHJcbiAgICAgKlxyXG4gICAgICogLSBDbGllbnQgY29waWVzIG9mIHRoZSBnYW1lIHNob3VsZCBsYWcgYmVoaW5kIHRoZSBtYXN0ZXIgY29weSBvZlxyXG4gICAgICogICB0aGUgZ2FtZSBzdGF0ZSBhcyBsaXR0bGUgYXMgcG9zc2libGUgd2l0aCBhcyBzbWFsbCBvZiBhIGNob2tpbmdcclxuICAgICAqICAgZWZmZWN0IG9uIGEgY2xpZW50J3MgYWJpbGl0eSB0byBzZW5kIHJlcXVlc3RzIGFzIHBvc3NpYmxlLiBUaGlzXHJcbiAgICAgKiAgIHJ1bGVzIG91dCBkb2luZyBwZXJpb2RpYyBnYW1lLXN0YXRlLWR1bXAgYnJvYWRjYXN0cyAoYmVjYXVzZSBvZlxyXG4gICAgICogICB0aGUgdHJhbnNtaXNzaW9uIGRlbGF5KSwgYW5kIFwiYmlnLWxvY2tzXCIgcmVxdWlyaW5nIGEgY2xpZW50IHRvXHJcbiAgICAgKiAgIGhhdmUgYSBjb21wbGV0ZWx5IHVwLXRvLWRhdGUgY29weSBvZiB0aGUgZ2FtZSBzdGF0ZSB0byBoYXZlIGl0c1xyXG4gICAgICogICByZXF1ZXN0cyBwcm9jZXNzZWQuXHJcbiAgICAgKiAtIE5vdGhpbmcgc2hvdWxkIGV2ZXIgaGFwcGVuIGluIHRoZSBjbGllbnQgY29waWVzIG9mIHRoZSBnYW1lIHRoYXRcclxuICAgICAqICAgZG9lc24ndCBoYXBwZW4gaW4gdGhlIG1hc3RlciBjb3B5IGF0IHRoZSBzZXJ2ZXIuIEllLiBTaW5jZSBnYW1lLVxyXG4gICAgICogICBzdGF0ZS1kdW1wcyBhcmUgb3V0IG9mIHRoZSBxdWVzdGlvbiwgYW55IGNvcnJ1cHRpb24gLyBkZS1zeW5jIG9mXHJcbiAgICAgKiAgIHRoZSBjbGllbnQncyBjb3B5IG9mIHRoZSBnYW1lIGlzIGNvbnNpZGVyZWQgZmF0YWwgYW5kIGNvbXBsZXRlbHlcclxuICAgICAqICAgdW5yZWNvdmVyYWJsZS5cclxuICAgICAqIC0gQXMgYSBib251cywgaXQgd291bGQgYmUgbmljZSB0byBiYWtlIGluIGEgbWVjaGFuaXNtIHRvIHByZXZlbnRcclxuICAgICAqICAgbWFsaWNpb3VzIG9yIHVuaW50ZW5kZWQgc3BhbSBmcm9tIGEgdHJpZ2dlci1oYXBweSBjbGllbnQgd2l0aG91dFxyXG4gICAgICogICBleGNlc3NpdmVseSAvIHVubmVjZXNzYXJpbHkgdGhyb3R0bGluZyB0aGUgcmVxdWVzdC1tYWtpbmcgYWJpbGl0eVxyXG4gICAgICogICBvciB0aHJvdWdocHV0IG9mIGFueSBjbGllbnRzLlxyXG4gICAgICovXHJcbiAgICBjbGFzcyBNb3ZlbWVudCBleHRlbmRzIEJ1YmJsZSB7XHJcbiAgICAgICAgY29uc3RydWN0b3IocGxheWVySWQsIGxhc3RBY2NlcHRlZFJlcXVlc3RJZCwgZGVzdFRpbGUsIG1vdmVUeXBlKSB7XHJcbiAgICAgICAgICAgIHN1cGVyKHBsYXllcklkLCBsYXN0QWNjZXB0ZWRSZXF1ZXN0SWQpO1xyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICogQW55IHZhbHVlIGFzc2lnbmVkIGJ5IHRoZSByZXF1ZXN0ZXIgdG8gdGhpcyBmaWVsZCBzaG91bGQgYmVcclxuICAgICAgICAgICAgICogaWdub3JlZCBieSB0aGUgc2VydmVyLiBUaGUgc2VydmVyIHNob3VsZCByZXNwb25kIHdpdGggdGhlIG5ld1xyXG4gICAgICAgICAgICAgKiB2YWx1ZXMgdGFrZW4gb24gYnkgdGhlIHBsYXllciBmb3IgdGhlc2UgZmllbGRzLlxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgdGhpcy5uZXdQbGF5ZXJIZWFsdGggPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgKiBVbmRlZmluZWQgaXMgZXF1aXZhbGVudCB0byBhbiBlbXB0eSBhcnJheS5cclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIHRoaXMudGlsZUhlYWx0aE1vZERlc2NzID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICB0aGlzLmRlc3RNb2REZXNjID0ge1xyXG4gICAgICAgICAgICAgICAgY29vcmQ6IGRlc3RUaWxlLmNvb3JkLFxyXG4gICAgICAgICAgICAgICAgbGFzdEtub3duVXBkYXRlSWQ6IGRlc3RUaWxlLmxhc3RLbm93blVwZGF0ZUlkLFxyXG4gICAgICAgICAgICAgICAgbmV3Q2hhclNlcVBhaXI6IHVuZGVmaW5lZCxcclxuICAgICAgICAgICAgICAgIG5ld0ZyZWVIZWFsdGg6IHVuZGVmaW5lZCxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5tb3ZlVHlwZSA9IG1vdmVUeXBlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFBsYXllckFjdGlvbkV2ZW50Lk1vdmVtZW50ID0gTW92ZW1lbnQ7XHJcbn0pKFBsYXllckFjdGlvbkV2ZW50IHx8IChQbGF5ZXJBY3Rpb25FdmVudCA9IHt9KSk7XHJcbk9iamVjdC5mcmVlemUoUGxheWVyQWN0aW9uRXZlbnQpO1xyXG4iXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/base/game/events/PlayerActionEvent.ts\n");

/***/ }),

/***/ "./src/base/game/gameparts/GamepartBase.ts":
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"GamepartBase\": () => /* binding */ GamepartBase\n/* harmony export */ });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(\"./node_modules/tslib/tslib.es6.js\");\n/* harmony import */ var defs_JsUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./src/base/defs/JsUtils.ts\");\n/* harmony import */ var defs_TypeDefs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"./src/base/defs/TypeDefs.ts\");\n/* harmony import */ var _player_Player__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"./src/base/game/player/Player.ts\");\n/* harmony import */ var _player_Team__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(\"./src/base/game/player/Team.ts\");\nvar _onGameBecomeOver, _currentOperator, _status;\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Foundational parts of a Game that are not related to event handling.\r\n */\r\nclass GamepartBase {\r\n    /**\r\n     * Performs the \"no invincible player\" check (See {@link Player#teamSet}).\r\n     *\r\n     * @param gameType -\r\n     * @param impl -\r\n     * @param desc -\r\n     */\r\n    constructor(gameType, impl, desc) {\r\n        _onGameBecomeOver.set(this, void 0);\r\n        _currentOperator.set(this, void 0);\r\n        _status.set(this, void 0);\r\n        this.gameType = gameType;\r\n        const gridClass = this._getGridImplementation(desc.coordSys);\r\n        this.grid = new (gridClass)({\r\n            gridClass: gridClass,\r\n            tileClass: impl.tileClass,\r\n            coordSys: desc.coordSys,\r\n            dimensions: desc.gridDimensions,\r\n        });\r\n        (0,tslib__WEBPACK_IMPORTED_MODULE_4__.__classPrivateFieldSet)(this, _onGameBecomeOver, impl.onGameBecomeOver);\r\n        this.langFrontend = defs_TypeDefs__WEBPACK_IMPORTED_MODULE_1__.Lang.GET_FRONTEND_DESC_BY_ID(desc.langId);\r\n        // Construct players:\r\n        this._playerStatusCtor = impl.playerStatusCtor;\r\n        this.players = this.createPlayers(desc);\r\n        this.operators = Object.freeze(this.players.filter((player) => player.isALocalOperator));\r\n        this.setCurrentOperator(0);\r\n        {\r\n            const teams = [];\r\n            this.players.forEach((player) => {\r\n                if (!teams[player.teamId]) {\r\n                    teams[player.teamId] = [];\r\n                }\r\n                teams[player.teamId].push(player);\r\n            });\r\n            this.teams = teams.map((teammateArray, teamId) => {\r\n                return new _player_Team__WEBPACK_IMPORTED_MODULE_3__.Team(teamId, teammateArray);\r\n            });\r\n            if (this.teams.every((team) => team.id === _player_Team__WEBPACK_IMPORTED_MODULE_3__.Team.ElimOrder.IMMORTAL)) {\r\n                // TODO.design put a check inside the UI code to prevent this.\r\n                // The purpose of this restriction is to prevent DoS attacks on\r\n                // a hosting server by creating games that can never end and\r\n                // leaving them open forever, thus leaking the server's resources.\r\n                throw new Error(\"All teams are immortal. The game will never end.\");\r\n            }\r\n        }\r\n        defs_JsUtils__WEBPACK_IMPORTED_MODULE_0__.JsUtils.propNoWrite(this, [\r\n            \"gameType\", \"grid\", \"langFrontend\",\r\n            \"players\", \"operators\", \"teams\", \"_playerStatusCtor\",\r\n        ]);\r\n        this.players.forEach((player) => player._afterAllPlayersConstruction());\r\n    }\r\n    /**\r\n     * Reset the grid.\r\n     *\r\n     * Overrides should not use the return value. They should return\r\n     * the result of calling `ctorAsync`.\r\n     */\r\n    reset() {\r\n        this.grid.reset();\r\n        // We must reset status to PAUSED to pass a state-transition\r\n        // assertion when changing status later to PLAYING.\r\n        (0,tslib__WEBPACK_IMPORTED_MODULE_4__.__classPrivateFieldSet)(this, _status, \"PAUSED\" /* PAUSED */);\r\n        // Important: Since there is nothing to do in this game-part's\r\n        // ctorAsync getter, we don't need to use `await`.\r\n        return Promise.resolve();\r\n    }\r\n    /**\r\n     * Private helper for the constructor to create player objects.\r\n     * This is bypassed in non-game-manager implementations (Ie. In\r\n     * OnlineGame).\r\n     *\r\n     * @param gameDesc -\r\n     * @returns A bundle of the constructed players.\r\n     */\r\n    createPlayers(gameDesc) {\r\n        const playerDescs = gameDesc.playerDescs\r\n            = (this.gameType === \"ONLINE\" /* ONLINE */)\r\n                // The client receives these descriptors already finalized / cleaned by the server.\r\n                ? gameDesc.playerDescs\r\n                : _player_Player__WEBPACK_IMPORTED_MODULE_2__.Player.CtorArgs.finalize(gameDesc.playerDescs);\r\n        return Object.freeze(playerDescs.map((playerDesc) => {\r\n            if (playerDesc.familyId === _player_Player__WEBPACK_IMPORTED_MODULE_2__.Player.Family.HUMAN) {\r\n                return (playerDesc.isALocalOperator)\r\n                    ? this._createOperatorPlayer(playerDesc)\r\n                    : new _player_Player__WEBPACK_IMPORTED_MODULE_2__.Player(this, playerDesc);\r\n            }\r\n            else {\r\n                return this._createArtifPlayer(playerDesc);\r\n            }\r\n        }));\r\n    }\r\n    serializeResetState() {\r\n        const csps = [];\r\n        const playerCoords = this.players.map((player) => player.coord);\r\n        const healthCoords = [];\r\n        this.grid.forEachTile((tile) => {\r\n            tile.lastKnownUpdateId++;\r\n            csps.push({\r\n                char: tile.langChar,\r\n                seq: tile.langSeq,\r\n            });\r\n            if (tile.freeHealth) {\r\n                healthCoords.push({\r\n                    coord: tile.coord,\r\n                    health: tile.freeHealth,\r\n                });\r\n            }\r\n        });\r\n        return { csps, playerCoords, healthCoords };\r\n    }\r\n    deserializeResetState(ser) {\r\n        // Could also use `csps.unshift`, but that may be slower\r\n        // because it modifies csps, which we don't need to do.\r\n        this.grid.forEachTile((tile, index) => {\r\n            tile.setLangCharSeqPair(ser.csps[index]);\r\n            tile.lastKnownUpdateId++;\r\n        });\r\n        ser.playerCoords.forEach((coord, index) => {\r\n            this.players[index].reset(this.grid.tile.at(coord));\r\n        });\r\n        ser.healthCoords.forEach((desc) => {\r\n            this.grid.tile.at(desc.coord).freeHealth = desc.health;\r\n        });\r\n    }\r\n    get currentOperator() {\r\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_4__.__classPrivateFieldGet)(this, _currentOperator);\r\n    }\r\n    setCurrentOperator(nextOperatorIndex) {\r\n        const nextOperator = this.operators[nextOperatorIndex];\r\n        if (this.currentOperator !== nextOperator) {\r\n            nextOperator._notifyWillBecomeCurrent();\r\n            (0,tslib__WEBPACK_IMPORTED_MODULE_4__.__classPrivateFieldSet)(this, _currentOperator, nextOperator);\r\n            // IMPORTANT: The order of the above lines matters\r\n            // (hence the method name \"notifyWillBecomeCurrent\").\r\n        }\r\n    }\r\n    get status() {\r\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_4__.__classPrivateFieldGet)(this, _status);\r\n    }\r\n    /**\r\n     * On the client side, this should only be accessed through a\r\n     * wrapper function that also makes UI-related changes.\r\n     *\r\n     * If the game is already playing, this does nothing.\r\n     */\r\n    statusBecomePlaying() {\r\n        if (this.status === \"PLAYING\" /* PLAYING */) {\r\n            console.log(\"[statusBecomePlaying]: Game is already playing\");\r\n            return;\r\n        }\r\n        if (this.status !== \"PAUSED\" /* PAUSED */) {\r\n            throw new Error(\"Can only resume a game that is currently paused.\");\r\n        }\r\n        this.players.forEach((player) => {\r\n            player._notifyGameNowPlaying();\r\n        });\r\n        this._abstractStatusBecomePlaying();\r\n        (0,tslib__WEBPACK_IMPORTED_MODULE_4__.__classPrivateFieldSet)(this, _status, \"PLAYING\" /* PLAYING */);\r\n    }\r\n    /**\r\n     * On the client side, this should only be accessed through a\r\n     * wrapper function that also makes UI-related changes.\r\n     *\r\n     * If the game is already paused, this does nothing.\r\n     */\r\n    statusBecomePaused() {\r\n        if (this.status === \"PAUSED\" /* PAUSED */) {\r\n            console.log(\"[statusBecomePaused]: Game is already paused\");\r\n            return;\r\n        }\r\n        if (this.status === \"OVER\" /* OVER */) {\r\n            return;\r\n        }\r\n        this.players.forEach((player) => {\r\n            player._notifyGameNowPaused();\r\n        });\r\n        this._abstractStatusBecomePaused();\r\n        (0,tslib__WEBPACK_IMPORTED_MODULE_4__.__classPrivateFieldSet)(this, _status, \"PAUSED\" /* PAUSED */);\r\n    }\r\n    /**\r\n     * This should be called when all non-immortal teams have been\r\n     * eliminated. A team is immortal if all its members have the\r\n     * `noCheckGameOver` flag set to `true`. A mortal team becomes\r\n     * (and subsequently, unconditionally stays) eliminated when all\r\n     * their members are in a downed state at the same time.\r\n     *\r\n     * This should not be controllable by UI input elements.\r\n     */\r\n    statusBecomeOver() {\r\n        if (this.status !== \"PLAYING\" /* PLAYING */) {\r\n            throw new Error(\"Can only end a game that is currently playing.\");\r\n        }\r\n        this.players.forEach((player) => {\r\n            player._notifyGameNowOver();\r\n        });\r\n        this._abstractStatusBecomeOver();\r\n        (0,tslib__WEBPACK_IMPORTED_MODULE_4__.__classPrivateFieldSet)(this, _status, \"OVER\" /* OVER */);\r\n        (0,tslib__WEBPACK_IMPORTED_MODULE_4__.__classPrivateFieldGet)(this, _onGameBecomeOver).call(this);\r\n        console.log(\"game is over!\");\r\n    }\r\n    _abstractStatusBecomePlaying() { }\r\n    _abstractStatusBecomePaused() { }\r\n    _abstractStatusBecomeOver() { }\r\n}\r\n_onGameBecomeOver = new WeakMap(), _currentOperator = new WeakMap(), _status = new WeakMap();\r\ndefs_JsUtils__WEBPACK_IMPORTED_MODULE_0__.JsUtils.protoNoEnum(GamepartBase, [\r\n    \"_abstractStatusBecomePlaying\",\r\n    \"_abstractStatusBecomePaused\",\r\n    \"_abstractStatusBecomeOver\",\r\n]);\r\nObject.freeze(GamepartBase);\r\nObject.freeze(GamepartBase.prototype);\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvYmFzZS9nYW1lL2dhbWVwYXJ0cy9HYW1lcGFydEJhc2UudHMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zbmFrZXkzLy4vc3JjL2Jhc2UvZ2FtZS9nYW1lcGFydHMvR2FtZXBhcnRCYXNlLnRzPzQ4N2QiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIF9vbkdhbWVCZWNvbWVPdmVyLCBfY3VycmVudE9wZXJhdG9yLCBfc3RhdHVzO1xyXG5pbXBvcnQgeyBfX2NsYXNzUHJpdmF0ZUZpZWxkR2V0LCBfX2NsYXNzUHJpdmF0ZUZpZWxkU2V0IH0gZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCB7IEpzVXRpbHMgfSBmcm9tIFwiZGVmcy9Kc1V0aWxzXCI7XHJcbmltcG9ydCB7IExhbmcgfSBmcm9tIFwiZGVmcy9UeXBlRGVmc1wiO1xyXG5pbXBvcnQgeyBQbGF5ZXIgfSBmcm9tIFwiLi4vcGxheWVyL1BsYXllclwiO1xyXG5pbXBvcnQgeyBUZWFtIH0gZnJvbSBcIi4uL3BsYXllci9UZWFtXCI7XHJcbi8qKlxyXG4gKiBGb3VuZGF0aW9uYWwgcGFydHMgb2YgYSBHYW1lIHRoYXQgYXJlIG5vdCByZWxhdGVkIHRvIGV2ZW50IGhhbmRsaW5nLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIEdhbWVwYXJ0QmFzZSB7XHJcbiAgICAvKipcclxuICAgICAqIFBlcmZvcm1zIHRoZSBcIm5vIGludmluY2libGUgcGxheWVyXCIgY2hlY2sgKFNlZSB7QGxpbmsgUGxheWVyI3RlYW1TZXR9KS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gZ2FtZVR5cGUgLVxyXG4gICAgICogQHBhcmFtIGltcGwgLVxyXG4gICAgICogQHBhcmFtIGRlc2MgLVxyXG4gICAgICovXHJcbiAgICBjb25zdHJ1Y3RvcihnYW1lVHlwZSwgaW1wbCwgZGVzYykge1xyXG4gICAgICAgIF9vbkdhbWVCZWNvbWVPdmVyLnNldCh0aGlzLCB2b2lkIDApO1xyXG4gICAgICAgIF9jdXJyZW50T3BlcmF0b3Iuc2V0KHRoaXMsIHZvaWQgMCk7XHJcbiAgICAgICAgX3N0YXR1cy5zZXQodGhpcywgdm9pZCAwKTtcclxuICAgICAgICB0aGlzLmdhbWVUeXBlID0gZ2FtZVR5cGU7XHJcbiAgICAgICAgY29uc3QgZ3JpZENsYXNzID0gdGhpcy5fZ2V0R3JpZEltcGxlbWVudGF0aW9uKGRlc2MuY29vcmRTeXMpO1xyXG4gICAgICAgIHRoaXMuZ3JpZCA9IG5ldyAoZ3JpZENsYXNzKSh7XHJcbiAgICAgICAgICAgIGdyaWRDbGFzczogZ3JpZENsYXNzLFxyXG4gICAgICAgICAgICB0aWxlQ2xhc3M6IGltcGwudGlsZUNsYXNzLFxyXG4gICAgICAgICAgICBjb29yZFN5czogZGVzYy5jb29yZFN5cyxcclxuICAgICAgICAgICAgZGltZW5zaW9uczogZGVzYy5ncmlkRGltZW5zaW9ucyxcclxuICAgICAgICB9KTtcclxuICAgICAgICBfX2NsYXNzUHJpdmF0ZUZpZWxkU2V0KHRoaXMsIF9vbkdhbWVCZWNvbWVPdmVyLCBpbXBsLm9uR2FtZUJlY29tZU92ZXIpO1xyXG4gICAgICAgIHRoaXMubGFuZ0Zyb250ZW5kID0gTGFuZy5HRVRfRlJPTlRFTkRfREVTQ19CWV9JRChkZXNjLmxhbmdJZCk7XHJcbiAgICAgICAgLy8gQ29uc3RydWN0IHBsYXllcnM6XHJcbiAgICAgICAgdGhpcy5fcGxheWVyU3RhdHVzQ3RvciA9IGltcGwucGxheWVyU3RhdHVzQ3RvcjtcclxuICAgICAgICB0aGlzLnBsYXllcnMgPSB0aGlzLmNyZWF0ZVBsYXllcnMoZGVzYyk7XHJcbiAgICAgICAgdGhpcy5vcGVyYXRvcnMgPSBPYmplY3QuZnJlZXplKHRoaXMucGxheWVycy5maWx0ZXIoKHBsYXllcikgPT4gcGxheWVyLmlzQUxvY2FsT3BlcmF0b3IpKTtcclxuICAgICAgICB0aGlzLnNldEN1cnJlbnRPcGVyYXRvcigwKTtcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRlYW1zID0gW107XHJcbiAgICAgICAgICAgIHRoaXMucGxheWVycy5mb3JFYWNoKChwbGF5ZXIpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICghdGVhbXNbcGxheWVyLnRlYW1JZF0pIHtcclxuICAgICAgICAgICAgICAgICAgICB0ZWFtc1twbGF5ZXIudGVhbUlkXSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGVhbXNbcGxheWVyLnRlYW1JZF0ucHVzaChwbGF5ZXIpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy50ZWFtcyA9IHRlYW1zLm1hcCgodGVhbW1hdGVBcnJheSwgdGVhbUlkKSA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFRlYW0odGVhbUlkLCB0ZWFtbWF0ZUFycmF5KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnRlYW1zLmV2ZXJ5KCh0ZWFtKSA9PiB0ZWFtLmlkID09PSBUZWFtLkVsaW1PcmRlci5JTU1PUlRBTCkpIHtcclxuICAgICAgICAgICAgICAgIC8vIFRPRE8uZGVzaWduIHB1dCBhIGNoZWNrIGluc2lkZSB0aGUgVUkgY29kZSB0byBwcmV2ZW50IHRoaXMuXHJcbiAgICAgICAgICAgICAgICAvLyBUaGUgcHVycG9zZSBvZiB0aGlzIHJlc3RyaWN0aW9uIGlzIHRvIHByZXZlbnQgRG9TIGF0dGFja3Mgb25cclxuICAgICAgICAgICAgICAgIC8vIGEgaG9zdGluZyBzZXJ2ZXIgYnkgY3JlYXRpbmcgZ2FtZXMgdGhhdCBjYW4gbmV2ZXIgZW5kIGFuZFxyXG4gICAgICAgICAgICAgICAgLy8gbGVhdmluZyB0aGVtIG9wZW4gZm9yZXZlciwgdGh1cyBsZWFraW5nIHRoZSBzZXJ2ZXIncyByZXNvdXJjZXMuXHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBbGwgdGVhbXMgYXJlIGltbW9ydGFsLiBUaGUgZ2FtZSB3aWxsIG5ldmVyIGVuZC5cIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgSnNVdGlscy5wcm9wTm9Xcml0ZSh0aGlzLCBbXHJcbiAgICAgICAgICAgIFwiZ2FtZVR5cGVcIiwgXCJncmlkXCIsIFwibGFuZ0Zyb250ZW5kXCIsXHJcbiAgICAgICAgICAgIFwicGxheWVyc1wiLCBcIm9wZXJhdG9yc1wiLCBcInRlYW1zXCIsIFwiX3BsYXllclN0YXR1c0N0b3JcIixcclxuICAgICAgICBdKTtcclxuICAgICAgICB0aGlzLnBsYXllcnMuZm9yRWFjaCgocGxheWVyKSA9PiBwbGF5ZXIuX2FmdGVyQWxsUGxheWVyc0NvbnN0cnVjdGlvbigpKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogUmVzZXQgdGhlIGdyaWQuXHJcbiAgICAgKlxyXG4gICAgICogT3ZlcnJpZGVzIHNob3VsZCBub3QgdXNlIHRoZSByZXR1cm4gdmFsdWUuIFRoZXkgc2hvdWxkIHJldHVyblxyXG4gICAgICogdGhlIHJlc3VsdCBvZiBjYWxsaW5nIGBjdG9yQXN5bmNgLlxyXG4gICAgICovXHJcbiAgICByZXNldCgpIHtcclxuICAgICAgICB0aGlzLmdyaWQucmVzZXQoKTtcclxuICAgICAgICAvLyBXZSBtdXN0IHJlc2V0IHN0YXR1cyB0byBQQVVTRUQgdG8gcGFzcyBhIHN0YXRlLXRyYW5zaXRpb25cclxuICAgICAgICAvLyBhc3NlcnRpb24gd2hlbiBjaGFuZ2luZyBzdGF0dXMgbGF0ZXIgdG8gUExBWUlORy5cclxuICAgICAgICBfX2NsYXNzUHJpdmF0ZUZpZWxkU2V0KHRoaXMsIF9zdGF0dXMsIFwiUEFVU0VEXCIgLyogUEFVU0VEICovKTtcclxuICAgICAgICAvLyBJbXBvcnRhbnQ6IFNpbmNlIHRoZXJlIGlzIG5vdGhpbmcgdG8gZG8gaW4gdGhpcyBnYW1lLXBhcnQnc1xyXG4gICAgICAgIC8vIGN0b3JBc3luYyBnZXR0ZXIsIHdlIGRvbid0IG5lZWQgdG8gdXNlIGBhd2FpdGAuXHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBQcml2YXRlIGhlbHBlciBmb3IgdGhlIGNvbnN0cnVjdG9yIHRvIGNyZWF0ZSBwbGF5ZXIgb2JqZWN0cy5cclxuICAgICAqIFRoaXMgaXMgYnlwYXNzZWQgaW4gbm9uLWdhbWUtbWFuYWdlciBpbXBsZW1lbnRhdGlvbnMgKEllLiBJblxyXG4gICAgICogT25saW5lR2FtZSkuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGdhbWVEZXNjIC1cclxuICAgICAqIEByZXR1cm5zIEEgYnVuZGxlIG9mIHRoZSBjb25zdHJ1Y3RlZCBwbGF5ZXJzLlxyXG4gICAgICovXHJcbiAgICBjcmVhdGVQbGF5ZXJzKGdhbWVEZXNjKSB7XHJcbiAgICAgICAgY29uc3QgcGxheWVyRGVzY3MgPSBnYW1lRGVzYy5wbGF5ZXJEZXNjc1xyXG4gICAgICAgICAgICA9ICh0aGlzLmdhbWVUeXBlID09PSBcIk9OTElORVwiIC8qIE9OTElORSAqLylcclxuICAgICAgICAgICAgICAgIC8vIFRoZSBjbGllbnQgcmVjZWl2ZXMgdGhlc2UgZGVzY3JpcHRvcnMgYWxyZWFkeSBmaW5hbGl6ZWQgLyBjbGVhbmVkIGJ5IHRoZSBzZXJ2ZXIuXHJcbiAgICAgICAgICAgICAgICA/IGdhbWVEZXNjLnBsYXllckRlc2NzXHJcbiAgICAgICAgICAgICAgICA6IFBsYXllci5DdG9yQXJncy5maW5hbGl6ZShnYW1lRGVzYy5wbGF5ZXJEZXNjcyk7XHJcbiAgICAgICAgcmV0dXJuIE9iamVjdC5mcmVlemUocGxheWVyRGVzY3MubWFwKChwbGF5ZXJEZXNjKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChwbGF5ZXJEZXNjLmZhbWlseUlkID09PSBQbGF5ZXIuRmFtaWx5LkhVTUFOKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gKHBsYXllckRlc2MuaXNBTG9jYWxPcGVyYXRvcilcclxuICAgICAgICAgICAgICAgICAgICA/IHRoaXMuX2NyZWF0ZU9wZXJhdG9yUGxheWVyKHBsYXllckRlc2MpXHJcbiAgICAgICAgICAgICAgICAgICAgOiBuZXcgUGxheWVyKHRoaXMsIHBsYXllckRlc2MpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NyZWF0ZUFydGlmUGxheWVyKHBsYXllckRlc2MpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSkpO1xyXG4gICAgfVxyXG4gICAgc2VyaWFsaXplUmVzZXRTdGF0ZSgpIHtcclxuICAgICAgICBjb25zdCBjc3BzID0gW107XHJcbiAgICAgICAgY29uc3QgcGxheWVyQ29vcmRzID0gdGhpcy5wbGF5ZXJzLm1hcCgocGxheWVyKSA9PiBwbGF5ZXIuY29vcmQpO1xyXG4gICAgICAgIGNvbnN0IGhlYWx0aENvb3JkcyA9IFtdO1xyXG4gICAgICAgIHRoaXMuZ3JpZC5mb3JFYWNoVGlsZSgodGlsZSkgPT4ge1xyXG4gICAgICAgICAgICB0aWxlLmxhc3RLbm93blVwZGF0ZUlkKys7XHJcbiAgICAgICAgICAgIGNzcHMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICBjaGFyOiB0aWxlLmxhbmdDaGFyLFxyXG4gICAgICAgICAgICAgICAgc2VxOiB0aWxlLmxhbmdTZXEsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBpZiAodGlsZS5mcmVlSGVhbHRoKSB7XHJcbiAgICAgICAgICAgICAgICBoZWFsdGhDb29yZHMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgY29vcmQ6IHRpbGUuY29vcmQsXHJcbiAgICAgICAgICAgICAgICAgICAgaGVhbHRoOiB0aWxlLmZyZWVIZWFsdGgsXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB7IGNzcHMsIHBsYXllckNvb3JkcywgaGVhbHRoQ29vcmRzIH07XHJcbiAgICB9XHJcbiAgICBkZXNlcmlhbGl6ZVJlc2V0U3RhdGUoc2VyKSB7XHJcbiAgICAgICAgLy8gQ291bGQgYWxzbyB1c2UgYGNzcHMudW5zaGlmdGAsIGJ1dCB0aGF0IG1heSBiZSBzbG93ZXJcclxuICAgICAgICAvLyBiZWNhdXNlIGl0IG1vZGlmaWVzIGNzcHMsIHdoaWNoIHdlIGRvbid0IG5lZWQgdG8gZG8uXHJcbiAgICAgICAgdGhpcy5ncmlkLmZvckVhY2hUaWxlKCh0aWxlLCBpbmRleCkgPT4ge1xyXG4gICAgICAgICAgICB0aWxlLnNldExhbmdDaGFyU2VxUGFpcihzZXIuY3Nwc1tpbmRleF0pO1xyXG4gICAgICAgICAgICB0aWxlLmxhc3RLbm93blVwZGF0ZUlkKys7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgc2VyLnBsYXllckNvb3Jkcy5mb3JFYWNoKChjb29yZCwgaW5kZXgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5wbGF5ZXJzW2luZGV4XS5yZXNldCh0aGlzLmdyaWQudGlsZS5hdChjb29yZCkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHNlci5oZWFsdGhDb29yZHMuZm9yRWFjaCgoZGVzYykgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmdyaWQudGlsZS5hdChkZXNjLmNvb3JkKS5mcmVlSGVhbHRoID0gZGVzYy5oZWFsdGg7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBnZXQgY3VycmVudE9wZXJhdG9yKCkge1xyXG4gICAgICAgIHJldHVybiBfX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHRoaXMsIF9jdXJyZW50T3BlcmF0b3IpO1xyXG4gICAgfVxyXG4gICAgc2V0Q3VycmVudE9wZXJhdG9yKG5leHRPcGVyYXRvckluZGV4KSB7XHJcbiAgICAgICAgY29uc3QgbmV4dE9wZXJhdG9yID0gdGhpcy5vcGVyYXRvcnNbbmV4dE9wZXJhdG9ySW5kZXhdO1xyXG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRPcGVyYXRvciAhPT0gbmV4dE9wZXJhdG9yKSB7XHJcbiAgICAgICAgICAgIG5leHRPcGVyYXRvci5fbm90aWZ5V2lsbEJlY29tZUN1cnJlbnQoKTtcclxuICAgICAgICAgICAgX19jbGFzc1ByaXZhdGVGaWVsZFNldCh0aGlzLCBfY3VycmVudE9wZXJhdG9yLCBuZXh0T3BlcmF0b3IpO1xyXG4gICAgICAgICAgICAvLyBJTVBPUlRBTlQ6IFRoZSBvcmRlciBvZiB0aGUgYWJvdmUgbGluZXMgbWF0dGVyc1xyXG4gICAgICAgICAgICAvLyAoaGVuY2UgdGhlIG1ldGhvZCBuYW1lIFwibm90aWZ5V2lsbEJlY29tZUN1cnJlbnRcIikuXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZ2V0IHN0YXR1cygpIHtcclxuICAgICAgICByZXR1cm4gX19jbGFzc1ByaXZhdGVGaWVsZEdldCh0aGlzLCBfc3RhdHVzKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogT24gdGhlIGNsaWVudCBzaWRlLCB0aGlzIHNob3VsZCBvbmx5IGJlIGFjY2Vzc2VkIHRocm91Z2ggYVxyXG4gICAgICogd3JhcHBlciBmdW5jdGlvbiB0aGF0IGFsc28gbWFrZXMgVUktcmVsYXRlZCBjaGFuZ2VzLlxyXG4gICAgICpcclxuICAgICAqIElmIHRoZSBnYW1lIGlzIGFscmVhZHkgcGxheWluZywgdGhpcyBkb2VzIG5vdGhpbmcuXHJcbiAgICAgKi9cclxuICAgIHN0YXR1c0JlY29tZVBsYXlpbmcoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuc3RhdHVzID09PSBcIlBMQVlJTkdcIiAvKiBQTEFZSU5HICovKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiW3N0YXR1c0JlY29tZVBsYXlpbmddOiBHYW1lIGlzIGFscmVhZHkgcGxheWluZ1wiKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5zdGF0dXMgIT09IFwiUEFVU0VEXCIgLyogUEFVU0VEICovKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNhbiBvbmx5IHJlc3VtZSBhIGdhbWUgdGhhdCBpcyBjdXJyZW50bHkgcGF1c2VkLlwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5wbGF5ZXJzLmZvckVhY2goKHBsYXllcikgPT4ge1xyXG4gICAgICAgICAgICBwbGF5ZXIuX25vdGlmeUdhbWVOb3dQbGF5aW5nKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5fYWJzdHJhY3RTdGF0dXNCZWNvbWVQbGF5aW5nKCk7XHJcbiAgICAgICAgX19jbGFzc1ByaXZhdGVGaWVsZFNldCh0aGlzLCBfc3RhdHVzLCBcIlBMQVlJTkdcIiAvKiBQTEFZSU5HICovKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogT24gdGhlIGNsaWVudCBzaWRlLCB0aGlzIHNob3VsZCBvbmx5IGJlIGFjY2Vzc2VkIHRocm91Z2ggYVxyXG4gICAgICogd3JhcHBlciBmdW5jdGlvbiB0aGF0IGFsc28gbWFrZXMgVUktcmVsYXRlZCBjaGFuZ2VzLlxyXG4gICAgICpcclxuICAgICAqIElmIHRoZSBnYW1lIGlzIGFscmVhZHkgcGF1c2VkLCB0aGlzIGRvZXMgbm90aGluZy5cclxuICAgICAqL1xyXG4gICAgc3RhdHVzQmVjb21lUGF1c2VkKCkge1xyXG4gICAgICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gXCJQQVVTRURcIiAvKiBQQVVTRUQgKi8pIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJbc3RhdHVzQmVjb21lUGF1c2VkXTogR2FtZSBpcyBhbHJlYWR5IHBhdXNlZFwiKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5zdGF0dXMgPT09IFwiT1ZFUlwiIC8qIE9WRVIgKi8pIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnBsYXllcnMuZm9yRWFjaCgocGxheWVyKSA9PiB7XHJcbiAgICAgICAgICAgIHBsYXllci5fbm90aWZ5R2FtZU5vd1BhdXNlZCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuX2Fic3RyYWN0U3RhdHVzQmVjb21lUGF1c2VkKCk7XHJcbiAgICAgICAgX19jbGFzc1ByaXZhdGVGaWVsZFNldCh0aGlzLCBfc3RhdHVzLCBcIlBBVVNFRFwiIC8qIFBBVVNFRCAqLyk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFRoaXMgc2hvdWxkIGJlIGNhbGxlZCB3aGVuIGFsbCBub24taW1tb3J0YWwgdGVhbXMgaGF2ZSBiZWVuXHJcbiAgICAgKiBlbGltaW5hdGVkLiBBIHRlYW0gaXMgaW1tb3J0YWwgaWYgYWxsIGl0cyBtZW1iZXJzIGhhdmUgdGhlXHJcbiAgICAgKiBgbm9DaGVja0dhbWVPdmVyYCBmbGFnIHNldCB0byBgdHJ1ZWAuIEEgbW9ydGFsIHRlYW0gYmVjb21lc1xyXG4gICAgICogKGFuZCBzdWJzZXF1ZW50bHksIHVuY29uZGl0aW9uYWxseSBzdGF5cykgZWxpbWluYXRlZCB3aGVuIGFsbFxyXG4gICAgICogdGhlaXIgbWVtYmVycyBhcmUgaW4gYSBkb3duZWQgc3RhdGUgYXQgdGhlIHNhbWUgdGltZS5cclxuICAgICAqXHJcbiAgICAgKiBUaGlzIHNob3VsZCBub3QgYmUgY29udHJvbGxhYmxlIGJ5IFVJIGlucHV0IGVsZW1lbnRzLlxyXG4gICAgICovXHJcbiAgICBzdGF0dXNCZWNvbWVPdmVyKCkge1xyXG4gICAgICAgIGlmICh0aGlzLnN0YXR1cyAhPT0gXCJQTEFZSU5HXCIgLyogUExBWUlORyAqLykge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYW4gb25seSBlbmQgYSBnYW1lIHRoYXQgaXMgY3VycmVudGx5IHBsYXlpbmcuXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnBsYXllcnMuZm9yRWFjaCgocGxheWVyKSA9PiB7XHJcbiAgICAgICAgICAgIHBsYXllci5fbm90aWZ5R2FtZU5vd092ZXIoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLl9hYnN0cmFjdFN0YXR1c0JlY29tZU92ZXIoKTtcclxuICAgICAgICBfX2NsYXNzUHJpdmF0ZUZpZWxkU2V0KHRoaXMsIF9zdGF0dXMsIFwiT1ZFUlwiIC8qIE9WRVIgKi8pO1xyXG4gICAgICAgIF9fY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX29uR2FtZUJlY29tZU92ZXIpLmNhbGwodGhpcyk7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJnYW1lIGlzIG92ZXIhXCIpO1xyXG4gICAgfVxyXG4gICAgX2Fic3RyYWN0U3RhdHVzQmVjb21lUGxheWluZygpIHsgfVxyXG4gICAgX2Fic3RyYWN0U3RhdHVzQmVjb21lUGF1c2VkKCkgeyB9XHJcbiAgICBfYWJzdHJhY3RTdGF0dXNCZWNvbWVPdmVyKCkgeyB9XHJcbn1cclxuX29uR2FtZUJlY29tZU92ZXIgPSBuZXcgV2Vha01hcCgpLCBfY3VycmVudE9wZXJhdG9yID0gbmV3IFdlYWtNYXAoKSwgX3N0YXR1cyA9IG5ldyBXZWFrTWFwKCk7XHJcbkpzVXRpbHMucHJvdG9Ob0VudW0oR2FtZXBhcnRCYXNlLCBbXHJcbiAgICBcIl9hYnN0cmFjdFN0YXR1c0JlY29tZVBsYXlpbmdcIixcclxuICAgIFwiX2Fic3RyYWN0U3RhdHVzQmVjb21lUGF1c2VkXCIsXHJcbiAgICBcIl9hYnN0cmFjdFN0YXR1c0JlY29tZU92ZXJcIixcclxuXSk7XHJcbk9iamVjdC5mcmVlemUoR2FtZXBhcnRCYXNlKTtcclxuT2JqZWN0LmZyZWV6ZShHYW1lcGFydEJhc2UucHJvdG90eXBlKTtcclxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/base/game/gameparts/GamepartBase.ts\n");

/***/ }),

/***/ "./src/base/game/gameparts/GamepartEvents.ts":
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"PlayerActionEvent\": () => /* reexport safe */ _events_PlayerActionEvent__WEBPACK_IMPORTED_MODULE_2__.PlayerActionEvent,\n/* harmony export */   \"GamepartEvents\": () => /* binding */ GamepartEvents\n/* harmony export */ });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(\"./node_modules/tslib/tslib.es6.js\");\n/* harmony import */ var _Game__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./src/base/game/Game.ts\");\n/* harmony import */ var _events_EventRecordEntry__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"./src/base/game/events/EventRecordEntry.ts\");\n/* harmony import */ var _events_PlayerActionEvent__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"./src/base/game/events/PlayerActionEvent.ts\");\n/* harmony import */ var _GamepartBase__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(\"./src/base/game/gameparts/GamepartBase.ts\");\nvar _nextUnusedEventId;\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * All events have two corresponding handler functions taking a\r\n * request descriptor object (\"desc\"):\r\n *\r\n * ### Request Processor\r\n *\r\n * The request processor is only used by the Game Manager. It decides\r\n * whether to accept or reject the request based on `desc` and may\r\n * throw exceptions on impossible arguments. It should not make any\r\n * changes to the game state. Instead, it is responsible to augment\r\n * `desc` with information describing what changes to the game state\r\n * must be made.\r\n *\r\n * ### Request Executor\r\n *\r\n * This takes the `desc` augmented by the request processor and enacts\r\n * all the described changes upon the game's state. If the Game Manager\r\n * is not local to the client (a server process), then this handler is\r\n * called at both the server and client.\r\n *\r\n * Updates the event record if the response is accepted.\r\n */\r\nclass GamepartEvents extends _GamepartBase__WEBPACK_IMPORTED_MODULE_3__.GamepartBase {\r\n    constructor(gameType, impl, gameDesc) {\r\n        super(gameType, impl, gameDesc);\r\n        _nextUnusedEventId.set(this, void 0);\r\n        this.eventRecordBitmap = [];\r\n    }\r\n    reset() {\r\n        const superPromise = super.reset();\r\n        // Clear the event record:\r\n        this.eventRecordBitmap.fill(false, 0, _Game__WEBPACK_IMPORTED_MODULE_0__.Game.K.EVENT_RECORD_WRAPPING_BUFFER_LENGTH);\r\n        (0,tslib__WEBPACK_IMPORTED_MODULE_4__.__classPrivateFieldSet)(this, _nextUnusedEventId, 0);\r\n        // Since we didn't wait for the superPromise, return it.\r\n        return superPromise;\r\n    }\r\n    get nextUnusedEventId() {\r\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_4__.__classPrivateFieldGet)(this, _nextUnusedEventId);\r\n    }\r\n    /**\r\n     * Basically does `this.eventRecord[id] = desc;` with value checking.\r\n     *\r\n     * @param desc -\r\n     *\r\n     * @throws\r\n     * In the given order of priority:\r\n     * - TypeError if the event ID indicates a rejected request\r\n     * - RangeError if it is not a positive integer\r\n     * - Error if another event was already recorded with the same ID.\r\n     */\r\n    _recordEvent(desc) {\r\n        const id = desc.eventId;\r\n        const wrappedId = id % _Game__WEBPACK_IMPORTED_MODULE_0__.Game.K.EVENT_RECORD_WRAPPING_BUFFER_LENGTH;\r\n        if (id === _events_EventRecordEntry__WEBPACK_IMPORTED_MODULE_1__.EventRecordEntry.EVENT_ID_REJECT) {\r\n            throw new TypeError(\"Do not try to record events for rejected requests.\");\r\n        }\r\n        else if (id < 0 || id !== Math.trunc(id)) {\r\n            throw new RangeError(\"Event ID's must only be assigned positive, integer values.\");\r\n        }\r\n        else if (this.eventRecordBitmap[wrappedId]) {\r\n            throw new Error(\"Event ID's must be assigned unique values.\");\r\n        }\r\n        // TODO.impl Check for an OnlineGame that it is not far behind the Server.\r\n        // also design what should be done to handle that... Do we really need to\r\n        // recover from that?\r\n        this.eventRecordBitmap[wrappedId] = true;\r\n        this.eventRecordBitmap[(id\r\n            + _Game__WEBPACK_IMPORTED_MODULE_0__.Game.K.EVENT_RECORD_WRAPPING_BUFFER_LENGTH\r\n            - _Game__WEBPACK_IMPORTED_MODULE_0__.Game.K.EVENT_RECORD_FORWARD_WINDOW_LENGTH)\r\n            % _Game__WEBPACK_IMPORTED_MODULE_0__.Game.K.EVENT_RECORD_WRAPPING_BUFFER_LENGTH] = false;\r\n        (0,tslib__WEBPACK_IMPORTED_MODULE_4__.__classPrivateFieldSet)(this, _nextUnusedEventId, +(0,tslib__WEBPACK_IMPORTED_MODULE_4__.__classPrivateFieldGet)(this, _nextUnusedEventId) + 1);\r\n    }\r\n    executeTileModEvent(desc, doCheckOperatorSeqBuffer = true) {\r\n        Object.freeze(desc);\r\n        const dest = this.grid.tile.at(desc.coord);\r\n        if (dest.lastKnownUpdateId > desc.lastKnownUpdateId)\r\n            return dest;\r\n        if (dest.lastKnownUpdateId === desc.lastKnownUpdateId)\r\n            throw new RangeError(\"never\");\r\n        if (desc.newCharSeqPair) {\r\n            dest.setLangCharSeqPair(desc.newCharSeqPair);\r\n            // Refresh the operator's `seqBuffer` (maintain invariant) for new CSP:\r\n            if (doCheckOperatorSeqBuffer) {\r\n                // ^Do this when non-operator moves into the the operator's vicinity.\r\n                this.operators.filter((op) => {\r\n                    return op.tile.destsFrom().get.includes(dest);\r\n                }).forEach((op) => op.seqBufferAcceptKey(\"\"));\r\n            }\r\n        }\r\n        dest.lastKnownUpdateId = desc.lastKnownUpdateId;\r\n        dest.freeHealth = desc.newFreeHealth;\r\n        return dest;\r\n    }\r\n    /**\r\n     * Automatically lowers the {@link Player#requestInFlight} field\r\n     * for the requesting `Player` if the arriving event description\r\n     * is the newest one for the specified `Player`.\r\n     *\r\n     * Updates that are received after others that are more recent and\r\n     * concern the same {@link Tile} are ignored. This is okay since\r\n     * the only thing that matters about a {@link Tile} to the outside\r\n     * world is its last known state.\r\n     *\r\n     * @param desc\r\n     * A descriptor for all changes mandated by the player-movement event.\r\n     */\r\n    executePlayerMoveEvent(desc) {\r\n        var _a;\r\n        // console.log(desc);\r\n        const player = this.players[desc.playerId];\r\n        const clientEventLag = desc.playerLastAcceptedRequestId - player.lastAcceptedRequestId;\r\n        if (desc.eventId === _events_EventRecordEntry__WEBPACK_IMPORTED_MODULE_1__.EventRecordEntry.EVENT_ID_REJECT) {\r\n            // Rejected request. Implies either that: clientEventLag === 0,\r\n            // or that (at Game Manager): dest.numTimesOccupied > desc.destNumTimesOccupied\r\n            if (clientEventLag === 0) {\r\n                player.requestInFlight = false;\r\n            }\r\n            return; // Short-circuit!\r\n        }\r\n        this._recordEvent(desc);\r\n        const dest = this.executeTileModEvent(desc.destModDesc, player !== this.currentOperator);\r\n        (_a = desc.tileHealthModDescs) === null || _a === void 0 ? void 0 : _a.forEach((desc) => {\r\n            this.executeTileModEvent(desc);\r\n        });\r\n        if (clientEventLag > 1) {\r\n            // ===== Out of order receipt (clientside) =====\r\n            // Already received more recent request responses.\r\n            if (player === this.currentOperator) {\r\n                // Operator never receives their own updates out of\r\n                // order because they only have one unacknowledged\r\n                // in-flight request at a time.\r\n                throw new Error(\"never\");\r\n            }\r\n            return; // Short-circuit!\r\n        }\r\n        // Okay- the response is an acceptance of the specified player's most\r\n        // recent request pending this acknowledgement.\r\n        player.requestInFlight = false;\r\n        if ((player === this.currentOperator)\r\n            ? (clientEventLag === 1)\r\n            : (clientEventLag <= 1)) {\r\n            player.status.health = desc.newPlayerHealth.health;\r\n            player.moveTo(dest);\r\n            // Below is computationally the same as \"(player.lastAcceptedRequestId)++\"\r\n            player.lastAcceptedRequestId = desc.playerLastAcceptedRequestId;\r\n        }\r\n        else {\r\n            // Apparent negative lag. The operator may somehow have\r\n            // tampered with their player's request counter.\r\n            throw new RangeError(\"never\");\r\n        }\r\n    }\r\n    /**\r\n     *\r\n     * Automatically lowers the {@link Player#requestInFlight} field\r\n     * for the requesting `Player`.\r\n     *\r\n     * @param desc -\r\n     */\r\n    executePlayerBubbleEvent(desc) {\r\n        const bubbler = this.players[desc.playerId];\r\n        bubbler.requestInFlight = false;\r\n        if (desc.eventId !== _events_EventRecordEntry__WEBPACK_IMPORTED_MODULE_1__.EventRecordEntry.EVENT_ID_REJECT) {\r\n            this._recordEvent(desc); // Record the event.\r\n        }\r\n    }\r\n}\r\n_nextUnusedEventId = new WeakMap();\r\nObject.freeze(GamepartEvents);\r\nObject.freeze(GamepartEvents.prototype);\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvYmFzZS9nYW1lL2dhbWVwYXJ0cy9HYW1lcGFydEV2ZW50cy50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovL3NuYWtleTMvLi9zcmMvYmFzZS9nYW1lL2dhbWVwYXJ0cy9HYW1lcGFydEV2ZW50cy50cz9mYTU5Il0sInNvdXJjZXNDb250ZW50IjpbInZhciBfbmV4dFVudXNlZEV2ZW50SWQ7XHJcbmltcG9ydCB7IF9fY2xhc3NQcml2YXRlRmllbGRHZXQsIF9fY2xhc3NQcml2YXRlRmllbGRTZXQgfSBmcm9tIFwidHNsaWJcIjtcclxuaW1wb3J0IHsgR2FtZSB9IGZyb20gXCIuLi9HYW1lXCI7XHJcbmltcG9ydCB7IEV2ZW50UmVjb3JkRW50cnkgfSBmcm9tIFwiLi4vZXZlbnRzL0V2ZW50UmVjb3JkRW50cnlcIjtcclxuaW1wb3J0IHsgUGxheWVyQWN0aW9uRXZlbnQgfSBmcm9tIFwiLi4vZXZlbnRzL1BsYXllckFjdGlvbkV2ZW50XCI7XHJcbmV4cG9ydCB7IFBsYXllckFjdGlvbkV2ZW50IH07XHJcbmltcG9ydCB7IEdhbWVwYXJ0QmFzZSB9IGZyb20gXCIuL0dhbWVwYXJ0QmFzZVwiO1xyXG4vKipcclxuICogQWxsIGV2ZW50cyBoYXZlIHR3byBjb3JyZXNwb25kaW5nIGhhbmRsZXIgZnVuY3Rpb25zIHRha2luZyBhXHJcbiAqIHJlcXVlc3QgZGVzY3JpcHRvciBvYmplY3QgKFwiZGVzY1wiKTpcclxuICpcclxuICogIyMjIFJlcXVlc3QgUHJvY2Vzc29yXHJcbiAqXHJcbiAqIFRoZSByZXF1ZXN0IHByb2Nlc3NvciBpcyBvbmx5IHVzZWQgYnkgdGhlIEdhbWUgTWFuYWdlci4gSXQgZGVjaWRlc1xyXG4gKiB3aGV0aGVyIHRvIGFjY2VwdCBvciByZWplY3QgdGhlIHJlcXVlc3QgYmFzZWQgb24gYGRlc2NgIGFuZCBtYXlcclxuICogdGhyb3cgZXhjZXB0aW9ucyBvbiBpbXBvc3NpYmxlIGFyZ3VtZW50cy4gSXQgc2hvdWxkIG5vdCBtYWtlIGFueVxyXG4gKiBjaGFuZ2VzIHRvIHRoZSBnYW1lIHN0YXRlLiBJbnN0ZWFkLCBpdCBpcyByZXNwb25zaWJsZSB0byBhdWdtZW50XHJcbiAqIGBkZXNjYCB3aXRoIGluZm9ybWF0aW9uIGRlc2NyaWJpbmcgd2hhdCBjaGFuZ2VzIHRvIHRoZSBnYW1lIHN0YXRlXHJcbiAqIG11c3QgYmUgbWFkZS5cclxuICpcclxuICogIyMjIFJlcXVlc3QgRXhlY3V0b3JcclxuICpcclxuICogVGhpcyB0YWtlcyB0aGUgYGRlc2NgIGF1Z21lbnRlZCBieSB0aGUgcmVxdWVzdCBwcm9jZXNzb3IgYW5kIGVuYWN0c1xyXG4gKiBhbGwgdGhlIGRlc2NyaWJlZCBjaGFuZ2VzIHVwb24gdGhlIGdhbWUncyBzdGF0ZS4gSWYgdGhlIEdhbWUgTWFuYWdlclxyXG4gKiBpcyBub3QgbG9jYWwgdG8gdGhlIGNsaWVudCAoYSBzZXJ2ZXIgcHJvY2VzcyksIHRoZW4gdGhpcyBoYW5kbGVyIGlzXHJcbiAqIGNhbGxlZCBhdCBib3RoIHRoZSBzZXJ2ZXIgYW5kIGNsaWVudC5cclxuICpcclxuICogVXBkYXRlcyB0aGUgZXZlbnQgcmVjb3JkIGlmIHRoZSByZXNwb25zZSBpcyBhY2NlcHRlZC5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBHYW1lcGFydEV2ZW50cyBleHRlbmRzIEdhbWVwYXJ0QmFzZSB7XHJcbiAgICBjb25zdHJ1Y3RvcihnYW1lVHlwZSwgaW1wbCwgZ2FtZURlc2MpIHtcclxuICAgICAgICBzdXBlcihnYW1lVHlwZSwgaW1wbCwgZ2FtZURlc2MpO1xyXG4gICAgICAgIF9uZXh0VW51c2VkRXZlbnRJZC5zZXQodGhpcywgdm9pZCAwKTtcclxuICAgICAgICB0aGlzLmV2ZW50UmVjb3JkQml0bWFwID0gW107XHJcbiAgICB9XHJcbiAgICByZXNldCgpIHtcclxuICAgICAgICBjb25zdCBzdXBlclByb21pc2UgPSBzdXBlci5yZXNldCgpO1xyXG4gICAgICAgIC8vIENsZWFyIHRoZSBldmVudCByZWNvcmQ6XHJcbiAgICAgICAgdGhpcy5ldmVudFJlY29yZEJpdG1hcC5maWxsKGZhbHNlLCAwLCBHYW1lLksuRVZFTlRfUkVDT1JEX1dSQVBQSU5HX0JVRkZFUl9MRU5HVEgpO1xyXG4gICAgICAgIF9fY2xhc3NQcml2YXRlRmllbGRTZXQodGhpcywgX25leHRVbnVzZWRFdmVudElkLCAwKTtcclxuICAgICAgICAvLyBTaW5jZSB3ZSBkaWRuJ3Qgd2FpdCBmb3IgdGhlIHN1cGVyUHJvbWlzZSwgcmV0dXJuIGl0LlxyXG4gICAgICAgIHJldHVybiBzdXBlclByb21pc2U7XHJcbiAgICB9XHJcbiAgICBnZXQgbmV4dFVudXNlZEV2ZW50SWQoKSB7XHJcbiAgICAgICAgcmV0dXJuIF9fY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX25leHRVbnVzZWRFdmVudElkKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQmFzaWNhbGx5IGRvZXMgYHRoaXMuZXZlbnRSZWNvcmRbaWRdID0gZGVzYztgIHdpdGggdmFsdWUgY2hlY2tpbmcuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGRlc2MgLVxyXG4gICAgICpcclxuICAgICAqIEB0aHJvd3NcclxuICAgICAqIEluIHRoZSBnaXZlbiBvcmRlciBvZiBwcmlvcml0eTpcclxuICAgICAqIC0gVHlwZUVycm9yIGlmIHRoZSBldmVudCBJRCBpbmRpY2F0ZXMgYSByZWplY3RlZCByZXF1ZXN0XHJcbiAgICAgKiAtIFJhbmdlRXJyb3IgaWYgaXQgaXMgbm90IGEgcG9zaXRpdmUgaW50ZWdlclxyXG4gICAgICogLSBFcnJvciBpZiBhbm90aGVyIGV2ZW50IHdhcyBhbHJlYWR5IHJlY29yZGVkIHdpdGggdGhlIHNhbWUgSUQuXHJcbiAgICAgKi9cclxuICAgIF9yZWNvcmRFdmVudChkZXNjKSB7XHJcbiAgICAgICAgY29uc3QgaWQgPSBkZXNjLmV2ZW50SWQ7XHJcbiAgICAgICAgY29uc3Qgd3JhcHBlZElkID0gaWQgJSBHYW1lLksuRVZFTlRfUkVDT1JEX1dSQVBQSU5HX0JVRkZFUl9MRU5HVEg7XHJcbiAgICAgICAgaWYgKGlkID09PSBFdmVudFJlY29yZEVudHJ5LkVWRU5UX0lEX1JFSkVDVCkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiRG8gbm90IHRyeSB0byByZWNvcmQgZXZlbnRzIGZvciByZWplY3RlZCByZXF1ZXN0cy5cIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGlkIDwgMCB8fCBpZCAhPT0gTWF0aC50cnVuYyhpZCkpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoXCJFdmVudCBJRCdzIG11c3Qgb25seSBiZSBhc3NpZ25lZCBwb3NpdGl2ZSwgaW50ZWdlciB2YWx1ZXMuXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh0aGlzLmV2ZW50UmVjb3JkQml0bWFwW3dyYXBwZWRJZF0pIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRXZlbnQgSUQncyBtdXN0IGJlIGFzc2lnbmVkIHVuaXF1ZSB2YWx1ZXMuXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBUT0RPLmltcGwgQ2hlY2sgZm9yIGFuIE9ubGluZUdhbWUgdGhhdCBpdCBpcyBub3QgZmFyIGJlaGluZCB0aGUgU2VydmVyLlxyXG4gICAgICAgIC8vIGFsc28gZGVzaWduIHdoYXQgc2hvdWxkIGJlIGRvbmUgdG8gaGFuZGxlIHRoYXQuLi4gRG8gd2UgcmVhbGx5IG5lZWQgdG9cclxuICAgICAgICAvLyByZWNvdmVyIGZyb20gdGhhdD9cclxuICAgICAgICB0aGlzLmV2ZW50UmVjb3JkQml0bWFwW3dyYXBwZWRJZF0gPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuZXZlbnRSZWNvcmRCaXRtYXBbKGlkXHJcbiAgICAgICAgICAgICsgR2FtZS5LLkVWRU5UX1JFQ09SRF9XUkFQUElOR19CVUZGRVJfTEVOR1RIXHJcbiAgICAgICAgICAgIC0gR2FtZS5LLkVWRU5UX1JFQ09SRF9GT1JXQVJEX1dJTkRPV19MRU5HVEgpXHJcbiAgICAgICAgICAgICUgR2FtZS5LLkVWRU5UX1JFQ09SRF9XUkFQUElOR19CVUZGRVJfTEVOR1RIXSA9IGZhbHNlO1xyXG4gICAgICAgIF9fY2xhc3NQcml2YXRlRmllbGRTZXQodGhpcywgX25leHRVbnVzZWRFdmVudElkLCArX19jbGFzc1ByaXZhdGVGaWVsZEdldCh0aGlzLCBfbmV4dFVudXNlZEV2ZW50SWQpICsgMSk7XHJcbiAgICB9XHJcbiAgICBleGVjdXRlVGlsZU1vZEV2ZW50KGRlc2MsIGRvQ2hlY2tPcGVyYXRvclNlcUJ1ZmZlciA9IHRydWUpIHtcclxuICAgICAgICBPYmplY3QuZnJlZXplKGRlc2MpO1xyXG4gICAgICAgIGNvbnN0IGRlc3QgPSB0aGlzLmdyaWQudGlsZS5hdChkZXNjLmNvb3JkKTtcclxuICAgICAgICBpZiAoZGVzdC5sYXN0S25vd25VcGRhdGVJZCA+IGRlc2MubGFzdEtub3duVXBkYXRlSWQpXHJcbiAgICAgICAgICAgIHJldHVybiBkZXN0O1xyXG4gICAgICAgIGlmIChkZXN0Lmxhc3RLbm93blVwZGF0ZUlkID09PSBkZXNjLmxhc3RLbm93blVwZGF0ZUlkKVxyXG4gICAgICAgICAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcihcIm5ldmVyXCIpO1xyXG4gICAgICAgIGlmIChkZXNjLm5ld0NoYXJTZXFQYWlyKSB7XHJcbiAgICAgICAgICAgIGRlc3Quc2V0TGFuZ0NoYXJTZXFQYWlyKGRlc2MubmV3Q2hhclNlcVBhaXIpO1xyXG4gICAgICAgICAgICAvLyBSZWZyZXNoIHRoZSBvcGVyYXRvcidzIGBzZXFCdWZmZXJgIChtYWludGFpbiBpbnZhcmlhbnQpIGZvciBuZXcgQ1NQOlxyXG4gICAgICAgICAgICBpZiAoZG9DaGVja09wZXJhdG9yU2VxQnVmZmVyKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBeRG8gdGhpcyB3aGVuIG5vbi1vcGVyYXRvciBtb3ZlcyBpbnRvIHRoZSB0aGUgb3BlcmF0b3IncyB2aWNpbml0eS5cclxuICAgICAgICAgICAgICAgIHRoaXMub3BlcmF0b3JzLmZpbHRlcigob3ApID0+IHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gb3AudGlsZS5kZXN0c0Zyb20oKS5nZXQuaW5jbHVkZXMoZGVzdCk7XHJcbiAgICAgICAgICAgICAgICB9KS5mb3JFYWNoKChvcCkgPT4gb3Auc2VxQnVmZmVyQWNjZXB0S2V5KFwiXCIpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBkZXN0Lmxhc3RLbm93blVwZGF0ZUlkID0gZGVzYy5sYXN0S25vd25VcGRhdGVJZDtcclxuICAgICAgICBkZXN0LmZyZWVIZWFsdGggPSBkZXNjLm5ld0ZyZWVIZWFsdGg7XHJcbiAgICAgICAgcmV0dXJuIGRlc3Q7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEF1dG9tYXRpY2FsbHkgbG93ZXJzIHRoZSB7QGxpbmsgUGxheWVyI3JlcXVlc3RJbkZsaWdodH0gZmllbGRcclxuICAgICAqIGZvciB0aGUgcmVxdWVzdGluZyBgUGxheWVyYCBpZiB0aGUgYXJyaXZpbmcgZXZlbnQgZGVzY3JpcHRpb25cclxuICAgICAqIGlzIHRoZSBuZXdlc3Qgb25lIGZvciB0aGUgc3BlY2lmaWVkIGBQbGF5ZXJgLlxyXG4gICAgICpcclxuICAgICAqIFVwZGF0ZXMgdGhhdCBhcmUgcmVjZWl2ZWQgYWZ0ZXIgb3RoZXJzIHRoYXQgYXJlIG1vcmUgcmVjZW50IGFuZFxyXG4gICAgICogY29uY2VybiB0aGUgc2FtZSB7QGxpbmsgVGlsZX0gYXJlIGlnbm9yZWQuIFRoaXMgaXMgb2theSBzaW5jZVxyXG4gICAgICogdGhlIG9ubHkgdGhpbmcgdGhhdCBtYXR0ZXJzIGFib3V0IGEge0BsaW5rIFRpbGV9IHRvIHRoZSBvdXRzaWRlXHJcbiAgICAgKiB3b3JsZCBpcyBpdHMgbGFzdCBrbm93biBzdGF0ZS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gZGVzY1xyXG4gICAgICogQSBkZXNjcmlwdG9yIGZvciBhbGwgY2hhbmdlcyBtYW5kYXRlZCBieSB0aGUgcGxheWVyLW1vdmVtZW50IGV2ZW50LlxyXG4gICAgICovXHJcbiAgICBleGVjdXRlUGxheWVyTW92ZUV2ZW50KGRlc2MpIHtcclxuICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coZGVzYyk7XHJcbiAgICAgICAgY29uc3QgcGxheWVyID0gdGhpcy5wbGF5ZXJzW2Rlc2MucGxheWVySWRdO1xyXG4gICAgICAgIGNvbnN0IGNsaWVudEV2ZW50TGFnID0gZGVzYy5wbGF5ZXJMYXN0QWNjZXB0ZWRSZXF1ZXN0SWQgLSBwbGF5ZXIubGFzdEFjY2VwdGVkUmVxdWVzdElkO1xyXG4gICAgICAgIGlmIChkZXNjLmV2ZW50SWQgPT09IEV2ZW50UmVjb3JkRW50cnkuRVZFTlRfSURfUkVKRUNUKSB7XHJcbiAgICAgICAgICAgIC8vIFJlamVjdGVkIHJlcXVlc3QuIEltcGxpZXMgZWl0aGVyIHRoYXQ6IGNsaWVudEV2ZW50TGFnID09PSAwLFxyXG4gICAgICAgICAgICAvLyBvciB0aGF0IChhdCBHYW1lIE1hbmFnZXIpOiBkZXN0Lm51bVRpbWVzT2NjdXBpZWQgPiBkZXNjLmRlc3ROdW1UaW1lc09jY3VwaWVkXHJcbiAgICAgICAgICAgIGlmIChjbGllbnRFdmVudExhZyA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgcGxheWVyLnJlcXVlc3RJbkZsaWdodCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybjsgLy8gU2hvcnQtY2lyY3VpdCFcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fcmVjb3JkRXZlbnQoZGVzYyk7XHJcbiAgICAgICAgY29uc3QgZGVzdCA9IHRoaXMuZXhlY3V0ZVRpbGVNb2RFdmVudChkZXNjLmRlc3RNb2REZXNjLCBwbGF5ZXIgIT09IHRoaXMuY3VycmVudE9wZXJhdG9yKTtcclxuICAgICAgICAoX2EgPSBkZXNjLnRpbGVIZWFsdGhNb2REZXNjcykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmZvckVhY2goKGRlc2MpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5leGVjdXRlVGlsZU1vZEV2ZW50KGRlc2MpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmIChjbGllbnRFdmVudExhZyA+IDEpIHtcclxuICAgICAgICAgICAgLy8gPT09PT0gT3V0IG9mIG9yZGVyIHJlY2VpcHQgKGNsaWVudHNpZGUpID09PT09XHJcbiAgICAgICAgICAgIC8vIEFscmVhZHkgcmVjZWl2ZWQgbW9yZSByZWNlbnQgcmVxdWVzdCByZXNwb25zZXMuXHJcbiAgICAgICAgICAgIGlmIChwbGF5ZXIgPT09IHRoaXMuY3VycmVudE9wZXJhdG9yKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBPcGVyYXRvciBuZXZlciByZWNlaXZlcyB0aGVpciBvd24gdXBkYXRlcyBvdXQgb2ZcclxuICAgICAgICAgICAgICAgIC8vIG9yZGVyIGJlY2F1c2UgdGhleSBvbmx5IGhhdmUgb25lIHVuYWNrbm93bGVkZ2VkXHJcbiAgICAgICAgICAgICAgICAvLyBpbi1mbGlnaHQgcmVxdWVzdCBhdCBhIHRpbWUuXHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJuZXZlclwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm47IC8vIFNob3J0LWNpcmN1aXQhXHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIE9rYXktIHRoZSByZXNwb25zZSBpcyBhbiBhY2NlcHRhbmNlIG9mIHRoZSBzcGVjaWZpZWQgcGxheWVyJ3MgbW9zdFxyXG4gICAgICAgIC8vIHJlY2VudCByZXF1ZXN0IHBlbmRpbmcgdGhpcyBhY2tub3dsZWRnZW1lbnQuXHJcbiAgICAgICAgcGxheWVyLnJlcXVlc3RJbkZsaWdodCA9IGZhbHNlO1xyXG4gICAgICAgIGlmICgocGxheWVyID09PSB0aGlzLmN1cnJlbnRPcGVyYXRvcilcclxuICAgICAgICAgICAgPyAoY2xpZW50RXZlbnRMYWcgPT09IDEpXHJcbiAgICAgICAgICAgIDogKGNsaWVudEV2ZW50TGFnIDw9IDEpKSB7XHJcbiAgICAgICAgICAgIHBsYXllci5zdGF0dXMuaGVhbHRoID0gZGVzYy5uZXdQbGF5ZXJIZWFsdGguaGVhbHRoO1xyXG4gICAgICAgICAgICBwbGF5ZXIubW92ZVRvKGRlc3QpO1xyXG4gICAgICAgICAgICAvLyBCZWxvdyBpcyBjb21wdXRhdGlvbmFsbHkgdGhlIHNhbWUgYXMgXCIocGxheWVyLmxhc3RBY2NlcHRlZFJlcXVlc3RJZCkrK1wiXHJcbiAgICAgICAgICAgIHBsYXllci5sYXN0QWNjZXB0ZWRSZXF1ZXN0SWQgPSBkZXNjLnBsYXllckxhc3RBY2NlcHRlZFJlcXVlc3RJZDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIEFwcGFyZW50IG5lZ2F0aXZlIGxhZy4gVGhlIG9wZXJhdG9yIG1heSBzb21laG93IGhhdmVcclxuICAgICAgICAgICAgLy8gdGFtcGVyZWQgd2l0aCB0aGVpciBwbGF5ZXIncyByZXF1ZXN0IGNvdW50ZXIuXHJcbiAgICAgICAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKFwibmV2ZXJcIik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKlxyXG4gICAgICogQXV0b21hdGljYWxseSBsb3dlcnMgdGhlIHtAbGluayBQbGF5ZXIjcmVxdWVzdEluRmxpZ2h0fSBmaWVsZFxyXG4gICAgICogZm9yIHRoZSByZXF1ZXN0aW5nIGBQbGF5ZXJgLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBkZXNjIC1cclxuICAgICAqL1xyXG4gICAgZXhlY3V0ZVBsYXllckJ1YmJsZUV2ZW50KGRlc2MpIHtcclxuICAgICAgICBjb25zdCBidWJibGVyID0gdGhpcy5wbGF5ZXJzW2Rlc2MucGxheWVySWRdO1xyXG4gICAgICAgIGJ1YmJsZXIucmVxdWVzdEluRmxpZ2h0ID0gZmFsc2U7XHJcbiAgICAgICAgaWYgKGRlc2MuZXZlbnRJZCAhPT0gRXZlbnRSZWNvcmRFbnRyeS5FVkVOVF9JRF9SRUpFQ1QpIHtcclxuICAgICAgICAgICAgdGhpcy5fcmVjb3JkRXZlbnQoZGVzYyk7IC8vIFJlY29yZCB0aGUgZXZlbnQuXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbl9uZXh0VW51c2VkRXZlbnRJZCA9IG5ldyBXZWFrTWFwKCk7XHJcbk9iamVjdC5mcmVlemUoR2FtZXBhcnRFdmVudHMpO1xyXG5PYmplY3QuZnJlZXplKEdhbWVwYXJ0RXZlbnRzLnByb3RvdHlwZSk7XHJcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/base/game/gameparts/GamepartEvents.ts\n");

/***/ }),

/***/ "./src/base/game/player/OperatorPlayer.ts":
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"OperatorPlayer\": () => /* binding */ OperatorPlayer\n/* harmony export */ });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(\"./node_modules/tslib/tslib.es6.js\");\n/* harmony import */ var defs_JsUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./src/base/defs/JsUtils.ts\");\n/* harmony import */ var defs_TypeDefs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"./src/base/defs/TypeDefs.ts\");\n/* harmony import */ var floor_Tile__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"./src/base/floor/Tile.ts\");\n/* harmony import */ var _Player__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(\"./src/base/game/player/Player.ts\");\nvar _seqBuffer, _langRemappingFunc;\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * There is at least one in online-clientside and offline games.\r\n * There are none for online-serverside games.\r\n */\r\nclass OperatorPlayer extends _Player__WEBPACK_IMPORTED_MODULE_3__.Player {\r\n    constructor(game, desc) {\r\n        super(game, desc);\r\n        /**\r\n         * Invariant: always matches the prefix of the {@link LangSeq} of\r\n         * an unoccupied neighbouring {@link Tile}.\r\n         */\r\n        _seqBuffer.set(this, void 0);\r\n        _langRemappingFunc.set(this, void 0);\r\n        (0,tslib__WEBPACK_IMPORTED_MODULE_4__.__classPrivateFieldSet)(this, _langRemappingFunc, this.game.langFrontend.remapFunc);\r\n    }\r\n    reset(spawnTile) {\r\n        super.reset(spawnTile);\r\n        this.prevCoord = spawnTile.coord;\r\n        (0,tslib__WEBPACK_IMPORTED_MODULE_4__.__classPrivateFieldSet)(this, _seqBuffer, \"\");\r\n    }\r\n    /**\r\n     * Callback function invoked when the Operator presses a key while\r\n     * the game's html element has focus. Because of how JavaScript\r\n     * and also Node.js run in a single thread, this is an atomic\r\n     * operation (implementation must not intermediately schedule any\r\n     * other task-relevant callbacks until all critical operations are\r\n     * complete).\r\n     *\r\n     * @param event - The object describing the `KeyboardEvent`.\r\n     */\r\n    processKeyboardInput(event) {\r\n        if (this.game.status !== \"PLAYING\" /* PLAYING */)\r\n            return;\r\n        if (!this.requestInFlight) {\r\n            // Only process movement-type input if the last request got\r\n            // acknowledged by the Game Manager and the game is playing.\r\n            if (event.key === \" \") {\r\n                if (!floor_Tile__WEBPACK_IMPORTED_MODULE_2__.Coord.equals(this.coord, this.prevCoord)) {\r\n                    this.makeMovementRequest(this.game.grid.getUntAwayFrom(this.prevCoord, this.coord), _Player__WEBPACK_IMPORTED_MODULE_3__.Player.MoveType.BOOST);\r\n                }\r\n            }\r\n            else if (event.key.length === 1 && !event.repeat) {\r\n                // TODO.design is the above condition okay? will any\r\n                // languages require different behaviour?\r\n                this.seqBufferAcceptKey(event.key);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Automatically makes a call to make a movement request if the\r\n     * provided `key` completes the `LangSeq` of a UNT. Does not do\r\n     * any checking regarding {@link OperatorPlayer#requestInFlight}.\r\n     *\r\n     * @param key\r\n     * The pressed typeable key as a string. Pass an empty string to\r\n     * trigger a refresh of the {@link OperatorPlayer#_seqBuffer} to\r\n     * maintain its invariant.\r\n     */\r\n    seqBufferAcceptKey(key) {\r\n        const unts = this.tile.destsFrom().unoccupied.get;\r\n        if (unts.length === 0) {\r\n            // Every neighbouring `Tile` is occupied!\r\n            // In this case, no movement is possible.\r\n            return;\r\n        }\r\n        if (key) {\r\n            key = (0,tslib__WEBPACK_IMPORTED_MODULE_4__.__classPrivateFieldGet)(this, _langRemappingFunc).call(this, key);\r\n            if (!(defs_TypeDefs__WEBPACK_IMPORTED_MODULE_1__.Lang.Seq.REGEXP.test(key))) {\r\n                // throw new RangeError(`The implementation of input transformation`\r\n                // + ` in the currently selected language did not follow the rule`\r\n                // + ` of producing output matching the regular expression`\r\n                // + ` \\\"${Lang.Seq.REGEXP.source}\\\".`\r\n                // );\r\n                return;\r\n            }\r\n        }\r\n        else {\r\n            const possibleTarget = unts.find((tile) => tile.langSeq.startsWith(this.seqBuffer));\r\n            if (!possibleTarget) {\r\n                // If the thing I was trying to get to is gone, clear the buffer.\r\n                (0,tslib__WEBPACK_IMPORTED_MODULE_4__.__classPrivateFieldSet)(this, _seqBuffer, \"\");\r\n            }\r\n            return;\r\n        }\r\n        for ( // loop through substring start offset of newSeqBuffer:\r\n        let newSeqBuffer = this.seqBuffer + key; newSeqBuffer.length; newSeqBuffer = newSeqBuffer.substring(1)) {\r\n            // look for the longest suffixing substring of `newSeqBuffer`\r\n            // that is a prefixing substring of any UNT's.\r\n            const possibleTarget = unts.find((tile) => tile.langSeq.startsWith(newSeqBuffer));\r\n            if (possibleTarget) {\r\n                (0,tslib__WEBPACK_IMPORTED_MODULE_4__.__classPrivateFieldSet)(this, _seqBuffer, newSeqBuffer);\r\n                if (possibleTarget.langSeq === newSeqBuffer) {\r\n                    this.makeMovementRequest(possibleTarget, _Player__WEBPACK_IMPORTED_MODULE_3__.Player.MoveType.NORMAL);\r\n                }\r\n                return;\r\n            }\r\n        }\r\n        // Operator's new `seqBuffer` didn't match anything.\r\n        (0,tslib__WEBPACK_IMPORTED_MODULE_4__.__classPrivateFieldSet)(this, _seqBuffer, \"\");\r\n        this.status.visualBell();\r\n    }\r\n    /**\r\n     * Automatically clears the {@link OperatorPlayer#seqBuffer}.\r\n     *\r\n     * @override\r\n     */\r\n    moveTo(dest) {\r\n        // Clear my `seqBuffer` first:\r\n        (0,tslib__WEBPACK_IMPORTED_MODULE_4__.__classPrivateFieldSet)(this, _seqBuffer, \"\");\r\n        this.prevCoord = this.coord;\r\n        super.moveTo(dest);\r\n    }\r\n    _notifyWillBecomeCurrent() {\r\n        this.status._notifyWillBecomeCurrent(this.game.grid.spotlightElems);\r\n    }\r\n    get seqBuffer() {\r\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_4__.__classPrivateFieldGet)(this, _seqBuffer);\r\n    }\r\n}\r\n_seqBuffer = new WeakMap(), _langRemappingFunc = new WeakMap();\r\ndefs_JsUtils__WEBPACK_IMPORTED_MODULE_0__.JsUtils.protoNoEnum(OperatorPlayer, [\"_notifyWillBecomeCurrent\"]);\r\nObject.freeze(OperatorPlayer);\r\nObject.freeze(OperatorPlayer.prototype);\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvYmFzZS9nYW1lL3BsYXllci9PcGVyYXRvclBsYXllci50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovL3NuYWtleTMvLi9zcmMvYmFzZS9nYW1lL3BsYXllci9PcGVyYXRvclBsYXllci50cz9iNDk2Il0sInNvdXJjZXNDb250ZW50IjpbInZhciBfc2VxQnVmZmVyLCBfbGFuZ1JlbWFwcGluZ0Z1bmM7XHJcbmltcG9ydCB7IF9fY2xhc3NQcml2YXRlRmllbGRHZXQsIF9fY2xhc3NQcml2YXRlRmllbGRTZXQgfSBmcm9tIFwidHNsaWJcIjtcclxuaW1wb3J0IHsgSnNVdGlscyB9IGZyb20gXCJkZWZzL0pzVXRpbHNcIjtcclxuaW1wb3J0IHsgTGFuZyBhcyBfTGFuZyB9IGZyb20gXCJkZWZzL1R5cGVEZWZzXCI7XHJcbmltcG9ydCB7IENvb3JkIH0gZnJvbSBcImZsb29yL1RpbGVcIjtcclxuaW1wb3J0IHsgUGxheWVyIH0gZnJvbSBcIi4vUGxheWVyXCI7XHJcbi8qKlxyXG4gKiBUaGVyZSBpcyBhdCBsZWFzdCBvbmUgaW4gb25saW5lLWNsaWVudHNpZGUgYW5kIG9mZmxpbmUgZ2FtZXMuXHJcbiAqIFRoZXJlIGFyZSBub25lIGZvciBvbmxpbmUtc2VydmVyc2lkZSBnYW1lcy5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBPcGVyYXRvclBsYXllciBleHRlbmRzIFBsYXllciB7XHJcbiAgICBjb25zdHJ1Y3RvcihnYW1lLCBkZXNjKSB7XHJcbiAgICAgICAgc3VwZXIoZ2FtZSwgZGVzYyk7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogSW52YXJpYW50OiBhbHdheXMgbWF0Y2hlcyB0aGUgcHJlZml4IG9mIHRoZSB7QGxpbmsgTGFuZ1NlcX0gb2ZcclxuICAgICAgICAgKiBhbiB1bm9jY3VwaWVkIG5laWdoYm91cmluZyB7QGxpbmsgVGlsZX0uXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX3NlcUJ1ZmZlci5zZXQodGhpcywgdm9pZCAwKTtcclxuICAgICAgICBfbGFuZ1JlbWFwcGluZ0Z1bmMuc2V0KHRoaXMsIHZvaWQgMCk7XHJcbiAgICAgICAgX19jbGFzc1ByaXZhdGVGaWVsZFNldCh0aGlzLCBfbGFuZ1JlbWFwcGluZ0Z1bmMsIHRoaXMuZ2FtZS5sYW5nRnJvbnRlbmQucmVtYXBGdW5jKTtcclxuICAgIH1cclxuICAgIHJlc2V0KHNwYXduVGlsZSkge1xyXG4gICAgICAgIHN1cGVyLnJlc2V0KHNwYXduVGlsZSk7XHJcbiAgICAgICAgdGhpcy5wcmV2Q29vcmQgPSBzcGF3blRpbGUuY29vcmQ7XHJcbiAgICAgICAgX19jbGFzc1ByaXZhdGVGaWVsZFNldCh0aGlzLCBfc2VxQnVmZmVyLCBcIlwiKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQ2FsbGJhY2sgZnVuY3Rpb24gaW52b2tlZCB3aGVuIHRoZSBPcGVyYXRvciBwcmVzc2VzIGEga2V5IHdoaWxlXHJcbiAgICAgKiB0aGUgZ2FtZSdzIGh0bWwgZWxlbWVudCBoYXMgZm9jdXMuIEJlY2F1c2Ugb2YgaG93IEphdmFTY3JpcHRcclxuICAgICAqIGFuZCBhbHNvIE5vZGUuanMgcnVuIGluIGEgc2luZ2xlIHRocmVhZCwgdGhpcyBpcyBhbiBhdG9taWNcclxuICAgICAqIG9wZXJhdGlvbiAoaW1wbGVtZW50YXRpb24gbXVzdCBub3QgaW50ZXJtZWRpYXRlbHkgc2NoZWR1bGUgYW55XHJcbiAgICAgKiBvdGhlciB0YXNrLXJlbGV2YW50IGNhbGxiYWNrcyB1bnRpbCBhbGwgY3JpdGljYWwgb3BlcmF0aW9ucyBhcmVcclxuICAgICAqIGNvbXBsZXRlKS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gZXZlbnQgLSBUaGUgb2JqZWN0IGRlc2NyaWJpbmcgdGhlIGBLZXlib2FyZEV2ZW50YC5cclxuICAgICAqL1xyXG4gICAgcHJvY2Vzc0tleWJvYXJkSW5wdXQoZXZlbnQpIHtcclxuICAgICAgICBpZiAodGhpcy5nYW1lLnN0YXR1cyAhPT0gXCJQTEFZSU5HXCIgLyogUExBWUlORyAqLylcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIGlmICghdGhpcy5yZXF1ZXN0SW5GbGlnaHQpIHtcclxuICAgICAgICAgICAgLy8gT25seSBwcm9jZXNzIG1vdmVtZW50LXR5cGUgaW5wdXQgaWYgdGhlIGxhc3QgcmVxdWVzdCBnb3RcclxuICAgICAgICAgICAgLy8gYWNrbm93bGVkZ2VkIGJ5IHRoZSBHYW1lIE1hbmFnZXIgYW5kIHRoZSBnYW1lIGlzIHBsYXlpbmcuXHJcbiAgICAgICAgICAgIGlmIChldmVudC5rZXkgPT09IFwiIFwiKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIUNvb3JkLmVxdWFscyh0aGlzLmNvb3JkLCB0aGlzLnByZXZDb29yZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm1ha2VNb3ZlbWVudFJlcXVlc3QodGhpcy5nYW1lLmdyaWQuZ2V0VW50QXdheUZyb20odGhpcy5wcmV2Q29vcmQsIHRoaXMuY29vcmQpLCBQbGF5ZXIuTW92ZVR5cGUuQk9PU1QpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGV2ZW50LmtleS5sZW5ndGggPT09IDEgJiYgIWV2ZW50LnJlcGVhdCkge1xyXG4gICAgICAgICAgICAgICAgLy8gVE9ETy5kZXNpZ24gaXMgdGhlIGFib3ZlIGNvbmRpdGlvbiBva2F5PyB3aWxsIGFueVxyXG4gICAgICAgICAgICAgICAgLy8gbGFuZ3VhZ2VzIHJlcXVpcmUgZGlmZmVyZW50IGJlaGF2aW91cj9cclxuICAgICAgICAgICAgICAgIHRoaXMuc2VxQnVmZmVyQWNjZXB0S2V5KGV2ZW50LmtleSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEF1dG9tYXRpY2FsbHkgbWFrZXMgYSBjYWxsIHRvIG1ha2UgYSBtb3ZlbWVudCByZXF1ZXN0IGlmIHRoZVxyXG4gICAgICogcHJvdmlkZWQgYGtleWAgY29tcGxldGVzIHRoZSBgTGFuZ1NlcWAgb2YgYSBVTlQuIERvZXMgbm90IGRvXHJcbiAgICAgKiBhbnkgY2hlY2tpbmcgcmVnYXJkaW5nIHtAbGluayBPcGVyYXRvclBsYXllciNyZXF1ZXN0SW5GbGlnaHR9LlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBrZXlcclxuICAgICAqIFRoZSBwcmVzc2VkIHR5cGVhYmxlIGtleSBhcyBhIHN0cmluZy4gUGFzcyBhbiBlbXB0eSBzdHJpbmcgdG9cclxuICAgICAqIHRyaWdnZXIgYSByZWZyZXNoIG9mIHRoZSB7QGxpbmsgT3BlcmF0b3JQbGF5ZXIjX3NlcUJ1ZmZlcn0gdG9cclxuICAgICAqIG1haW50YWluIGl0cyBpbnZhcmlhbnQuXHJcbiAgICAgKi9cclxuICAgIHNlcUJ1ZmZlckFjY2VwdEtleShrZXkpIHtcclxuICAgICAgICBjb25zdCB1bnRzID0gdGhpcy50aWxlLmRlc3RzRnJvbSgpLnVub2NjdXBpZWQuZ2V0O1xyXG4gICAgICAgIGlmICh1bnRzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAvLyBFdmVyeSBuZWlnaGJvdXJpbmcgYFRpbGVgIGlzIG9jY3VwaWVkIVxyXG4gICAgICAgICAgICAvLyBJbiB0aGlzIGNhc2UsIG5vIG1vdmVtZW50IGlzIHBvc3NpYmxlLlxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChrZXkpIHtcclxuICAgICAgICAgICAga2V5ID0gX19jbGFzc1ByaXZhdGVGaWVsZEdldCh0aGlzLCBfbGFuZ1JlbWFwcGluZ0Z1bmMpLmNhbGwodGhpcywga2V5KTtcclxuICAgICAgICAgICAgaWYgKCEoX0xhbmcuU2VxLlJFR0VYUC50ZXN0KGtleSkpKSB7XHJcbiAgICAgICAgICAgICAgICAvLyB0aHJvdyBuZXcgUmFuZ2VFcnJvcihgVGhlIGltcGxlbWVudGF0aW9uIG9mIGlucHV0IHRyYW5zZm9ybWF0aW9uYFxyXG4gICAgICAgICAgICAgICAgLy8gKyBgIGluIHRoZSBjdXJyZW50bHkgc2VsZWN0ZWQgbGFuZ3VhZ2UgZGlkIG5vdCBmb2xsb3cgdGhlIHJ1bGVgXHJcbiAgICAgICAgICAgICAgICAvLyArIGAgb2YgcHJvZHVjaW5nIG91dHB1dCBtYXRjaGluZyB0aGUgcmVndWxhciBleHByZXNzaW9uYFxyXG4gICAgICAgICAgICAgICAgLy8gKyBgIFxcXCIke0xhbmcuU2VxLlJFR0VYUC5zb3VyY2V9XFxcIi5gXHJcbiAgICAgICAgICAgICAgICAvLyApO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdCBwb3NzaWJsZVRhcmdldCA9IHVudHMuZmluZCgodGlsZSkgPT4gdGlsZS5sYW5nU2VxLnN0YXJ0c1dpdGgodGhpcy5zZXFCdWZmZXIpKTtcclxuICAgICAgICAgICAgaWYgKCFwb3NzaWJsZVRhcmdldCkge1xyXG4gICAgICAgICAgICAgICAgLy8gSWYgdGhlIHRoaW5nIEkgd2FzIHRyeWluZyB0byBnZXQgdG8gaXMgZ29uZSwgY2xlYXIgdGhlIGJ1ZmZlci5cclxuICAgICAgICAgICAgICAgIF9fY2xhc3NQcml2YXRlRmllbGRTZXQodGhpcywgX3NlcUJ1ZmZlciwgXCJcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKCAvLyBsb29wIHRocm91Z2ggc3Vic3RyaW5nIHN0YXJ0IG9mZnNldCBvZiBuZXdTZXFCdWZmZXI6XHJcbiAgICAgICAgbGV0IG5ld1NlcUJ1ZmZlciA9IHRoaXMuc2VxQnVmZmVyICsga2V5OyBuZXdTZXFCdWZmZXIubGVuZ3RoOyBuZXdTZXFCdWZmZXIgPSBuZXdTZXFCdWZmZXIuc3Vic3RyaW5nKDEpKSB7XHJcbiAgICAgICAgICAgIC8vIGxvb2sgZm9yIHRoZSBsb25nZXN0IHN1ZmZpeGluZyBzdWJzdHJpbmcgb2YgYG5ld1NlcUJ1ZmZlcmBcclxuICAgICAgICAgICAgLy8gdGhhdCBpcyBhIHByZWZpeGluZyBzdWJzdHJpbmcgb2YgYW55IFVOVCdzLlxyXG4gICAgICAgICAgICBjb25zdCBwb3NzaWJsZVRhcmdldCA9IHVudHMuZmluZCgodGlsZSkgPT4gdGlsZS5sYW5nU2VxLnN0YXJ0c1dpdGgobmV3U2VxQnVmZmVyKSk7XHJcbiAgICAgICAgICAgIGlmIChwb3NzaWJsZVRhcmdldCkge1xyXG4gICAgICAgICAgICAgICAgX19jbGFzc1ByaXZhdGVGaWVsZFNldCh0aGlzLCBfc2VxQnVmZmVyLCBuZXdTZXFCdWZmZXIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHBvc3NpYmxlVGFyZ2V0LmxhbmdTZXEgPT09IG5ld1NlcUJ1ZmZlcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWFrZU1vdmVtZW50UmVxdWVzdChwb3NzaWJsZVRhcmdldCwgUGxheWVyLk1vdmVUeXBlLk5PUk1BTCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gT3BlcmF0b3IncyBuZXcgYHNlcUJ1ZmZlcmAgZGlkbid0IG1hdGNoIGFueXRoaW5nLlxyXG4gICAgICAgIF9fY2xhc3NQcml2YXRlRmllbGRTZXQodGhpcywgX3NlcUJ1ZmZlciwgXCJcIik7XHJcbiAgICAgICAgdGhpcy5zdGF0dXMudmlzdWFsQmVsbCgpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBBdXRvbWF0aWNhbGx5IGNsZWFycyB0aGUge0BsaW5rIE9wZXJhdG9yUGxheWVyI3NlcUJ1ZmZlcn0uXHJcbiAgICAgKlxyXG4gICAgICogQG92ZXJyaWRlXHJcbiAgICAgKi9cclxuICAgIG1vdmVUbyhkZXN0KSB7XHJcbiAgICAgICAgLy8gQ2xlYXIgbXkgYHNlcUJ1ZmZlcmAgZmlyc3Q6XHJcbiAgICAgICAgX19jbGFzc1ByaXZhdGVGaWVsZFNldCh0aGlzLCBfc2VxQnVmZmVyLCBcIlwiKTtcclxuICAgICAgICB0aGlzLnByZXZDb29yZCA9IHRoaXMuY29vcmQ7XHJcbiAgICAgICAgc3VwZXIubW92ZVRvKGRlc3QpO1xyXG4gICAgfVxyXG4gICAgX25vdGlmeVdpbGxCZWNvbWVDdXJyZW50KCkge1xyXG4gICAgICAgIHRoaXMuc3RhdHVzLl9ub3RpZnlXaWxsQmVjb21lQ3VycmVudCh0aGlzLmdhbWUuZ3JpZC5zcG90bGlnaHRFbGVtcyk7XHJcbiAgICB9XHJcbiAgICBnZXQgc2VxQnVmZmVyKCkge1xyXG4gICAgICAgIHJldHVybiBfX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHRoaXMsIF9zZXFCdWZmZXIpO1xyXG4gICAgfVxyXG59XHJcbl9zZXFCdWZmZXIgPSBuZXcgV2Vha01hcCgpLCBfbGFuZ1JlbWFwcGluZ0Z1bmMgPSBuZXcgV2Vha01hcCgpO1xyXG5Kc1V0aWxzLnByb3RvTm9FbnVtKE9wZXJhdG9yUGxheWVyLCBbXCJfbm90aWZ5V2lsbEJlY29tZUN1cnJlbnRcIl0pO1xyXG5PYmplY3QuZnJlZXplKE9wZXJhdG9yUGxheWVyKTtcclxuT2JqZWN0LmZyZWV6ZShPcGVyYXRvclBsYXllci5wcm90b3R5cGUpO1xyXG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/base/game/player/OperatorPlayer.ts\n");

/***/ }),

/***/ "./src/base/game/player/Player.ts":
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"PlayerSkeleton\": () => /* reexport safe */ _PlayerSkeleton__WEBPACK_IMPORTED_MODULE_2__.PlayerSkeleton,\n/* harmony export */   \"PlayerStatus\": () => /* reexport safe */ _PlayerStatus__WEBPACK_IMPORTED_MODULE_3__.PlayerStatus,\n/* harmony export */   \"Player\": () => /* binding */ Player\n/* harmony export */ });\n/* harmony import */ var defs_JsUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./src/base/defs/JsUtils.ts\");\n/* harmony import */ var game_events_PlayerActionEvent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"./src/base/game/events/PlayerActionEvent.ts\");\n/* harmony import */ var _PlayerSkeleton__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"./src/base/game/player/PlayerSkeleton.ts\");\n/* harmony import */ var _PlayerStatus__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(\"./src/base/game/player/PlayerStatus.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n *\r\n */\r\nclass Player extends _PlayerSkeleton__WEBPACK_IMPORTED_MODULE_2__.PlayerSkeleton {\r\n    /**\r\n     */\r\n    constructor(game, desc) {\r\n        var _a;\r\n        super(game, desc);\r\n        this.familyId = desc.familyId;\r\n        this.teamId = desc.teamId;\r\n        this.username = desc.username;\r\n        this.avatar = (_a = desc.avatar) !== null && _a !== void 0 ? _a : Player.Avatar.GET_RANDOM();\r\n        defs_JsUtils__WEBPACK_IMPORTED_MODULE_0__.JsUtils.propNoWrite(this, [\r\n            \"familyId\", \"teamId\", \"username\", \"avatar\",\r\n        ]);\r\n    }\r\n    reset(spawnTile) {\r\n        super.reset(spawnTile);\r\n        this.status.reset();\r\n        this.lastAcceptedRequestId = game_events_PlayerActionEvent__WEBPACK_IMPORTED_MODULE_1__.PlayerActionEvent.INITIAL_REQUEST_ID;\r\n        this.requestInFlight = false;\r\n    }\r\n    /**\r\n     * The default implementation does nothing.\r\n     */\r\n    _notifyGameNowPlaying() { }\r\n    /**\r\n     * The default implementation does nothing.\r\n     */\r\n    _notifyGameNowPaused() { }\r\n    /**\r\n     * The default implementation does nothing.\r\n     */\r\n    _notifyGameNowOver() { }\r\n    /**\r\n     * Called automatically by {@link OperatorPlayer#seqBufferAcceptKey}\r\n     * for {@link OperatorPlayer}s, and by a periodic callback for\r\n     * {@link ArtificialPlayer}s. Handles behaviour common between all\r\n     * implementations.\r\n     *\r\n     * @final\r\n     * @param dest -\r\n     * @throws A previous request is still in flight (unacknowledged).\r\n     */\r\n    makeMovementRequest(dest, type) {\r\n        if (this.game.status !== \"PLAYING\" /* PLAYING */) {\r\n            // TODO.build disable this check for production.\r\n            throw new Error(\"This is not a necessary precondition, but we're doing it anyway.\");\r\n        }\r\n        else if (this.requestInFlight) {\r\n            throw new Error(\"Only one request should ever be in flight at a time.\");\r\n        }\r\n        this.requestInFlight = true;\r\n        this.game.processMoveRequest(new game_events_PlayerActionEvent__WEBPACK_IMPORTED_MODULE_1__.PlayerActionEvent.Movement(this.playerId, this.lastAcceptedRequestId, dest, type));\r\n    }\r\n    get team() {\r\n        return this.game.teams[this.teamId];\r\n    }\r\n    isTeamedWith(other) {\r\n        return this.team.members.includes(other);\r\n    }\r\n}\r\n(function (Player) {\r\n    let CtorArgs;\r\n    (function (CtorArgs) {\r\n        /**\r\n         * @returns\r\n         * Squashes teamId fields to be suitable for array indices.\r\n         *\r\n         * @param playerDescs -\r\n         * @param langName -\r\n         */\r\n        function finalize(playerDescs) {\r\n            // Map team ID's to consecutive numbers\r\n            // (to play nice with array representations):\r\n            const teamIdCleaner = Array.from(new Set(playerDescs.map((player) => player.teamId)))\r\n                .sort((a, b) => a - b) // This is not a representation requirement.\r\n                .reduce((prev, originalId, squashedId) => {\r\n                prev[originalId] = squashedId;\r\n                return prev;\r\n            }, []);\r\n            return playerDescs.slice()\r\n                .sort((pda, pdb) => teamIdCleaner[pda.teamId] - teamIdCleaner[pdb.teamId])\r\n                .map((playerDesc, index) => Object.assign({}, playerDesc, {\r\n                playerId: index,\r\n                teamId: teamIdCleaner[playerDesc.teamId],\r\n            }));\r\n        }\r\n        CtorArgs.finalize = finalize;\r\n        ;\r\n    })(CtorArgs = Player.CtorArgs || (Player.CtorArgs = {}));\r\n    Object.freeze(CtorArgs);\r\n})(Player || (Player = {}));\r\ndefs_JsUtils__WEBPACK_IMPORTED_MODULE_0__.JsUtils.protoNoEnum(Player, [\r\n    \"_notifyGameNowPaused\", \"_notifyGameNowPlaying\", \"_notifyGameNowOver\",\r\n]);\r\nObject.freeze(Player);\r\nObject.freeze(Player.prototype);\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvYmFzZS9nYW1lL3BsYXllci9QbGF5ZXIudHMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zbmFrZXkzLy4vc3JjL2Jhc2UvZ2FtZS9wbGF5ZXIvUGxheWVyLnRzP2NhYjQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSnNVdGlscyB9IGZyb20gXCJkZWZzL0pzVXRpbHNcIjtcclxuaW1wb3J0IHsgUGxheWVyQWN0aW9uRXZlbnQgfSBmcm9tIFwiZ2FtZS9ldmVudHMvUGxheWVyQWN0aW9uRXZlbnRcIjtcclxuaW1wb3J0IHsgUGxheWVyU2tlbGV0b24gfSBmcm9tIFwiLi9QbGF5ZXJTa2VsZXRvblwiO1xyXG5leHBvcnQgeyBQbGF5ZXJTa2VsZXRvbiB9O1xyXG5pbXBvcnQgeyBQbGF5ZXJTdGF0dXMgfSBmcm9tIFwiLi9QbGF5ZXJTdGF0dXNcIjtcclxuZXhwb3J0IHsgUGxheWVyU3RhdHVzIH07XHJcbi8qKlxyXG4gKlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFBsYXllciBleHRlbmRzIFBsYXllclNrZWxldG9uIHtcclxuICAgIC8qKlxyXG4gICAgICovXHJcbiAgICBjb25zdHJ1Y3RvcihnYW1lLCBkZXNjKSB7XHJcbiAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgIHN1cGVyKGdhbWUsIGRlc2MpO1xyXG4gICAgICAgIHRoaXMuZmFtaWx5SWQgPSBkZXNjLmZhbWlseUlkO1xyXG4gICAgICAgIHRoaXMudGVhbUlkID0gZGVzYy50ZWFtSWQ7XHJcbiAgICAgICAgdGhpcy51c2VybmFtZSA9IGRlc2MudXNlcm5hbWU7XHJcbiAgICAgICAgdGhpcy5hdmF0YXIgPSAoX2EgPSBkZXNjLmF2YXRhcikgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogUGxheWVyLkF2YXRhci5HRVRfUkFORE9NKCk7XHJcbiAgICAgICAgSnNVdGlscy5wcm9wTm9Xcml0ZSh0aGlzLCBbXHJcbiAgICAgICAgICAgIFwiZmFtaWx5SWRcIiwgXCJ0ZWFtSWRcIiwgXCJ1c2VybmFtZVwiLCBcImF2YXRhclwiLFxyXG4gICAgICAgIF0pO1xyXG4gICAgfVxyXG4gICAgcmVzZXQoc3Bhd25UaWxlKSB7XHJcbiAgICAgICAgc3VwZXIucmVzZXQoc3Bhd25UaWxlKTtcclxuICAgICAgICB0aGlzLnN0YXR1cy5yZXNldCgpO1xyXG4gICAgICAgIHRoaXMubGFzdEFjY2VwdGVkUmVxdWVzdElkID0gUGxheWVyQWN0aW9uRXZlbnQuSU5JVElBTF9SRVFVRVNUX0lEO1xyXG4gICAgICAgIHRoaXMucmVxdWVzdEluRmxpZ2h0ID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFRoZSBkZWZhdWx0IGltcGxlbWVudGF0aW9uIGRvZXMgbm90aGluZy5cclxuICAgICAqL1xyXG4gICAgX25vdGlmeUdhbWVOb3dQbGF5aW5nKCkgeyB9XHJcbiAgICAvKipcclxuICAgICAqIFRoZSBkZWZhdWx0IGltcGxlbWVudGF0aW9uIGRvZXMgbm90aGluZy5cclxuICAgICAqL1xyXG4gICAgX25vdGlmeUdhbWVOb3dQYXVzZWQoKSB7IH1cclxuICAgIC8qKlxyXG4gICAgICogVGhlIGRlZmF1bHQgaW1wbGVtZW50YXRpb24gZG9lcyBub3RoaW5nLlxyXG4gICAgICovXHJcbiAgICBfbm90aWZ5R2FtZU5vd092ZXIoKSB7IH1cclxuICAgIC8qKlxyXG4gICAgICogQ2FsbGVkIGF1dG9tYXRpY2FsbHkgYnkge0BsaW5rIE9wZXJhdG9yUGxheWVyI3NlcUJ1ZmZlckFjY2VwdEtleX1cclxuICAgICAqIGZvciB7QGxpbmsgT3BlcmF0b3JQbGF5ZXJ9cywgYW5kIGJ5IGEgcGVyaW9kaWMgY2FsbGJhY2sgZm9yXHJcbiAgICAgKiB7QGxpbmsgQXJ0aWZpY2lhbFBsYXllcn1zLiBIYW5kbGVzIGJlaGF2aW91ciBjb21tb24gYmV0d2VlbiBhbGxcclxuICAgICAqIGltcGxlbWVudGF0aW9ucy5cclxuICAgICAqXHJcbiAgICAgKiBAZmluYWxcclxuICAgICAqIEBwYXJhbSBkZXN0IC1cclxuICAgICAqIEB0aHJvd3MgQSBwcmV2aW91cyByZXF1ZXN0IGlzIHN0aWxsIGluIGZsaWdodCAodW5hY2tub3dsZWRnZWQpLlxyXG4gICAgICovXHJcbiAgICBtYWtlTW92ZW1lbnRSZXF1ZXN0KGRlc3QsIHR5cGUpIHtcclxuICAgICAgICBpZiAodGhpcy5nYW1lLnN0YXR1cyAhPT0gXCJQTEFZSU5HXCIgLyogUExBWUlORyAqLykge1xyXG4gICAgICAgICAgICAvLyBUT0RPLmJ1aWxkIGRpc2FibGUgdGhpcyBjaGVjayBmb3IgcHJvZHVjdGlvbi5cclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVGhpcyBpcyBub3QgYSBuZWNlc3NhcnkgcHJlY29uZGl0aW9uLCBidXQgd2UncmUgZG9pbmcgaXQgYW55d2F5LlwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodGhpcy5yZXF1ZXN0SW5GbGlnaHQpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiT25seSBvbmUgcmVxdWVzdCBzaG91bGQgZXZlciBiZSBpbiBmbGlnaHQgYXQgYSB0aW1lLlwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5yZXF1ZXN0SW5GbGlnaHQgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuZ2FtZS5wcm9jZXNzTW92ZVJlcXVlc3QobmV3IFBsYXllckFjdGlvbkV2ZW50Lk1vdmVtZW50KHRoaXMucGxheWVySWQsIHRoaXMubGFzdEFjY2VwdGVkUmVxdWVzdElkLCBkZXN0LCB0eXBlKSk7XHJcbiAgICB9XHJcbiAgICBnZXQgdGVhbSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5nYW1lLnRlYW1zW3RoaXMudGVhbUlkXTtcclxuICAgIH1cclxuICAgIGlzVGVhbWVkV2l0aChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnRlYW0ubWVtYmVycy5pbmNsdWRlcyhvdGhlcik7XHJcbiAgICB9XHJcbn1cclxuKGZ1bmN0aW9uIChQbGF5ZXIpIHtcclxuICAgIGxldCBDdG9yQXJncztcclxuICAgIChmdW5jdGlvbiAoQ3RvckFyZ3MpIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAcmV0dXJuc1xyXG4gICAgICAgICAqIFNxdWFzaGVzIHRlYW1JZCBmaWVsZHMgdG8gYmUgc3VpdGFibGUgZm9yIGFycmF5IGluZGljZXMuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0gcGxheWVyRGVzY3MgLVxyXG4gICAgICAgICAqIEBwYXJhbSBsYW5nTmFtZSAtXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZnVuY3Rpb24gZmluYWxpemUocGxheWVyRGVzY3MpIHtcclxuICAgICAgICAgICAgLy8gTWFwIHRlYW0gSUQncyB0byBjb25zZWN1dGl2ZSBudW1iZXJzXHJcbiAgICAgICAgICAgIC8vICh0byBwbGF5IG5pY2Ugd2l0aCBhcnJheSByZXByZXNlbnRhdGlvbnMpOlxyXG4gICAgICAgICAgICBjb25zdCB0ZWFtSWRDbGVhbmVyID0gQXJyYXkuZnJvbShuZXcgU2V0KHBsYXllckRlc2NzLm1hcCgocGxheWVyKSA9PiBwbGF5ZXIudGVhbUlkKSkpXHJcbiAgICAgICAgICAgICAgICAuc29ydCgoYSwgYikgPT4gYSAtIGIpIC8vIFRoaXMgaXMgbm90IGEgcmVwcmVzZW50YXRpb24gcmVxdWlyZW1lbnQuXHJcbiAgICAgICAgICAgICAgICAucmVkdWNlKChwcmV2LCBvcmlnaW5hbElkLCBzcXVhc2hlZElkKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBwcmV2W29yaWdpbmFsSWRdID0gc3F1YXNoZWRJZDtcclxuICAgICAgICAgICAgICAgIHJldHVybiBwcmV2O1xyXG4gICAgICAgICAgICB9LCBbXSk7XHJcbiAgICAgICAgICAgIHJldHVybiBwbGF5ZXJEZXNjcy5zbGljZSgpXHJcbiAgICAgICAgICAgICAgICAuc29ydCgocGRhLCBwZGIpID0+IHRlYW1JZENsZWFuZXJbcGRhLnRlYW1JZF0gLSB0ZWFtSWRDbGVhbmVyW3BkYi50ZWFtSWRdKVxyXG4gICAgICAgICAgICAgICAgLm1hcCgocGxheWVyRGVzYywgaW5kZXgpID0+IE9iamVjdC5hc3NpZ24oe30sIHBsYXllckRlc2MsIHtcclxuICAgICAgICAgICAgICAgIHBsYXllcklkOiBpbmRleCxcclxuICAgICAgICAgICAgICAgIHRlYW1JZDogdGVhbUlkQ2xlYW5lcltwbGF5ZXJEZXNjLnRlYW1JZF0sXHJcbiAgICAgICAgICAgIH0pKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgQ3RvckFyZ3MuZmluYWxpemUgPSBmaW5hbGl6ZTtcclxuICAgICAgICA7XHJcbiAgICB9KShDdG9yQXJncyA9IFBsYXllci5DdG9yQXJncyB8fCAoUGxheWVyLkN0b3JBcmdzID0ge30pKTtcclxuICAgIE9iamVjdC5mcmVlemUoQ3RvckFyZ3MpO1xyXG59KShQbGF5ZXIgfHwgKFBsYXllciA9IHt9KSk7XHJcbkpzVXRpbHMucHJvdG9Ob0VudW0oUGxheWVyLCBbXHJcbiAgICBcIl9ub3RpZnlHYW1lTm93UGF1c2VkXCIsIFwiX25vdGlmeUdhbWVOb3dQbGF5aW5nXCIsIFwiX25vdGlmeUdhbWVOb3dPdmVyXCIsXHJcbl0pO1xyXG5PYmplY3QuZnJlZXplKFBsYXllcik7XHJcbk9iamVjdC5mcmVlemUoUGxheWVyLnByb3RvdHlwZSk7XHJcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/base/game/player/Player.ts\n");

/***/ }),

/***/ "./src/base/game/player/PlayerSkeleton.ts":
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"PlayerSkeleton\": () => /* binding */ PlayerSkeleton\n/* harmony export */ });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(\"./node_modules/tslib/tslib.es6.js\");\n/* harmony import */ var defs_JsUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./src/base/defs/JsUtils.ts\");\n/* harmony import */ var defs_TypeDefs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"./src/base/defs/TypeDefs.ts\");\n/* harmony import */ var floor_TileGetter__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"./src/base/floor/TileGetter.ts\");\nvar _hostTile;\r\n\r\n\r\n\r\n\r\n/**\r\n * Made to abstract all operations that change the `hostTile`\r\n * field. Enforces / exposes the `moveTo` method as\r\n * the interface to any such operations.\r\n *\r\n * @extends Player to intake its namespace exports.\r\n */\r\nclass PlayerSkeleton extends defs_TypeDefs__WEBPACK_IMPORTED_MODULE_1__.Player {\r\n    constructor(game, desc) {\r\n        super();\r\n        _hostTile.set(this, void 0);\r\n        if (Math.trunc(desc.playerId) !== desc.playerId) {\r\n            throw new RangeError(\"Player ID's must be integer values.\");\r\n        }\r\n        this.playerId = desc.playerId;\r\n        this.isALocalOperator = desc.isALocalOperator;\r\n        this.game = game;\r\n        this.status = new (this.game._playerStatusCtor)(this, desc.noCheckGameOver);\r\n        this.tile = new floor_TileGetter__WEBPACK_IMPORTED_MODULE_2__.TileGetter(new PlayerSkeleton.TileGetterSource(this));\r\n        defs_JsUtils__WEBPACK_IMPORTED_MODULE_0__.JsUtils.instNoEnum(this, [\"game\"]);\r\n        defs_JsUtils__WEBPACK_IMPORTED_MODULE_0__.JsUtils.propNoWrite(this, [\r\n            \"playerId\", \"isALocalOperator\",\r\n            \"game\", \"status\", \"tile\",\r\n        ]);\r\n    }\r\n    _afterAllPlayersConstruction() {\r\n        this.status._afterAllPlayersConstruction();\r\n    }\r\n    /**\r\n     * Must be called _after_ the {@link Grid} has been reset.\r\n     * Does not evict itself from its current host tile (if it\r\n     * has one).\r\n     *\r\n     * @param spawnTile -\r\n     */\r\n    reset(spawnTile) {\r\n        (0,tslib__WEBPACK_IMPORTED_MODULE_3__.__classPrivateFieldSet)(this, _hostTile, spawnTile);\r\n        this.hostTile._setOccupant(this.playerId, this.status.immigrantInfo);\r\n    }\r\n    get coord() {\r\n        return this.hostTile.coord;\r\n    }\r\n    get hostTile() {\r\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_3__.__classPrivateFieldGet)(this, _hostTile);\r\n    }\r\n    /**\r\n     * Evicts this `Player` from its last known position (which may be\r\n     * lagging behind the state of the master copy of the game.\r\n     *\r\n     * This must be called after all same-event changes pertaining to\r\n     * this player's fields have been enacted.\r\n     *\r\n     * @param dest -\r\n     */\r\n    moveTo(dest) {\r\n        // Evict self from current `Tile`.\r\n        if (this.hostTile.occupantId !== this.playerId) {\r\n            if (this.game.gameType !== \"ONLINE\" /* ONLINE */) {\r\n                // Should never happen.\r\n                throw new Error(\"Linkage between player and occupied tile disagrees.\");\r\n            }\r\n            /* Otherwise, this corner case is guaranteed to follow the events\r\n            described in the below comment: at this `OnlineGame`, `p2` will\r\n            move off of the `Tile` currently occupied by this `Player`. */\r\n        }\r\n        else {\r\n            // Move off of current host `Tile`:\r\n            this.hostTile.evictOccupant();\r\n        }\r\n        // Occupy the destination `Tile.\r\n        if (dest.isOccupied) {\r\n            if (this.game.gameType !== \"ONLINE\" /* ONLINE */) {\r\n                // Should never happen because the Game Manager\r\n                // rejects requests to move onto an occupied `Tile`.\r\n                throw new Error(\"Only one player can occupy a tile at a time.\");\r\n            }\r\n            /* Otherwise, this is actually possible in a variant of the _DAS_\r\n            where another `Player` `p2` moves to `B`, I receive that update,\r\n            then `p2` makes a request to move to `C`, which the Game Manager\r\n            accepts and begins to notify my `OnlineGame` of, but between the\r\n            time that the GM accepts the request and when I receive the update,\r\n            I make a request to move to `B`, which gets accepted by the GM,\r\n            and because I might not be using websockets as my underlying\r\n            transport, I receive the update for my own request first, which\r\n            would appear to my `OnlineGame` as if I was moving onto the `Tile`\r\n            occupied by `p2`. */\r\n        }\r\n        else {\r\n            // Move to occupy the destination `Tile`:\r\n            (0,tslib__WEBPACK_IMPORTED_MODULE_3__.__classPrivateFieldSet)(this, _hostTile, dest);\r\n            dest._setOccupant(this.playerId, this.status.immigrantInfo);\r\n        }\r\n    }\r\n}\r\n_hostTile = new WeakMap();\r\n(function (PlayerSkeleton) {\r\n    var _player, _superTileSrc;\r\n    /**\r\n     */\r\n    class TileGetterSource {\r\n        constructor(player) {\r\n            _player.set(this, void 0);\r\n            _superTileSrc.set(this, void 0);\r\n            (0,tslib__WEBPACK_IMPORTED_MODULE_3__.__classPrivateFieldSet)(this, _player, player);\r\n            (0,tslib__WEBPACK_IMPORTED_MODULE_3__.__classPrivateFieldSet)(this, _superTileSrc, player.game.grid.tile._source);\r\n        }\r\n        _getTileAt() {\r\n            return (0,tslib__WEBPACK_IMPORTED_MODULE_3__.__classPrivateFieldGet)(this, _superTileSrc)._getTileAt((0,tslib__WEBPACK_IMPORTED_MODULE_3__.__classPrivateFieldGet)(this, _player).coord);\r\n        }\r\n        _getTileDestsFrom() {\r\n            return (0,tslib__WEBPACK_IMPORTED_MODULE_3__.__classPrivateFieldGet)(this, _superTileSrc)._getTileDestsFrom((0,tslib__WEBPACK_IMPORTED_MODULE_3__.__classPrivateFieldGet)(this, _player).coord);\r\n        }\r\n        _getTileSourcesTo() {\r\n            return (0,tslib__WEBPACK_IMPORTED_MODULE_3__.__classPrivateFieldGet)(this, _superTileSrc)._getTileSourcesTo((0,tslib__WEBPACK_IMPORTED_MODULE_3__.__classPrivateFieldGet)(this, _player).coord);\r\n        }\r\n    }\r\n    _player = new WeakMap(), _superTileSrc = new WeakMap();\r\n    PlayerSkeleton.TileGetterSource = TileGetterSource;\r\n    Object.freeze(TileGetterSource);\r\n    Object.freeze(TileGetterSource.prototype);\r\n})(PlayerSkeleton || (PlayerSkeleton = {}));\r\ndefs_JsUtils__WEBPACK_IMPORTED_MODULE_0__.JsUtils.protoNoEnum(PlayerSkeleton, [\"_afterAllPlayersConstruction\"]);\r\nObject.freeze(PlayerSkeleton);\r\nObject.freeze(PlayerSkeleton.prototype);\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvYmFzZS9nYW1lL3BsYXllci9QbGF5ZXJTa2VsZXRvbi50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovL3NuYWtleTMvLi9zcmMvYmFzZS9nYW1lL3BsYXllci9QbGF5ZXJTa2VsZXRvbi50cz8zZGViIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBfaG9zdFRpbGU7XHJcbmltcG9ydCB7IF9fY2xhc3NQcml2YXRlRmllbGRHZXQsIF9fY2xhc3NQcml2YXRlRmllbGRTZXQgfSBmcm9tIFwidHNsaWJcIjtcclxuaW1wb3J0IHsgSnNVdGlscyB9IGZyb20gXCJkZWZzL0pzVXRpbHNcIjtcclxuaW1wb3J0IHsgUGxheWVyIGFzIF9QbGF5ZXIgfSBmcm9tIFwiZGVmcy9UeXBlRGVmc1wiO1xyXG5pbXBvcnQgeyBUaWxlR2V0dGVyIH0gZnJvbSBcImZsb29yL1RpbGVHZXR0ZXJcIjtcclxuLyoqXHJcbiAqIE1hZGUgdG8gYWJzdHJhY3QgYWxsIG9wZXJhdGlvbnMgdGhhdCBjaGFuZ2UgdGhlIGBob3N0VGlsZWBcclxuICogZmllbGQuIEVuZm9yY2VzIC8gZXhwb3NlcyB0aGUgYG1vdmVUb2AgbWV0aG9kIGFzXHJcbiAqIHRoZSBpbnRlcmZhY2UgdG8gYW55IHN1Y2ggb3BlcmF0aW9ucy5cclxuICpcclxuICogQGV4dGVuZHMgUGxheWVyIHRvIGludGFrZSBpdHMgbmFtZXNwYWNlIGV4cG9ydHMuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgUGxheWVyU2tlbGV0b24gZXh0ZW5kcyBfUGxheWVyIHtcclxuICAgIGNvbnN0cnVjdG9yKGdhbWUsIGRlc2MpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgICAgIF9ob3N0VGlsZS5zZXQodGhpcywgdm9pZCAwKTtcclxuICAgICAgICBpZiAoTWF0aC50cnVuYyhkZXNjLnBsYXllcklkKSAhPT0gZGVzYy5wbGF5ZXJJZCkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcihcIlBsYXllciBJRCdzIG11c3QgYmUgaW50ZWdlciB2YWx1ZXMuXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnBsYXllcklkID0gZGVzYy5wbGF5ZXJJZDtcclxuICAgICAgICB0aGlzLmlzQUxvY2FsT3BlcmF0b3IgPSBkZXNjLmlzQUxvY2FsT3BlcmF0b3I7XHJcbiAgICAgICAgdGhpcy5nYW1lID0gZ2FtZTtcclxuICAgICAgICB0aGlzLnN0YXR1cyA9IG5ldyAodGhpcy5nYW1lLl9wbGF5ZXJTdGF0dXNDdG9yKSh0aGlzLCBkZXNjLm5vQ2hlY2tHYW1lT3Zlcik7XHJcbiAgICAgICAgdGhpcy50aWxlID0gbmV3IFRpbGVHZXR0ZXIobmV3IFBsYXllclNrZWxldG9uLlRpbGVHZXR0ZXJTb3VyY2UodGhpcykpO1xyXG4gICAgICAgIEpzVXRpbHMuaW5zdE5vRW51bSh0aGlzLCBbXCJnYW1lXCJdKTtcclxuICAgICAgICBKc1V0aWxzLnByb3BOb1dyaXRlKHRoaXMsIFtcclxuICAgICAgICAgICAgXCJwbGF5ZXJJZFwiLCBcImlzQUxvY2FsT3BlcmF0b3JcIixcclxuICAgICAgICAgICAgXCJnYW1lXCIsIFwic3RhdHVzXCIsIFwidGlsZVwiLFxyXG4gICAgICAgIF0pO1xyXG4gICAgfVxyXG4gICAgX2FmdGVyQWxsUGxheWVyc0NvbnN0cnVjdGlvbigpIHtcclxuICAgICAgICB0aGlzLnN0YXR1cy5fYWZ0ZXJBbGxQbGF5ZXJzQ29uc3RydWN0aW9uKCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIE11c3QgYmUgY2FsbGVkIF9hZnRlcl8gdGhlIHtAbGluayBHcmlkfSBoYXMgYmVlbiByZXNldC5cclxuICAgICAqIERvZXMgbm90IGV2aWN0IGl0c2VsZiBmcm9tIGl0cyBjdXJyZW50IGhvc3QgdGlsZSAoaWYgaXRcclxuICAgICAqIGhhcyBvbmUpLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBzcGF3blRpbGUgLVxyXG4gICAgICovXHJcbiAgICByZXNldChzcGF3blRpbGUpIHtcclxuICAgICAgICBfX2NsYXNzUHJpdmF0ZUZpZWxkU2V0KHRoaXMsIF9ob3N0VGlsZSwgc3Bhd25UaWxlKTtcclxuICAgICAgICB0aGlzLmhvc3RUaWxlLl9zZXRPY2N1cGFudCh0aGlzLnBsYXllcklkLCB0aGlzLnN0YXR1cy5pbW1pZ3JhbnRJbmZvKTtcclxuICAgIH1cclxuICAgIGdldCBjb29yZCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5ob3N0VGlsZS5jb29yZDtcclxuICAgIH1cclxuICAgIGdldCBob3N0VGlsZSgpIHtcclxuICAgICAgICByZXR1cm4gX19jbGFzc1ByaXZhdGVGaWVsZEdldCh0aGlzLCBfaG9zdFRpbGUpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBFdmljdHMgdGhpcyBgUGxheWVyYCBmcm9tIGl0cyBsYXN0IGtub3duIHBvc2l0aW9uICh3aGljaCBtYXkgYmVcclxuICAgICAqIGxhZ2dpbmcgYmVoaW5kIHRoZSBzdGF0ZSBvZiB0aGUgbWFzdGVyIGNvcHkgb2YgdGhlIGdhbWUuXHJcbiAgICAgKlxyXG4gICAgICogVGhpcyBtdXN0IGJlIGNhbGxlZCBhZnRlciBhbGwgc2FtZS1ldmVudCBjaGFuZ2VzIHBlcnRhaW5pbmcgdG9cclxuICAgICAqIHRoaXMgcGxheWVyJ3MgZmllbGRzIGhhdmUgYmVlbiBlbmFjdGVkLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBkZXN0IC1cclxuICAgICAqL1xyXG4gICAgbW92ZVRvKGRlc3QpIHtcclxuICAgICAgICAvLyBFdmljdCBzZWxmIGZyb20gY3VycmVudCBgVGlsZWAuXHJcbiAgICAgICAgaWYgKHRoaXMuaG9zdFRpbGUub2NjdXBhbnRJZCAhPT0gdGhpcy5wbGF5ZXJJZCkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5nYW1lLmdhbWVUeXBlICE9PSBcIk9OTElORVwiIC8qIE9OTElORSAqLykge1xyXG4gICAgICAgICAgICAgICAgLy8gU2hvdWxkIG5ldmVyIGhhcHBlbi5cclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkxpbmthZ2UgYmV0d2VlbiBwbGF5ZXIgYW5kIG9jY3VwaWVkIHRpbGUgZGlzYWdyZWVzLlwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvKiBPdGhlcndpc2UsIHRoaXMgY29ybmVyIGNhc2UgaXMgZ3VhcmFudGVlZCB0byBmb2xsb3cgdGhlIGV2ZW50c1xyXG4gICAgICAgICAgICBkZXNjcmliZWQgaW4gdGhlIGJlbG93IGNvbW1lbnQ6IGF0IHRoaXMgYE9ubGluZUdhbWVgLCBgcDJgIHdpbGxcclxuICAgICAgICAgICAgbW92ZSBvZmYgb2YgdGhlIGBUaWxlYCBjdXJyZW50bHkgb2NjdXBpZWQgYnkgdGhpcyBgUGxheWVyYC4gKi9cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIE1vdmUgb2ZmIG9mIGN1cnJlbnQgaG9zdCBgVGlsZWA6XHJcbiAgICAgICAgICAgIHRoaXMuaG9zdFRpbGUuZXZpY3RPY2N1cGFudCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBPY2N1cHkgdGhlIGRlc3RpbmF0aW9uIGBUaWxlLlxyXG4gICAgICAgIGlmIChkZXN0LmlzT2NjdXBpZWQpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZ2FtZS5nYW1lVHlwZSAhPT0gXCJPTkxJTkVcIiAvKiBPTkxJTkUgKi8pIHtcclxuICAgICAgICAgICAgICAgIC8vIFNob3VsZCBuZXZlciBoYXBwZW4gYmVjYXVzZSB0aGUgR2FtZSBNYW5hZ2VyXHJcbiAgICAgICAgICAgICAgICAvLyByZWplY3RzIHJlcXVlc3RzIHRvIG1vdmUgb250byBhbiBvY2N1cGllZCBgVGlsZWAuXHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJPbmx5IG9uZSBwbGF5ZXIgY2FuIG9jY3VweSBhIHRpbGUgYXQgYSB0aW1lLlwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvKiBPdGhlcndpc2UsIHRoaXMgaXMgYWN0dWFsbHkgcG9zc2libGUgaW4gYSB2YXJpYW50IG9mIHRoZSBfREFTX1xyXG4gICAgICAgICAgICB3aGVyZSBhbm90aGVyIGBQbGF5ZXJgIGBwMmAgbW92ZXMgdG8gYEJgLCBJIHJlY2VpdmUgdGhhdCB1cGRhdGUsXHJcbiAgICAgICAgICAgIHRoZW4gYHAyYCBtYWtlcyBhIHJlcXVlc3QgdG8gbW92ZSB0byBgQ2AsIHdoaWNoIHRoZSBHYW1lIE1hbmFnZXJcclxuICAgICAgICAgICAgYWNjZXB0cyBhbmQgYmVnaW5zIHRvIG5vdGlmeSBteSBgT25saW5lR2FtZWAgb2YsIGJ1dCBiZXR3ZWVuIHRoZVxyXG4gICAgICAgICAgICB0aW1lIHRoYXQgdGhlIEdNIGFjY2VwdHMgdGhlIHJlcXVlc3QgYW5kIHdoZW4gSSByZWNlaXZlIHRoZSB1cGRhdGUsXHJcbiAgICAgICAgICAgIEkgbWFrZSBhIHJlcXVlc3QgdG8gbW92ZSB0byBgQmAsIHdoaWNoIGdldHMgYWNjZXB0ZWQgYnkgdGhlIEdNLFxyXG4gICAgICAgICAgICBhbmQgYmVjYXVzZSBJIG1pZ2h0IG5vdCBiZSB1c2luZyB3ZWJzb2NrZXRzIGFzIG15IHVuZGVybHlpbmdcclxuICAgICAgICAgICAgdHJhbnNwb3J0LCBJIHJlY2VpdmUgdGhlIHVwZGF0ZSBmb3IgbXkgb3duIHJlcXVlc3QgZmlyc3QsIHdoaWNoXHJcbiAgICAgICAgICAgIHdvdWxkIGFwcGVhciB0byBteSBgT25saW5lR2FtZWAgYXMgaWYgSSB3YXMgbW92aW5nIG9udG8gdGhlIGBUaWxlYFxyXG4gICAgICAgICAgICBvY2N1cGllZCBieSBgcDJgLiAqL1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8gTW92ZSB0byBvY2N1cHkgdGhlIGRlc3RpbmF0aW9uIGBUaWxlYDpcclxuICAgICAgICAgICAgX19jbGFzc1ByaXZhdGVGaWVsZFNldCh0aGlzLCBfaG9zdFRpbGUsIGRlc3QpO1xyXG4gICAgICAgICAgICBkZXN0Ll9zZXRPY2N1cGFudCh0aGlzLnBsYXllcklkLCB0aGlzLnN0YXR1cy5pbW1pZ3JhbnRJbmZvKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuX2hvc3RUaWxlID0gbmV3IFdlYWtNYXAoKTtcclxuKGZ1bmN0aW9uIChQbGF5ZXJTa2VsZXRvbikge1xyXG4gICAgdmFyIF9wbGF5ZXIsIF9zdXBlclRpbGVTcmM7XHJcbiAgICAvKipcclxuICAgICAqL1xyXG4gICAgY2xhc3MgVGlsZUdldHRlclNvdXJjZSB7XHJcbiAgICAgICAgY29uc3RydWN0b3IocGxheWVyKSB7XHJcbiAgICAgICAgICAgIF9wbGF5ZXIuc2V0KHRoaXMsIHZvaWQgMCk7XHJcbiAgICAgICAgICAgIF9zdXBlclRpbGVTcmMuc2V0KHRoaXMsIHZvaWQgMCk7XHJcbiAgICAgICAgICAgIF9fY2xhc3NQcml2YXRlRmllbGRTZXQodGhpcywgX3BsYXllciwgcGxheWVyKTtcclxuICAgICAgICAgICAgX19jbGFzc1ByaXZhdGVGaWVsZFNldCh0aGlzLCBfc3VwZXJUaWxlU3JjLCBwbGF5ZXIuZ2FtZS5ncmlkLnRpbGUuX3NvdXJjZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIF9nZXRUaWxlQXQoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHRoaXMsIF9zdXBlclRpbGVTcmMpLl9nZXRUaWxlQXQoX19jbGFzc1ByaXZhdGVGaWVsZEdldCh0aGlzLCBfcGxheWVyKS5jb29yZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIF9nZXRUaWxlRGVzdHNGcm9tKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gX19jbGFzc1ByaXZhdGVGaWVsZEdldCh0aGlzLCBfc3VwZXJUaWxlU3JjKS5fZ2V0VGlsZURlc3RzRnJvbShfX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHRoaXMsIF9wbGF5ZXIpLmNvb3JkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgX2dldFRpbGVTb3VyY2VzVG8oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHRoaXMsIF9zdXBlclRpbGVTcmMpLl9nZXRUaWxlU291cmNlc1RvKF9fY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX3BsYXllcikuY29vcmQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIF9wbGF5ZXIgPSBuZXcgV2Vha01hcCgpLCBfc3VwZXJUaWxlU3JjID0gbmV3IFdlYWtNYXAoKTtcclxuICAgIFBsYXllclNrZWxldG9uLlRpbGVHZXR0ZXJTb3VyY2UgPSBUaWxlR2V0dGVyU291cmNlO1xyXG4gICAgT2JqZWN0LmZyZWV6ZShUaWxlR2V0dGVyU291cmNlKTtcclxuICAgIE9iamVjdC5mcmVlemUoVGlsZUdldHRlclNvdXJjZS5wcm90b3R5cGUpO1xyXG59KShQbGF5ZXJTa2VsZXRvbiB8fCAoUGxheWVyU2tlbGV0b24gPSB7fSkpO1xyXG5Kc1V0aWxzLnByb3RvTm9FbnVtKFBsYXllclNrZWxldG9uLCBbXCJfYWZ0ZXJBbGxQbGF5ZXJzQ29uc3RydWN0aW9uXCJdKTtcclxuT2JqZWN0LmZyZWV6ZShQbGF5ZXJTa2VsZXRvbik7XHJcbk9iamVjdC5mcmVlemUoUGxheWVyU2tlbGV0b24ucHJvdG90eXBlKTtcclxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/base/game/player/PlayerSkeleton.ts\n");

/***/ }),

/***/ "./src/base/game/player/PlayerStatus.ts":
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"PlayerStatus\": () => /* binding */ PlayerStatus\n/* harmony export */ });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"./node_modules/tslib/tslib.es6.js\");\n/* harmony import */ var defs_JsUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./src/base/defs/JsUtils.ts\");\n/* harmony import */ var game_player_Team__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"./src/base/game/player/Team.ts\");\nvar _health;\r\n\r\n\r\n\r\n/**\r\n * This abstracts acts of modification upon a player's state, allowing\r\n * extension classes to override setters to perform additional tasks\r\n * such as visually rendering updates to this state information in a\r\n * web browser, and playing sound effects.\r\n */\r\nclass PlayerStatus {\r\n    constructor(player, noCheckGameOver) {\r\n        _health.set(this, void 0);\r\n        this.player = player;\r\n        this.noCheckGameOver = noCheckGameOver;\r\n        defs_JsUtils__WEBPACK_IMPORTED_MODULE_0__.JsUtils.instNoEnum(this, [\"player\"]);\r\n    }\r\n    reset() {\r\n        this.health = 0;\r\n    }\r\n    _afterAllPlayersConstruction() { }\r\n    get immigrantInfo() {\r\n        return undefined;\r\n    }\r\n    get health() {\r\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_2__.__classPrivateFieldGet)(this, _health);\r\n    }\r\n    set health(newHealth) {\r\n        const oldIsDowned = this.isDowned;\r\n        (0,tslib__WEBPACK_IMPORTED_MODULE_2__.__classPrivateFieldSet)(this, _health, newHealth);\r\n        if (oldIsDowned || !this.isDowned || this.noCheckGameOver)\r\n            return;\r\n        const team = this.player.team;\r\n        const teams = this.player.game.teams;\r\n        if (team.elimOrder === game_player_Team__WEBPACK_IMPORTED_MODULE_1__.Team.ElimOrder.STANDING) {\r\n            // Right before this downing event, the team has not been\r\n            // soft-eliminated yet, but it might be now. Check it:\r\n            if (team.members.every((player) => {\r\n                return player.status.noCheckGameOver || player.status.isDowned;\r\n            })) {\r\n                // All players are downed! The team is now eliminated:\r\n                const numNonStandingTeams = 1 + teams.filter((team) => {\r\n                    return team.elimOrder !== game_player_Team__WEBPACK_IMPORTED_MODULE_1__.Team.ElimOrder.STANDING;\r\n                }).length;\r\n                team.elimOrder\r\n                    = 1 + teams.filter((team) => {\r\n                        return team.elimOrder !== game_player_Team__WEBPACK_IMPORTED_MODULE_1__.Team.ElimOrder.STANDING\r\n                            && team.elimOrder !== game_player_Team__WEBPACK_IMPORTED_MODULE_1__.Team.ElimOrder.IMMORTAL;\r\n                    }).length;\r\n                // Now that a team is newly-eliminated, check if the\r\n                // game should end:\r\n                if (numNonStandingTeams === teams.length) {\r\n                    this.player.game.statusBecomeOver();\r\n                }\r\n            }\r\n        }\r\n    }\r\n    get isDowned() {\r\n        return this.health < 0.0;\r\n    }\r\n}\r\n_health = new WeakMap();\r\ndefs_JsUtils__WEBPACK_IMPORTED_MODULE_0__.JsUtils.protoNoEnum(PlayerStatus, [\"_afterAllPlayersConstruction\"]);\r\nObject.freeze(PlayerStatus);\r\nObject.freeze(PlayerStatus.prototype);\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvYmFzZS9nYW1lL3BsYXllci9QbGF5ZXJTdGF0dXMudHMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zbmFrZXkzLy4vc3JjL2Jhc2UvZ2FtZS9wbGF5ZXIvUGxheWVyU3RhdHVzLnRzP2VlODUiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIF9oZWFsdGg7XHJcbmltcG9ydCB7IF9fY2xhc3NQcml2YXRlRmllbGRHZXQsIF9fY2xhc3NQcml2YXRlRmllbGRTZXQgfSBmcm9tIFwidHNsaWJcIjtcclxuaW1wb3J0IHsgSnNVdGlscyB9IGZyb20gXCJkZWZzL0pzVXRpbHNcIjtcclxuaW1wb3J0IHsgVGVhbSB9IGZyb20gXCJnYW1lL3BsYXllci9UZWFtXCI7XHJcbi8qKlxyXG4gKiBUaGlzIGFic3RyYWN0cyBhY3RzIG9mIG1vZGlmaWNhdGlvbiB1cG9uIGEgcGxheWVyJ3Mgc3RhdGUsIGFsbG93aW5nXHJcbiAqIGV4dGVuc2lvbiBjbGFzc2VzIHRvIG92ZXJyaWRlIHNldHRlcnMgdG8gcGVyZm9ybSBhZGRpdGlvbmFsIHRhc2tzXHJcbiAqIHN1Y2ggYXMgdmlzdWFsbHkgcmVuZGVyaW5nIHVwZGF0ZXMgdG8gdGhpcyBzdGF0ZSBpbmZvcm1hdGlvbiBpbiBhXHJcbiAqIHdlYiBicm93c2VyLCBhbmQgcGxheWluZyBzb3VuZCBlZmZlY3RzLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFBsYXllclN0YXR1cyB7XHJcbiAgICBjb25zdHJ1Y3RvcihwbGF5ZXIsIG5vQ2hlY2tHYW1lT3Zlcikge1xyXG4gICAgICAgIF9oZWFsdGguc2V0KHRoaXMsIHZvaWQgMCk7XHJcbiAgICAgICAgdGhpcy5wbGF5ZXIgPSBwbGF5ZXI7XHJcbiAgICAgICAgdGhpcy5ub0NoZWNrR2FtZU92ZXIgPSBub0NoZWNrR2FtZU92ZXI7XHJcbiAgICAgICAgSnNVdGlscy5pbnN0Tm9FbnVtKHRoaXMsIFtcInBsYXllclwiXSk7XHJcbiAgICB9XHJcbiAgICByZXNldCgpIHtcclxuICAgICAgICB0aGlzLmhlYWx0aCA9IDA7XHJcbiAgICB9XHJcbiAgICBfYWZ0ZXJBbGxQbGF5ZXJzQ29uc3RydWN0aW9uKCkgeyB9XHJcbiAgICBnZXQgaW1taWdyYW50SW5mbygpIHtcclxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgfVxyXG4gICAgZ2V0IGhlYWx0aCgpIHtcclxuICAgICAgICByZXR1cm4gX19jbGFzc1ByaXZhdGVGaWVsZEdldCh0aGlzLCBfaGVhbHRoKTtcclxuICAgIH1cclxuICAgIHNldCBoZWFsdGgobmV3SGVhbHRoKSB7XHJcbiAgICAgICAgY29uc3Qgb2xkSXNEb3duZWQgPSB0aGlzLmlzRG93bmVkO1xyXG4gICAgICAgIF9fY2xhc3NQcml2YXRlRmllbGRTZXQodGhpcywgX2hlYWx0aCwgbmV3SGVhbHRoKTtcclxuICAgICAgICBpZiAob2xkSXNEb3duZWQgfHwgIXRoaXMuaXNEb3duZWQgfHwgdGhpcy5ub0NoZWNrR2FtZU92ZXIpXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICBjb25zdCB0ZWFtID0gdGhpcy5wbGF5ZXIudGVhbTtcclxuICAgICAgICBjb25zdCB0ZWFtcyA9IHRoaXMucGxheWVyLmdhbWUudGVhbXM7XHJcbiAgICAgICAgaWYgKHRlYW0uZWxpbU9yZGVyID09PSBUZWFtLkVsaW1PcmRlci5TVEFORElORykge1xyXG4gICAgICAgICAgICAvLyBSaWdodCBiZWZvcmUgdGhpcyBkb3duaW5nIGV2ZW50LCB0aGUgdGVhbSBoYXMgbm90IGJlZW5cclxuICAgICAgICAgICAgLy8gc29mdC1lbGltaW5hdGVkIHlldCwgYnV0IGl0IG1pZ2h0IGJlIG5vdy4gQ2hlY2sgaXQ6XHJcbiAgICAgICAgICAgIGlmICh0ZWFtLm1lbWJlcnMuZXZlcnkoKHBsYXllcikgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHBsYXllci5zdGF0dXMubm9DaGVja0dhbWVPdmVyIHx8IHBsYXllci5zdGF0dXMuaXNEb3duZWQ7XHJcbiAgICAgICAgICAgIH0pKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBBbGwgcGxheWVycyBhcmUgZG93bmVkISBUaGUgdGVhbSBpcyBub3cgZWxpbWluYXRlZDpcclxuICAgICAgICAgICAgICAgIGNvbnN0IG51bU5vblN0YW5kaW5nVGVhbXMgPSAxICsgdGVhbXMuZmlsdGVyKCh0ZWFtKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRlYW0uZWxpbU9yZGVyICE9PSBUZWFtLkVsaW1PcmRlci5TVEFORElORztcclxuICAgICAgICAgICAgICAgIH0pLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgIHRlYW0uZWxpbU9yZGVyXHJcbiAgICAgICAgICAgICAgICAgICAgPSAxICsgdGVhbXMuZmlsdGVyKCh0ZWFtKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0ZWFtLmVsaW1PcmRlciAhPT0gVGVhbS5FbGltT3JkZXIuU1RBTkRJTkdcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICYmIHRlYW0uZWxpbU9yZGVyICE9PSBUZWFtLkVsaW1PcmRlci5JTU1PUlRBTDtcclxuICAgICAgICAgICAgICAgICAgICB9KS5sZW5ndGg7XHJcbiAgICAgICAgICAgICAgICAvLyBOb3cgdGhhdCBhIHRlYW0gaXMgbmV3bHktZWxpbWluYXRlZCwgY2hlY2sgaWYgdGhlXHJcbiAgICAgICAgICAgICAgICAvLyBnYW1lIHNob3VsZCBlbmQ6XHJcbiAgICAgICAgICAgICAgICBpZiAobnVtTm9uU3RhbmRpbmdUZWFtcyA9PT0gdGVhbXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbGF5ZXIuZ2FtZS5zdGF0dXNCZWNvbWVPdmVyKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBnZXQgaXNEb3duZWQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaGVhbHRoIDwgMC4wO1xyXG4gICAgfVxyXG59XHJcbl9oZWFsdGggPSBuZXcgV2Vha01hcCgpO1xyXG5Kc1V0aWxzLnByb3RvTm9FbnVtKFBsYXllclN0YXR1cywgW1wiX2FmdGVyQWxsUGxheWVyc0NvbnN0cnVjdGlvblwiXSk7XHJcbk9iamVjdC5mcmVlemUoUGxheWVyU3RhdHVzKTtcclxuT2JqZWN0LmZyZWV6ZShQbGF5ZXJTdGF0dXMucHJvdG90eXBlKTtcclxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/base/game/player/PlayerStatus.ts\n");

/***/ }),

/***/ "./src/base/game/player/Team.ts":
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"Team\": () => /* binding */ Team\n/* harmony export */ });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"./node_modules/tslib/tslib.es6.js\");\n/* harmony import */ var defs_JsUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./src/base/defs/JsUtils.ts\");\nvar _elimOrder;\r\n\r\n\r\n/**\r\n *\r\n */\r\nclass Team {\r\n    constructor(teamId, members) {\r\n        _elimOrder.set(this, void 0);\r\n        if (members.length === 0) {\r\n            throw new Error(\"Teams must have at least one member.\");\r\n        }\r\n        this.id = teamId;\r\n        this.members = members; // If paranoid, do a shallow copy.\r\n        (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__classPrivateFieldSet)(// If paranoid, do a shallow copy.\r\n        this, _elimOrder, (this.members.every((member) => member.status.noCheckGameOver))\r\n            ? Team.ElimOrder.IMMORTAL\r\n            : Team.ElimOrder.STANDING);\r\n        defs_JsUtils__WEBPACK_IMPORTED_MODULE_0__.JsUtils.propNoWrite(this, [\"id\", \"members\"]);\r\n    }\r\n    reset() {\r\n        if (this.elimOrder !== Team.ElimOrder.IMMORTAL) {\r\n            this.elimOrder = Team.ElimOrder.STANDING;\r\n        }\r\n    }\r\n    /**\r\n     * @returns\r\n     * Indicates the order (relative to other teams) in which this\r\n     * team was to have all its members downed at the same time at\r\n     * least once. Once a team is soft-eliminated, they can continue\r\n     * playing as normal, but there is no going back. The game ends\r\n     * when all teams but one have been soft-eliminated.\r\n     *\r\n     * ### Semantics\r\n     *\r\n     * A comparatively smaller value denotes having been soft-\r\n     * eliminated at an earlier point in the game. **The value zero\r\n     * denotes _not-having-been-soft-eliminated-yet_**.\r\n     */\r\n    get elimOrder() {\r\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__classPrivateFieldGet)(this, _elimOrder);\r\n    }\r\n    set elimOrder(teamElimOrder) {\r\n        if (this.elimOrder === Team.ElimOrder.IMMORTAL) {\r\n            throw new TypeError(\"Cannot change the elimination status of an immortal team.\");\r\n        }\r\n        (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__classPrivateFieldSet)(this, _elimOrder, teamElimOrder);\r\n    }\r\n}\r\n_elimOrder = new WeakMap();\r\n(function (Team) {\r\n    // Special values:\r\n    let ElimOrder;\r\n    (function (ElimOrder) {\r\n        /**\r\n         * A team starts off with such a value if all its players have\r\n         * specified that their downing should not cause a check for\r\n         * whether the game should end.\r\n         */\r\n        ElimOrder.IMMORTAL = -1;\r\n        /**\r\n         * A team that is not invincible starts off with such a value.\r\n         */\r\n        ElimOrder.STANDING = 0;\r\n    })(ElimOrder = Team.ElimOrder || (Team.ElimOrder = {}));\r\n})(Team || (Team = {}));\r\nObject.freeze(Team);\r\nObject.freeze(Team.prototype);\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvYmFzZS9nYW1lL3BsYXllci9UZWFtLnRzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc25ha2V5My8uL3NyYy9iYXNlL2dhbWUvcGxheWVyL1RlYW0udHM/MjYxNSJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX2VsaW1PcmRlcjtcclxuaW1wb3J0IHsgX19jbGFzc1ByaXZhdGVGaWVsZEdldCwgX19jbGFzc1ByaXZhdGVGaWVsZFNldCB9IGZyb20gXCJ0c2xpYlwiO1xyXG5pbXBvcnQgeyBKc1V0aWxzIH0gZnJvbSBcImRlZnMvSnNVdGlsc1wiO1xyXG4vKipcclxuICpcclxuICovXHJcbmV4cG9ydCBjbGFzcyBUZWFtIHtcclxuICAgIGNvbnN0cnVjdG9yKHRlYW1JZCwgbWVtYmVycykge1xyXG4gICAgICAgIF9lbGltT3JkZXIuc2V0KHRoaXMsIHZvaWQgMCk7XHJcbiAgICAgICAgaWYgKG1lbWJlcnMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRlYW1zIG11c3QgaGF2ZSBhdCBsZWFzdCBvbmUgbWVtYmVyLlwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5pZCA9IHRlYW1JZDtcclxuICAgICAgICB0aGlzLm1lbWJlcnMgPSBtZW1iZXJzOyAvLyBJZiBwYXJhbm9pZCwgZG8gYSBzaGFsbG93IGNvcHkuXHJcbiAgICAgICAgX19jbGFzc1ByaXZhdGVGaWVsZFNldCgvLyBJZiBwYXJhbm9pZCwgZG8gYSBzaGFsbG93IGNvcHkuXHJcbiAgICAgICAgdGhpcywgX2VsaW1PcmRlciwgKHRoaXMubWVtYmVycy5ldmVyeSgobWVtYmVyKSA9PiBtZW1iZXIuc3RhdHVzLm5vQ2hlY2tHYW1lT3ZlcikpXHJcbiAgICAgICAgICAgID8gVGVhbS5FbGltT3JkZXIuSU1NT1JUQUxcclxuICAgICAgICAgICAgOiBUZWFtLkVsaW1PcmRlci5TVEFORElORyk7XHJcbiAgICAgICAgSnNVdGlscy5wcm9wTm9Xcml0ZSh0aGlzLCBbXCJpZFwiLCBcIm1lbWJlcnNcIl0pO1xyXG4gICAgfVxyXG4gICAgcmVzZXQoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZWxpbU9yZGVyICE9PSBUZWFtLkVsaW1PcmRlci5JTU1PUlRBTCkge1xyXG4gICAgICAgICAgICB0aGlzLmVsaW1PcmRlciA9IFRlYW0uRWxpbU9yZGVyLlNUQU5ESU5HO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQHJldHVybnNcclxuICAgICAqIEluZGljYXRlcyB0aGUgb3JkZXIgKHJlbGF0aXZlIHRvIG90aGVyIHRlYW1zKSBpbiB3aGljaCB0aGlzXHJcbiAgICAgKiB0ZWFtIHdhcyB0byBoYXZlIGFsbCBpdHMgbWVtYmVycyBkb3duZWQgYXQgdGhlIHNhbWUgdGltZSBhdFxyXG4gICAgICogbGVhc3Qgb25jZS4gT25jZSBhIHRlYW0gaXMgc29mdC1lbGltaW5hdGVkLCB0aGV5IGNhbiBjb250aW51ZVxyXG4gICAgICogcGxheWluZyBhcyBub3JtYWwsIGJ1dCB0aGVyZSBpcyBubyBnb2luZyBiYWNrLiBUaGUgZ2FtZSBlbmRzXHJcbiAgICAgKiB3aGVuIGFsbCB0ZWFtcyBidXQgb25lIGhhdmUgYmVlbiBzb2Z0LWVsaW1pbmF0ZWQuXHJcbiAgICAgKlxyXG4gICAgICogIyMjIFNlbWFudGljc1xyXG4gICAgICpcclxuICAgICAqIEEgY29tcGFyYXRpdmVseSBzbWFsbGVyIHZhbHVlIGRlbm90ZXMgaGF2aW5nIGJlZW4gc29mdC1cclxuICAgICAqIGVsaW1pbmF0ZWQgYXQgYW4gZWFybGllciBwb2ludCBpbiB0aGUgZ2FtZS4gKipUaGUgdmFsdWUgemVyb1xyXG4gICAgICogZGVub3RlcyBfbm90LWhhdmluZy1iZWVuLXNvZnQtZWxpbWluYXRlZC15ZXRfKiouXHJcbiAgICAgKi9cclxuICAgIGdldCBlbGltT3JkZXIoKSB7XHJcbiAgICAgICAgcmV0dXJuIF9fY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX2VsaW1PcmRlcik7XHJcbiAgICB9XHJcbiAgICBzZXQgZWxpbU9yZGVyKHRlYW1FbGltT3JkZXIpIHtcclxuICAgICAgICBpZiAodGhpcy5lbGltT3JkZXIgPT09IFRlYW0uRWxpbU9yZGVyLklNTU9SVEFMKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2hhbmdlIHRoZSBlbGltaW5hdGlvbiBzdGF0dXMgb2YgYW4gaW1tb3J0YWwgdGVhbS5cIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIF9fY2xhc3NQcml2YXRlRmllbGRTZXQodGhpcywgX2VsaW1PcmRlciwgdGVhbUVsaW1PcmRlcik7XHJcbiAgICB9XHJcbn1cclxuX2VsaW1PcmRlciA9IG5ldyBXZWFrTWFwKCk7XHJcbihmdW5jdGlvbiAoVGVhbSkge1xyXG4gICAgLy8gU3BlY2lhbCB2YWx1ZXM6XHJcbiAgICBsZXQgRWxpbU9yZGVyO1xyXG4gICAgKGZ1bmN0aW9uIChFbGltT3JkZXIpIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBBIHRlYW0gc3RhcnRzIG9mZiB3aXRoIHN1Y2ggYSB2YWx1ZSBpZiBhbGwgaXRzIHBsYXllcnMgaGF2ZVxyXG4gICAgICAgICAqIHNwZWNpZmllZCB0aGF0IHRoZWlyIGRvd25pbmcgc2hvdWxkIG5vdCBjYXVzZSBhIGNoZWNrIGZvclxyXG4gICAgICAgICAqIHdoZXRoZXIgdGhlIGdhbWUgc2hvdWxkIGVuZC5cclxuICAgICAgICAgKi9cclxuICAgICAgICBFbGltT3JkZXIuSU1NT1JUQUwgPSAtMTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBBIHRlYW0gdGhhdCBpcyBub3QgaW52aW5jaWJsZSBzdGFydHMgb2ZmIHdpdGggc3VjaCBhIHZhbHVlLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIEVsaW1PcmRlci5TVEFORElORyA9IDA7XHJcbiAgICB9KShFbGltT3JkZXIgPSBUZWFtLkVsaW1PcmRlciB8fCAoVGVhbS5FbGltT3JkZXIgPSB7fSkpO1xyXG59KShUZWFtIHx8IChUZWFtID0ge30pKTtcclxuT2JqZWN0LmZyZWV6ZShUZWFtKTtcclxuT2JqZWN0LmZyZWV6ZShUZWFtLnByb3RvdHlwZSk7XHJcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/base/game/player/Team.ts\n");

/***/ }),

/***/ "./src/base/game/player/VisiblePlayerStatus.ts":
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"VisiblePlayerStatus\": () => /* binding */ VisiblePlayerStatus\n/* harmony export */ });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(\"./node_modules/tslib/tslib.es6.js\");\n/* harmony import */ var defs_JsUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./src/base/defs/JsUtils.ts\");\n/* harmony import */ var defs_OmHooks__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"./src/base/defs/OmHooks.ts\");\n/* harmony import */ var defs_TypeDefs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"./src/base/defs/TypeDefs.ts\");\n/* harmony import */ var _PlayerStatus__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(\"./src/base/game/player/PlayerStatus.ts\");\nvar _baseElem, _vBellAnims, _immigrantInfoCache;\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n *\r\n */\r\nclass VisiblePlayerStatus extends _PlayerStatus__WEBPACK_IMPORTED_MODULE_3__.PlayerStatus {\r\n    constructor(player, noCheckGameOver) {\r\n        super(player, noCheckGameOver);\r\n        _baseElem.set(this, void 0);\r\n        _vBellAnims.set(this, void 0);\r\n        _immigrantInfoCache.set(this, void 0);\r\n        {\r\n            (0,tslib__WEBPACK_IMPORTED_MODULE_4__.__classPrivateFieldSet)(this, _baseElem, defs_JsUtils__WEBPACK_IMPORTED_MODULE_0__.JsUtils.mkEl(\"div\", [\r\n                defs_OmHooks__WEBPACK_IMPORTED_MODULE_1__.OmHooks.General.Class.CENTER_CONTENTS,\r\n                defs_OmHooks__WEBPACK_IMPORTED_MODULE_1__.OmHooks.General.Class.STACK_CONTENTS,\r\n                defs_OmHooks__WEBPACK_IMPORTED_MODULE_1__.OmHooks.Player.Class.BASE,\r\n            ]));\r\n        }\r\n        {\r\n            // Setup face element:\r\n            const faceElem = defs_JsUtils__WEBPACK_IMPORTED_MODULE_0__.JsUtils.mkEl(\"div\", [defs_OmHooks__WEBPACK_IMPORTED_MODULE_1__.OmHooks.Player.Class.FACE], {});\r\n            const vBellAnims = (0,tslib__WEBPACK_IMPORTED_MODULE_4__.__classPrivateFieldSet)(this, _vBellAnims, (this.player.isALocalOperator) ? [\r\n                // Note the 1-millisecond start delays required to\r\n                // pause the animations before they start auto-playing.\r\n                faceElem.animate({\r\n                    filter: [\"brightness(0.7)\", \"brightness(1.0)\"],\r\n                }, { duration: 300, easing: \"ease-in\", delay: 1 }),\r\n                faceElem.animate({\r\n                    transform: VisiblePlayerStatus.makeWiggleAnimation(10, 2),\r\n                }, { duration: 270, easing: \"ease-out\", delay: 1 }),\r\n            ] : []);\r\n            vBellAnims.forEach((anim) => anim.pause());\r\n            // Setup downedOverlay element:\r\n            faceElem.appendChild(defs_JsUtils__WEBPACK_IMPORTED_MODULE_0__.JsUtils.mkEl(\"div\", [defs_OmHooks__WEBPACK_IMPORTED_MODULE_1__.OmHooks.Player.Class.DOWNED_OVERLAY]));\r\n            (0,tslib__WEBPACK_IMPORTED_MODULE_4__.__classPrivateFieldGet)(this, _baseElem).appendChild(faceElem);\r\n        }\r\n    }\r\n    /**\r\n     * @override\r\n     */\r\n    _afterAllPlayersConstruction() {\r\n        // @ts-expect-error : RO=\r\n        (0,tslib__WEBPACK_IMPORTED_MODULE_4__.__classPrivateFieldSet)(this, _immigrantInfoCache, Object.freeze({\r\n            playerElem: (0,tslib__WEBPACK_IMPORTED_MODULE_4__.__classPrivateFieldGet)(this, _baseElem),\r\n            username: this.player.username,\r\n        }));\r\n    }\r\n    reset() {\r\n        super.reset();\r\n        const DDH = defs_OmHooks__WEBPACK_IMPORTED_MODULE_1__.OmHooks.Player.Dataset.DOWNED;\r\n        (0,tslib__WEBPACK_IMPORTED_MODULE_4__.__classPrivateFieldGet)(this, _baseElem).dataset[DDH.KEY] = DDH.VALUES.NO;\r\n        // ^We need to do this explicitly. It won't be done\r\n        // automatically when setting `health` because of the short-\r\n        // circuit=optimization made when `isDowned` hasn't changed.\r\n    }\r\n    get immigrantInfo() {\r\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_4__.__classPrivateFieldGet)(this, _immigrantInfoCache);\r\n    }\r\n    _notifyWillBecomeCurrent(spotlightElems) {\r\n        const currOperator = this.player.game.currentOperator;\r\n        const nextOperator = this.player;\r\n        requestAnimationFrame((time) => {\r\n            spotlightElems.forEach((elem) => {\r\n                (0,tslib__WEBPACK_IMPORTED_MODULE_4__.__classPrivateFieldGet)(this, _baseElem).appendChild(elem);\r\n            });\r\n            nextOperator.status.immigrantInfo.playerElem.scrollIntoView(defs_TypeDefs__WEBPACK_IMPORTED_MODULE_2__.SCROLL_INTO_CENTER);\r\n        });\r\n        if (nextOperator.teamId !== (currOperator === null || currOperator === void 0 ? void 0 : currOperator.teamId)) {\r\n            // Must use the above nullish coalesce operator for first call to setCurrentOperator.\r\n            nextOperator.game.players.forEach((otherPlayer) => {\r\n                const isTeammate = (otherPlayer.teamId === nextOperator.teamId);\r\n                (0,tslib__WEBPACK_IMPORTED_MODULE_4__.__classPrivateFieldGet)(otherPlayer.status, _baseElem).dataset[defs_OmHooks__WEBPACK_IMPORTED_MODULE_1__.OmHooks.Player.Dataset.FACE_SWATCH]\r\n                    = (otherPlayer.isALocalOperator) ? (isTeammate ? \"me\" : \"meOppo\")\r\n                        : isTeammate ? \"teammate\" : \"opponent\";\r\n                ;\r\n            });\r\n        }\r\n    }\r\n    visualBell() {\r\n        if (!(0,tslib__WEBPACK_IMPORTED_MODULE_4__.__classPrivateFieldGet)(this, _vBellAnims)) {\r\n        }\r\n        window.requestAnimationFrame((time) => {\r\n            (0,tslib__WEBPACK_IMPORTED_MODULE_4__.__classPrivateFieldGet)(this, _vBellAnims).forEach((anim) => anim.play());\r\n        });\r\n    }\r\n    get health() {\r\n        return super.health;\r\n    }\r\n    set health(newHealth) {\r\n        const oldIsDowned = this.isDowned;\r\n        super.health = newHealth;\r\n        if (oldIsDowned !== this.isDowned) {\r\n            // CSS integration for Player.isDowned rendering.\r\n            const DDH = defs_OmHooks__WEBPACK_IMPORTED_MODULE_1__.OmHooks.Player.Dataset.DOWNED;\r\n            (0,tslib__WEBPACK_IMPORTED_MODULE_4__.__classPrivateFieldGet)(this, _baseElem).dataset[DDH.KEY] = (this.isDowned)\r\n                ? ((this.player.team.elimOrder)\r\n                    ? DDH.VALUES.TEAM\r\n                    : DDH.VALUES.SELF) : DDH.VALUES.NO;\r\n        }\r\n    }\r\n}\r\n_baseElem = new WeakMap(), _vBellAnims = new WeakMap(), _immigrantInfoCache = new WeakMap();\r\n(function (VisiblePlayerStatus) {\r\n    var _nameElem, _scoreElem, _teamElem;\r\n    function makeWiggleAnimation(pctX, numWiggles) {\r\n        const arr = Array(numWiggles * 2).fill(pctX);\r\n        arr.unshift(0);\r\n        arr.push(0);\r\n        return arr.map((n, i) => `translate(${(i % 2) ? n : -n}%)`);\r\n    }\r\n    VisiblePlayerStatus.makeWiggleAnimation = makeWiggleAnimation;\r\n    /**\r\n     * Append the base element to the players bar in the play-screen.\r\n     * This is internally managed by the VisiblePlayerStatus class.\r\n     */\r\n    // TODO.impl Give each VisiblePlayerStatus one and update it within VisiblePlayerStatus' setters.\r\n    class Card {\r\n        constructor(playerName) {\r\n            _nameElem.set(this, void 0);\r\n            _scoreElem.set(this, void 0);\r\n            _teamElem.set(this, void 0);\r\n            this.baseElem = defs_JsUtils__WEBPACK_IMPORTED_MODULE_0__.JsUtils.mkEl(\"div\", []);\r\n            this.baseElem.setAttribute(\"label\", \"Player\");\r\n            const name = (0,tslib__WEBPACK_IMPORTED_MODULE_4__.__classPrivateFieldSet)(this, _nameElem, defs_JsUtils__WEBPACK_IMPORTED_MODULE_0__.JsUtils.mkEl(\"div\", [], { textContent: playerName }));\r\n            this.baseElem.appendChild(name);\r\n        }\r\n    }\r\n    _nameElem = new WeakMap(), _scoreElem = new WeakMap(), _teamElem = new WeakMap();\r\n    VisiblePlayerStatus.Card = Card;\r\n})(VisiblePlayerStatus || (VisiblePlayerStatus = {}));\r\ndefs_JsUtils__WEBPACK_IMPORTED_MODULE_0__.JsUtils.protoNoEnum(VisiblePlayerStatus, [\"_afterAllPlayersConstruction\"]);\r\nObject.freeze(VisiblePlayerStatus);\r\nObject.freeze(VisiblePlayerStatus.prototype);\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvYmFzZS9nYW1lL3BsYXllci9WaXNpYmxlUGxheWVyU3RhdHVzLnRzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc25ha2V5My8uL3NyYy9iYXNlL2dhbWUvcGxheWVyL1Zpc2libGVQbGF5ZXJTdGF0dXMudHM/YzY0NiJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX2Jhc2VFbGVtLCBfdkJlbGxBbmltcywgX2ltbWlncmFudEluZm9DYWNoZTtcclxuaW1wb3J0IHsgX19jbGFzc1ByaXZhdGVGaWVsZEdldCwgX19jbGFzc1ByaXZhdGVGaWVsZFNldCB9IGZyb20gXCJ0c2xpYlwiO1xyXG5pbXBvcnQgeyBKc1V0aWxzIH0gZnJvbSBcImRlZnMvSnNVdGlsc1wiO1xyXG5pbXBvcnQgeyBPbUhvb2tzIH0gZnJvbSBcImRlZnMvT21Ib29rc1wiO1xyXG5pbXBvcnQgeyBTQ1JPTExfSU5UT19DRU5URVIgfSBmcm9tIFwiZGVmcy9UeXBlRGVmc1wiO1xyXG5pbXBvcnQgeyBQbGF5ZXJTdGF0dXMgfSBmcm9tIFwiLi9QbGF5ZXJTdGF0dXNcIjtcclxuLyoqXHJcbiAqXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgVmlzaWJsZVBsYXllclN0YXR1cyBleHRlbmRzIFBsYXllclN0YXR1cyB7XHJcbiAgICBjb25zdHJ1Y3RvcihwbGF5ZXIsIG5vQ2hlY2tHYW1lT3Zlcikge1xyXG4gICAgICAgIHN1cGVyKHBsYXllciwgbm9DaGVja0dhbWVPdmVyKTtcclxuICAgICAgICBfYmFzZUVsZW0uc2V0KHRoaXMsIHZvaWQgMCk7XHJcbiAgICAgICAgX3ZCZWxsQW5pbXMuc2V0KHRoaXMsIHZvaWQgMCk7XHJcbiAgICAgICAgX2ltbWlncmFudEluZm9DYWNoZS5zZXQodGhpcywgdm9pZCAwKTtcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIF9fY2xhc3NQcml2YXRlRmllbGRTZXQodGhpcywgX2Jhc2VFbGVtLCBKc1V0aWxzLm1rRWwoXCJkaXZcIiwgW1xyXG4gICAgICAgICAgICAgICAgT21Ib29rcy5HZW5lcmFsLkNsYXNzLkNFTlRFUl9DT05URU5UUyxcclxuICAgICAgICAgICAgICAgIE9tSG9va3MuR2VuZXJhbC5DbGFzcy5TVEFDS19DT05URU5UUyxcclxuICAgICAgICAgICAgICAgIE9tSG9va3MuUGxheWVyLkNsYXNzLkJBU0UsXHJcbiAgICAgICAgICAgIF0pKTtcclxuICAgICAgICB9XHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICAvLyBTZXR1cCBmYWNlIGVsZW1lbnQ6XHJcbiAgICAgICAgICAgIGNvbnN0IGZhY2VFbGVtID0gSnNVdGlscy5ta0VsKFwiZGl2XCIsIFtPbUhvb2tzLlBsYXllci5DbGFzcy5GQUNFXSwge30pO1xyXG4gICAgICAgICAgICBjb25zdCB2QmVsbEFuaW1zID0gX19jbGFzc1ByaXZhdGVGaWVsZFNldCh0aGlzLCBfdkJlbGxBbmltcywgKHRoaXMucGxheWVyLmlzQUxvY2FsT3BlcmF0b3IpID8gW1xyXG4gICAgICAgICAgICAgICAgLy8gTm90ZSB0aGUgMS1taWxsaXNlY29uZCBzdGFydCBkZWxheXMgcmVxdWlyZWQgdG9cclxuICAgICAgICAgICAgICAgIC8vIHBhdXNlIHRoZSBhbmltYXRpb25zIGJlZm9yZSB0aGV5IHN0YXJ0IGF1dG8tcGxheWluZy5cclxuICAgICAgICAgICAgICAgIGZhY2VFbGVtLmFuaW1hdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGZpbHRlcjogW1wiYnJpZ2h0bmVzcygwLjcpXCIsIFwiYnJpZ2h0bmVzcygxLjApXCJdLFxyXG4gICAgICAgICAgICAgICAgfSwgeyBkdXJhdGlvbjogMzAwLCBlYXNpbmc6IFwiZWFzZS1pblwiLCBkZWxheTogMSB9KSxcclxuICAgICAgICAgICAgICAgIGZhY2VFbGVtLmFuaW1hdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogVmlzaWJsZVBsYXllclN0YXR1cy5tYWtlV2lnZ2xlQW5pbWF0aW9uKDEwLCAyKSxcclxuICAgICAgICAgICAgICAgIH0sIHsgZHVyYXRpb246IDI3MCwgZWFzaW5nOiBcImVhc2Utb3V0XCIsIGRlbGF5OiAxIH0pLFxyXG4gICAgICAgICAgICBdIDogW10pO1xyXG4gICAgICAgICAgICB2QmVsbEFuaW1zLmZvckVhY2goKGFuaW0pID0+IGFuaW0ucGF1c2UoKSk7XHJcbiAgICAgICAgICAgIC8vIFNldHVwIGRvd25lZE92ZXJsYXkgZWxlbWVudDpcclxuICAgICAgICAgICAgZmFjZUVsZW0uYXBwZW5kQ2hpbGQoSnNVdGlscy5ta0VsKFwiZGl2XCIsIFtPbUhvb2tzLlBsYXllci5DbGFzcy5ET1dORURfT1ZFUkxBWV0pKTtcclxuICAgICAgICAgICAgX19jbGFzc1ByaXZhdGVGaWVsZEdldCh0aGlzLCBfYmFzZUVsZW0pLmFwcGVuZENoaWxkKGZhY2VFbGVtKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEBvdmVycmlkZVxyXG4gICAgICovXHJcbiAgICBfYWZ0ZXJBbGxQbGF5ZXJzQ29uc3RydWN0aW9uKCkge1xyXG4gICAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgOiBSTz1cclxuICAgICAgICBfX2NsYXNzUHJpdmF0ZUZpZWxkU2V0KHRoaXMsIF9pbW1pZ3JhbnRJbmZvQ2FjaGUsIE9iamVjdC5mcmVlemUoe1xyXG4gICAgICAgICAgICBwbGF5ZXJFbGVtOiBfX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHRoaXMsIF9iYXNlRWxlbSksXHJcbiAgICAgICAgICAgIHVzZXJuYW1lOiB0aGlzLnBsYXllci51c2VybmFtZSxcclxuICAgICAgICB9KSk7XHJcbiAgICB9XHJcbiAgICByZXNldCgpIHtcclxuICAgICAgICBzdXBlci5yZXNldCgpO1xyXG4gICAgICAgIGNvbnN0IERESCA9IE9tSG9va3MuUGxheWVyLkRhdGFzZXQuRE9XTkVEO1xyXG4gICAgICAgIF9fY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX2Jhc2VFbGVtKS5kYXRhc2V0W0RESC5LRVldID0gRERILlZBTFVFUy5OTztcclxuICAgICAgICAvLyBeV2UgbmVlZCB0byBkbyB0aGlzIGV4cGxpY2l0bHkuIEl0IHdvbid0IGJlIGRvbmVcclxuICAgICAgICAvLyBhdXRvbWF0aWNhbGx5IHdoZW4gc2V0dGluZyBgaGVhbHRoYCBiZWNhdXNlIG9mIHRoZSBzaG9ydC1cclxuICAgICAgICAvLyBjaXJjdWl0PW9wdGltaXphdGlvbiBtYWRlIHdoZW4gYGlzRG93bmVkYCBoYXNuJ3QgY2hhbmdlZC5cclxuICAgIH1cclxuICAgIGdldCBpbW1pZ3JhbnRJbmZvKCkge1xyXG4gICAgICAgIHJldHVybiBfX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHRoaXMsIF9pbW1pZ3JhbnRJbmZvQ2FjaGUpO1xyXG4gICAgfVxyXG4gICAgX25vdGlmeVdpbGxCZWNvbWVDdXJyZW50KHNwb3RsaWdodEVsZW1zKSB7XHJcbiAgICAgICAgY29uc3QgY3Vyck9wZXJhdG9yID0gdGhpcy5wbGF5ZXIuZ2FtZS5jdXJyZW50T3BlcmF0b3I7XHJcbiAgICAgICAgY29uc3QgbmV4dE9wZXJhdG9yID0gdGhpcy5wbGF5ZXI7XHJcbiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCh0aW1lKSA9PiB7XHJcbiAgICAgICAgICAgIHNwb3RsaWdodEVsZW1zLmZvckVhY2goKGVsZW0pID0+IHtcclxuICAgICAgICAgICAgICAgIF9fY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX2Jhc2VFbGVtKS5hcHBlbmRDaGlsZChlbGVtKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIG5leHRPcGVyYXRvci5zdGF0dXMuaW1taWdyYW50SW5mby5wbGF5ZXJFbGVtLnNjcm9sbEludG9WaWV3KFNDUk9MTF9JTlRPX0NFTlRFUik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKG5leHRPcGVyYXRvci50ZWFtSWQgIT09IChjdXJyT3BlcmF0b3IgPT09IG51bGwgfHwgY3Vyck9wZXJhdG9yID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjdXJyT3BlcmF0b3IudGVhbUlkKSkge1xyXG4gICAgICAgICAgICAvLyBNdXN0IHVzZSB0aGUgYWJvdmUgbnVsbGlzaCBjb2FsZXNjZSBvcGVyYXRvciBmb3IgZmlyc3QgY2FsbCB0byBzZXRDdXJyZW50T3BlcmF0b3IuXHJcbiAgICAgICAgICAgIG5leHRPcGVyYXRvci5nYW1lLnBsYXllcnMuZm9yRWFjaCgob3RoZXJQbGF5ZXIpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGlzVGVhbW1hdGUgPSAob3RoZXJQbGF5ZXIudGVhbUlkID09PSBuZXh0T3BlcmF0b3IudGVhbUlkKTtcclxuICAgICAgICAgICAgICAgIF9fY2xhc3NQcml2YXRlRmllbGRHZXQob3RoZXJQbGF5ZXIuc3RhdHVzLCBfYmFzZUVsZW0pLmRhdGFzZXRbT21Ib29rcy5QbGF5ZXIuRGF0YXNldC5GQUNFX1NXQVRDSF1cclxuICAgICAgICAgICAgICAgICAgICA9IChvdGhlclBsYXllci5pc0FMb2NhbE9wZXJhdG9yKSA/IChpc1RlYW1tYXRlID8gXCJtZVwiIDogXCJtZU9wcG9cIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgOiBpc1RlYW1tYXRlID8gXCJ0ZWFtbWF0ZVwiIDogXCJvcHBvbmVudFwiO1xyXG4gICAgICAgICAgICAgICAgO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICB2aXN1YWxCZWxsKCkge1xyXG4gICAgICAgIGlmICghX19jbGFzc1ByaXZhdGVGaWVsZEdldCh0aGlzLCBfdkJlbGxBbmltcykpIHtcclxuICAgICAgICB9XHJcbiAgICAgICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSgodGltZSkgPT4ge1xyXG4gICAgICAgICAgICBfX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHRoaXMsIF92QmVsbEFuaW1zKS5mb3JFYWNoKChhbmltKSA9PiBhbmltLnBsYXkoKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBnZXQgaGVhbHRoKCkge1xyXG4gICAgICAgIHJldHVybiBzdXBlci5oZWFsdGg7XHJcbiAgICB9XHJcbiAgICBzZXQgaGVhbHRoKG5ld0hlYWx0aCkge1xyXG4gICAgICAgIGNvbnN0IG9sZElzRG93bmVkID0gdGhpcy5pc0Rvd25lZDtcclxuICAgICAgICBzdXBlci5oZWFsdGggPSBuZXdIZWFsdGg7XHJcbiAgICAgICAgaWYgKG9sZElzRG93bmVkICE9PSB0aGlzLmlzRG93bmVkKSB7XHJcbiAgICAgICAgICAgIC8vIENTUyBpbnRlZ3JhdGlvbiBmb3IgUGxheWVyLmlzRG93bmVkIHJlbmRlcmluZy5cclxuICAgICAgICAgICAgY29uc3QgRERIID0gT21Ib29rcy5QbGF5ZXIuRGF0YXNldC5ET1dORUQ7XHJcbiAgICAgICAgICAgIF9fY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX2Jhc2VFbGVtKS5kYXRhc2V0W0RESC5LRVldID0gKHRoaXMuaXNEb3duZWQpXHJcbiAgICAgICAgICAgICAgICA/ICgodGhpcy5wbGF5ZXIudGVhbS5lbGltT3JkZXIpXHJcbiAgICAgICAgICAgICAgICAgICAgPyBEREguVkFMVUVTLlRFQU1cclxuICAgICAgICAgICAgICAgICAgICA6IERESC5WQUxVRVMuU0VMRikgOiBEREguVkFMVUVTLk5PO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5fYmFzZUVsZW0gPSBuZXcgV2Vha01hcCgpLCBfdkJlbGxBbmltcyA9IG5ldyBXZWFrTWFwKCksIF9pbW1pZ3JhbnRJbmZvQ2FjaGUgPSBuZXcgV2Vha01hcCgpO1xyXG4oZnVuY3Rpb24gKFZpc2libGVQbGF5ZXJTdGF0dXMpIHtcclxuICAgIHZhciBfbmFtZUVsZW0sIF9zY29yZUVsZW0sIF90ZWFtRWxlbTtcclxuICAgIGZ1bmN0aW9uIG1ha2VXaWdnbGVBbmltYXRpb24ocGN0WCwgbnVtV2lnZ2xlcykge1xyXG4gICAgICAgIGNvbnN0IGFyciA9IEFycmF5KG51bVdpZ2dsZXMgKiAyKS5maWxsKHBjdFgpO1xyXG4gICAgICAgIGFyci51bnNoaWZ0KDApO1xyXG4gICAgICAgIGFyci5wdXNoKDApO1xyXG4gICAgICAgIHJldHVybiBhcnIubWFwKChuLCBpKSA9PiBgdHJhbnNsYXRlKCR7KGkgJSAyKSA/IG4gOiAtbn0lKWApO1xyXG4gICAgfVxyXG4gICAgVmlzaWJsZVBsYXllclN0YXR1cy5tYWtlV2lnZ2xlQW5pbWF0aW9uID0gbWFrZVdpZ2dsZUFuaW1hdGlvbjtcclxuICAgIC8qKlxyXG4gICAgICogQXBwZW5kIHRoZSBiYXNlIGVsZW1lbnQgdG8gdGhlIHBsYXllcnMgYmFyIGluIHRoZSBwbGF5LXNjcmVlbi5cclxuICAgICAqIFRoaXMgaXMgaW50ZXJuYWxseSBtYW5hZ2VkIGJ5IHRoZSBWaXNpYmxlUGxheWVyU3RhdHVzIGNsYXNzLlxyXG4gICAgICovXHJcbiAgICAvLyBUT0RPLmltcGwgR2l2ZSBlYWNoIFZpc2libGVQbGF5ZXJTdGF0dXMgb25lIGFuZCB1cGRhdGUgaXQgd2l0aGluIFZpc2libGVQbGF5ZXJTdGF0dXMnIHNldHRlcnMuXHJcbiAgICBjbGFzcyBDYXJkIHtcclxuICAgICAgICBjb25zdHJ1Y3RvcihwbGF5ZXJOYW1lKSB7XHJcbiAgICAgICAgICAgIF9uYW1lRWxlbS5zZXQodGhpcywgdm9pZCAwKTtcclxuICAgICAgICAgICAgX3Njb3JlRWxlbS5zZXQodGhpcywgdm9pZCAwKTtcclxuICAgICAgICAgICAgX3RlYW1FbGVtLnNldCh0aGlzLCB2b2lkIDApO1xyXG4gICAgICAgICAgICB0aGlzLmJhc2VFbGVtID0gSnNVdGlscy5ta0VsKFwiZGl2XCIsIFtdKTtcclxuICAgICAgICAgICAgdGhpcy5iYXNlRWxlbS5zZXRBdHRyaWJ1dGUoXCJsYWJlbFwiLCBcIlBsYXllclwiKTtcclxuICAgICAgICAgICAgY29uc3QgbmFtZSA9IF9fY2xhc3NQcml2YXRlRmllbGRTZXQodGhpcywgX25hbWVFbGVtLCBKc1V0aWxzLm1rRWwoXCJkaXZcIiwgW10sIHsgdGV4dENvbnRlbnQ6IHBsYXllck5hbWUgfSkpO1xyXG4gICAgICAgICAgICB0aGlzLmJhc2VFbGVtLmFwcGVuZENoaWxkKG5hbWUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIF9uYW1lRWxlbSA9IG5ldyBXZWFrTWFwKCksIF9zY29yZUVsZW0gPSBuZXcgV2Vha01hcCgpLCBfdGVhbUVsZW0gPSBuZXcgV2Vha01hcCgpO1xyXG4gICAgVmlzaWJsZVBsYXllclN0YXR1cy5DYXJkID0gQ2FyZDtcclxufSkoVmlzaWJsZVBsYXllclN0YXR1cyB8fCAoVmlzaWJsZVBsYXllclN0YXR1cyA9IHt9KSk7XHJcbkpzVXRpbHMucHJvdG9Ob0VudW0oVmlzaWJsZVBsYXllclN0YXR1cywgW1wiX2FmdGVyQWxsUGxheWVyc0NvbnN0cnVjdGlvblwiXSk7XHJcbk9iamVjdC5mcmVlemUoVmlzaWJsZVBsYXllclN0YXR1cyk7XHJcbk9iamVjdC5mcmVlemUoVmlzaWJsZVBsYXllclN0YXR1cy5wcm90b3R5cGUpO1xyXG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/base/game/player/VisiblePlayerStatus.ts\n");

/***/ }),

/***/ "./src/client/game/BrowserGame.ts":
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"JsUtils\": () => /* reexport safe */ defs_JsUtils__WEBPACK_IMPORTED_MODULE_0__.JsUtils,\n/* harmony export */   \"Game\": () => /* reexport safe */ game_Game__WEBPACK_IMPORTED_MODULE_1__.Game,\n/* harmony export */   \"Coord\": () => /* reexport safe */ floor_VisibleTile__WEBPACK_IMPORTED_MODULE_2__.Coord,\n/* harmony export */   \"VisibleTile\": () => /* reexport safe */ floor_VisibleTile__WEBPACK_IMPORTED_MODULE_2__.VisibleTile,\n/* harmony export */   \"Player\": () => /* reexport safe */ game_player_Player__WEBPACK_IMPORTED_MODULE_4__.Player,\n/* harmony export */   \"OperatorPlayer\": () => /* reexport safe */ game_player_OperatorPlayer__WEBPACK_IMPORTED_MODULE_5__.OperatorPlayer,\n/* harmony export */   \"VisiblePlayerStatus\": () => /* reexport safe */ game_player_VisiblePlayerStatus__WEBPACK_IMPORTED_MODULE_6__.VisiblePlayerStatus,\n/* harmony export */   \"BrowserGameMixin\": () => /* binding */ BrowserGameMixin\n/* harmony export */ });\n/* harmony import */ var defs_JsUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./src/base/defs/JsUtils.ts\");\n/* harmony import */ var game_Game__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"./src/base/game/Game.ts\");\n/* harmony import */ var floor_VisibleTile__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"./src/base/floor/VisibleTile.ts\");\n/* harmony import */ var floor_VisibleGrid__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(\"./src/base/floor/VisibleGrid.ts\");\n/* harmony import */ var game_player_Player__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(\"./src/base/game/player/Player.ts\");\n/* harmony import */ var game_player_OperatorPlayer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(\"./src/base/game/player/OperatorPlayer.ts\");\n/* harmony import */ var game_player_VisiblePlayerStatus__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(\"./src/base/game/player/VisiblePlayerStatus.ts\");\n/* harmony import */ var game_ctormaps_CmapBrowser__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(\"./src/base/game/ctormaps/CmapBrowser.ts\");\n// Tell WebPack about the CSS chunk we want:\r\n__webpack_require__(\"./assets/style/game/_barrel.css\");\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n // <- has side-effects.\r\n/**\r\n *\r\n */\r\nclass BrowserGameMixin {\r\n    /**\r\n     * Classes using this mixin should call this somewhere in their\r\n     * constructor.\r\n     */\r\n    _ctorBrowserGame() {\r\n        // @ts-expect-error : RO=\r\n        this.htmlElements = Object.freeze({\r\n            gridImpl: this.grid.baseElem,\r\n            playersBar: document.createElement(\"div\"),\r\n        });\r\n        defs_JsUtils__WEBPACK_IMPORTED_MODULE_0__.JsUtils.propNoWrite(this, [\"htmlElements\"]);\r\n    }\r\n    /**\r\n     * @override\r\n     */\r\n    _getGridImplementation(coordSys) {\r\n        return floor_VisibleGrid__WEBPACK_IMPORTED_MODULE_3__.VisibleGrid.getImplementation(coordSys);\r\n    }\r\n    /**\r\n     * @override\r\n     */\r\n    _createOperatorPlayer(desc) {\r\n        return new game_player_OperatorPlayer__WEBPACK_IMPORTED_MODULE_5__.OperatorPlayer(this, desc);\r\n    }\r\n}\r\n;\r\ndefs_JsUtils__WEBPACK_IMPORTED_MODULE_0__.JsUtils.protoNoEnum(BrowserGameMixin, [\"_getGridImplementation\"]);\r\nObject.freeze(BrowserGameMixin);\r\nObject.freeze(BrowserGameMixin.prototype);\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY2xpZW50L2dhbWUvQnJvd3NlckdhbWUudHMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zbmFrZXkzLy4vc3JjL2NsaWVudC9nYW1lL0Jyb3dzZXJHYW1lLnRzP2VlMDciXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGVsbCBXZWJQYWNrIGFib3V0IHRoZSBDU1MgY2h1bmsgd2Ugd2FudDpcclxucmVxdWlyZShcImFzc2V0cy9zdHlsZS9nYW1lL19iYXJyZWwuY3NzXCIpO1xyXG5pbXBvcnQgeyBKc1V0aWxzIH0gZnJvbSBcImRlZnMvSnNVdGlsc1wiO1xyXG5leHBvcnQgeyBKc1V0aWxzIH07XHJcbmltcG9ydCB7IEdhbWUgfSBmcm9tIFwiZ2FtZS9HYW1lXCI7XHJcbmV4cG9ydCB7IEdhbWUgfTtcclxuaW1wb3J0IHsgQ29vcmQsIFZpc2libGVUaWxlIH0gZnJvbSBcImZsb29yL1Zpc2libGVUaWxlXCI7XHJcbmV4cG9ydCB7IENvb3JkLCBWaXNpYmxlVGlsZSB9O1xyXG5pbXBvcnQgeyBWaXNpYmxlR3JpZCB9IGZyb20gXCJmbG9vci9WaXNpYmxlR3JpZFwiO1xyXG5pbXBvcnQgeyBQbGF5ZXIgfSBmcm9tIFwiZ2FtZS9wbGF5ZXIvUGxheWVyXCI7XHJcbmV4cG9ydCB7IFBsYXllciB9O1xyXG5pbXBvcnQgeyBPcGVyYXRvclBsYXllciB9IGZyb20gXCJnYW1lL3BsYXllci9PcGVyYXRvclBsYXllclwiO1xyXG5leHBvcnQgeyBPcGVyYXRvclBsYXllciB9O1xyXG5leHBvcnQgeyBWaXNpYmxlUGxheWVyU3RhdHVzIH0gZnJvbSBcImdhbWUvcGxheWVyL1Zpc2libGVQbGF5ZXJTdGF0dXNcIjtcclxuaW1wb3J0IFwiZ2FtZS9jdG9ybWFwcy9DbWFwQnJvd3NlclwiOyAvLyA8LSBoYXMgc2lkZS1lZmZlY3RzLlxyXG4vKipcclxuICpcclxuICovXHJcbmV4cG9ydCBjbGFzcyBCcm93c2VyR2FtZU1peGluIHtcclxuICAgIC8qKlxyXG4gICAgICogQ2xhc3NlcyB1c2luZyB0aGlzIG1peGluIHNob3VsZCBjYWxsIHRoaXMgc29tZXdoZXJlIGluIHRoZWlyXHJcbiAgICAgKiBjb25zdHJ1Y3Rvci5cclxuICAgICAqL1xyXG4gICAgX2N0b3JCcm93c2VyR2FtZSgpIHtcclxuICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yIDogUk89XHJcbiAgICAgICAgdGhpcy5odG1sRWxlbWVudHMgPSBPYmplY3QuZnJlZXplKHtcclxuICAgICAgICAgICAgZ3JpZEltcGw6IHRoaXMuZ3JpZC5iYXNlRWxlbSxcclxuICAgICAgICAgICAgcGxheWVyc0JhcjogZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKSxcclxuICAgICAgICB9KTtcclxuICAgICAgICBKc1V0aWxzLnByb3BOb1dyaXRlKHRoaXMsIFtcImh0bWxFbGVtZW50c1wiXSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEBvdmVycmlkZVxyXG4gICAgICovXHJcbiAgICBfZ2V0R3JpZEltcGxlbWVudGF0aW9uKGNvb3JkU3lzKSB7XHJcbiAgICAgICAgcmV0dXJuIFZpc2libGVHcmlkLmdldEltcGxlbWVudGF0aW9uKGNvb3JkU3lzKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQG92ZXJyaWRlXHJcbiAgICAgKi9cclxuICAgIF9jcmVhdGVPcGVyYXRvclBsYXllcihkZXNjKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBPcGVyYXRvclBsYXllcih0aGlzLCBkZXNjKTtcclxuICAgIH1cclxufVxyXG47XHJcbkpzVXRpbHMucHJvdG9Ob0VudW0oQnJvd3NlckdhbWVNaXhpbiwgW1wiX2dldEdyaWRJbXBsZW1lbnRhdGlvblwiXSk7XHJcbk9iamVjdC5mcmVlemUoQnJvd3NlckdhbWVNaXhpbik7XHJcbk9iamVjdC5mcmVlemUoQnJvd3NlckdhbWVNaXhpbi5wcm90b3R5cGUpO1xyXG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/client/game/BrowserGame.ts\n");

/***/ })

}]);